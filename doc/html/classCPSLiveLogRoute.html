<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>&quot;The Yii Extension Library Of Doom!&quot;: CPSLiveLogRoute Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structure&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&nbsp;Fields</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<h1>CPSLiveLogRoute Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="CPSLiveLogRoute" --><table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPSLiveLogRoute.html#acc9683d3eaa74394ee82159398196ab8">getExcludeCategories</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPSLiveLogRoute.html#ad1fe56b8c471fa8818f46c39318f6373">setExcludeCategories</a> ($value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPSLiveLogRoute.html#af3edf920c9186a7479f274daaefb580b">getCategoryWidth</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPSLiveLogRoute.html#aca83de68fd6f754d3b9dcf265ff0be56">setCategoryWidth</a> ($value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPSLiveLogRoute.html#a6228d7e188b6c803663f67d4ea30aeda">collectLogs</a> ($logger, $processLogs=false)</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPSLiveLogRoute.html#a4ac809157dfd774390d8ea4b81223872">processLogs</a> ($logs=<a class="el" href="list_8php.html#aa3205d038c7f8feb5c9f01ac4dfadc88">array</a>())</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPSLiveLogRoute.html#ac9dde335d8302c5533f76115925722f9">formatLogMessage</a> ($message, $level= 'I', $category=null, $time=null)</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPSLiveLogRoute.html#a9c4b2e98f2d0c9401bc839d5104985ce">$_excludeCategories</a> = <a class="el" href="list_8php.html#aa3205d038c7f8feb5c9f01ac4dfadc88">array</a>()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPSLiveLogRoute.html#a25c9edaf8b1a5b6a83f88f220356ad62">$_categoryWidth</a> = 40</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p><a class="el" href="classCPSLiveLogRoute.html">CPSLiveLogRoute</a> utilizes PHP's <a class="el" href="">error_log</a> function to write logs in real time</p>
<dl class="author"><dt><b>Author:</b></dt><dd>Jerry Ablan &lt;<a href="mailto:jablan@pogostick.com">jablan@pogostick.com</a>&gt; </dd></dl>
<dl class="since"><dt><b>Since:</b></dt><dd>v1.1.0 </dd></dl>

<p>Definition at line <a class="el" href="CPSLiveLogRoute_8php_source.html#l00020">20</a> of file <a class="el" href="CPSLiveLogRoute_8php_source.html">CPSLiveLogRoute.php</a>.</p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a6228d7e188b6c803663f67d4ea30aeda"></a><!-- doxytag: member="CPSLiveLogRoute::collectLogs" ref="a6228d7e188b6c803663f67d4ea30aeda" args="($logger, $processLogs=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">collectLogs </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>logger</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>processLogs</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Retrieves filtered log messages from logger for further processing. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>CLogger</em>&nbsp;</td><td>$logger logger instance </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>boolean</em>&nbsp;</td><td>$processLogs whether to process the logs after they are collected from the logger. ALWAYS TRUE NOW! </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CPSLiveLogRoute_8php_source.html#l00057">57</a> of file <a class="el" href="CPSLiveLogRoute_8php_source.html">CPSLiveLogRoute.php</a>.</p>

<p><div class="fragment"><pre class="fragment">    {
        <a class="code" href="classCPSLiveLogRoute.html#a6228d7e188b6c803663f67d4ea30aeda">parent::collectLogs</a>( $logger, <span class="keyword">true</span> );
    }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac9dde335d8302c5533f76115925722f9"></a><!-- doxytag: member="CPSLiveLogRoute::formatLogMessage" ref="ac9dde335d8302c5533f76115925722f9" args="($message, $level= 'I', $category=null, $time=null)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">formatLogMessage </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>level</em> = <code>'I'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>category</em> = <code>null</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>time</em> = <code>null</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Formats a log message given different fields. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>string</em>&nbsp;</td><td>$message message content </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>integer</em>&nbsp;</td><td>$level message level </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>string</em>&nbsp;</td><td>$category message category </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>integer</em>&nbsp;</td><td>$time timestamp </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>string formatted message </dd></dl>

<p>Definition at line <a class="el" href="CPSLiveLogRoute_8php_source.html#l00129">129</a> of file <a class="el" href="CPSLiveLogRoute_8php_source.html">CPSLiveLogRoute.php</a>.</p>

<p><div class="fragment"><pre class="fragment">    {
        <span class="keywordflow">if</span> ( null === $time )
            $time = time();

        $level = strtoupper( $level[0] );

        <span class="keywordflow">return</span> @date( <span class="stringliteral">&#39;M d H:i:s&#39;</span>, $time ) . <span class="stringliteral">&#39; [&#39;</span> . sprintf( <span class="stringliteral">&#39;%-&#39;</span> . $this-&gt;_categoryWidth . <span class="charliteral">&#39;s&#39;</span>, $category ) . <span class="stringliteral">&#39;] &#39;</span> . <span class="stringliteral">&#39;: &lt;&#39;</span> . $level . <span class="stringliteral">&#39;&gt; &#39;</span> . $message . PHP_EOL;
    }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCPSLiveLogRoute_ac9dde335d8302c5533f76115925722f9_icgraph.png" border="0" usemap="#classCPSLiveLogRoute_ac9dde335d8302c5533f76115925722f9_icgraph" alt=""/></div>
<map name="classCPSLiveLogRoute_ac9dde335d8302c5533f76115925722f9_icgraph" id="classCPSLiveLogRoute_ac9dde335d8302c5533f76115925722f9_icgraph">
<area shape="rect" id="node3" href="classCPSLiveLogRoute.html#a4ac809157dfd774390d8ea4b81223872" title="processLogs" alt="" coords="201,5,303,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af3edf920c9186a7479f274daaefb580b"></a><!-- doxytag: member="CPSLiveLogRoute::getCategoryWidth" ref="af3edf920c9186a7479f274daaefb580b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getCategoryWidth </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the minimum width of the category column in the log output </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>integer </dd></dl>

<p>Definition at line <a class="el" href="CPSLiveLogRoute_8php_source.html#l00041">41</a> of file <a class="el" href="CPSLiveLogRoute_8php_source.html">CPSLiveLogRoute.php</a>.</p>

<p><div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> $this-&gt;_categoryWidth; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="acc9683d3eaa74394ee82159398196ab8"></a><!-- doxytag: member="CPSLiveLogRoute::getExcludeCategories" ref="acc9683d3eaa74394ee82159398196ab8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getExcludeCategories </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="CPSLiveLogRoute_8php_source.html#l00030">30</a> of file <a class="el" href="CPSLiveLogRoute_8php_source.html">CPSLiveLogRoute.php</a>.</p>

<p><div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> $this-&gt;_excludeCategories; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4ac809157dfd774390d8ea4b81223872"></a><!-- doxytag: member="CPSLiveLogRoute::processLogs" ref="a4ac809157dfd774390d8ea4b81223872" args="($logs=array())" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">processLogs </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>logs</em> = <code><a class="el" href="list_8php.html#aa3205d038c7f8feb5c9f01ac4dfadc88">array</a>()</code></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Writes log messages in files. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>array</em>&nbsp;</td><td>$logs list of log messages </td></tr>
  </table>
  </dd>
</dl>

<p><p>Use <a class="el" href="">error_log</a> facility to write out log entry</p>
</p>

<p>Definition at line <a class="el" href="CPSLiveLogRoute_8php_source.html#l00070">70</a> of file <a class="el" href="CPSLiveLogRoute_8php_source.html">CPSLiveLogRoute.php</a>.</p>

<p><div class="fragment"><pre class="fragment">    {
        <span class="keywordflow">try</span>
        {
            $_logFile = $this-&gt;getLogPath() . DIRECTORY_SEPARATOR . $this-&gt;getLogFile();

            <span class="keywordflow">if</span> ( @filesize( $_logFile ) &gt; $this-&gt;getMaxFileSize() * 1024 )
                $this-&gt;rotateFiles();

            <span class="comment">//  Write out the log entries</span>
            <span class="keywordflow">foreach</span> ( $logs as $_log )
            {
                $_exclude = <span class="keyword">false</span>;

                <span class="comment">//  Check out the exclusions</span>
                <span class="keywordflow">if</span> ( ! empty( $this-&gt;_excludeCategories ) )
                {
                    <span class="keywordflow">foreach</span> ( $this-&gt;_excludeCategories as $_category )
                    {
                        <span class="comment">//  If found, we skip</span>
                        <span class="keywordflow">if</span> ( trim( strtolower( $_category ) ) == trim( strtolower( $_log[2] ) ) )
                        {
                            $_exclude = <span class="keyword">true</span>;
                            <span class="keywordflow">break</span>;
                        }

                        <span class="comment">//  Check for regex</span>
                        <span class="keywordflow">if</span> ( <span class="charliteral">&#39;/&#39;</span> == $_category[0] &amp;&amp; 0 != @preg_match( $_category, $_log[2] ) )
                        {
                            $_exclude = <span class="keyword">true</span>;
                            <span class="keywordflow">break</span>;
                        }
                    }
                }

                <span class="keywordflow">if</span> ( ! $_exclude )
                    error_log( $this-&gt;<a class="code" href="classCPSLiveLogRoute.html#ac9dde335d8302c5533f76115925722f9">formatLogMessage</a>( $_log[0], $_log[1], $_log[2], $_log[3] ), 3, $_logFile );
            }

            <span class="comment">//  Processed, clear!</span>
            $this-&gt;logs = null;
        }
        <span class="keywordflow">catch</span> ( Exception $_ex )
        {
            error_log( __METHOD__ . <span class="stringliteral">&#39;: Exception processing application logs: &#39;</span> . $_ex-&gt;getMessage() );
        }
    }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCPSLiveLogRoute_a4ac809157dfd774390d8ea4b81223872_cgraph.png" border="0" usemap="#classCPSLiveLogRoute_a4ac809157dfd774390d8ea4b81223872_cgraph" alt=""/></div>
<map name="classCPSLiveLogRoute_a4ac809157dfd774390d8ea4b81223872_cgraph" id="classCPSLiveLogRoute_a4ac809157dfd774390d8ea4b81223872_cgraph">
<area shape="rect" id="node3" href="classCPSLiveLogRoute.html#ac9dde335d8302c5533f76115925722f9" title="formatLogMessage" alt="" coords="159,5,303,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aca83de68fd6f754d3b9dcf265ff0be56"></a><!-- doxytag: member="CPSLiveLogRoute::setCategoryWidth" ref="aca83de68fd6f754d3b9dcf265ff0be56" args="($value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setCategoryWidth </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>value</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the minimum width of the category column in the log output </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>integer </dd></dl>

<p>Definition at line <a class="el" href="CPSLiveLogRoute_8php_source.html#l00046">46</a> of file <a class="el" href="CPSLiveLogRoute_8php_source.html">CPSLiveLogRoute.php</a>.</p>

<p><div class="fragment"><pre class="fragment">{ $this-&gt;_categoryWidth = $value; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad1fe56b8c471fa8818f46c39318f6373"></a><!-- doxytag: member="CPSLiveLogRoute::setExcludeCategories" ref="ad1fe56b8c471fa8818f46c39318f6373" args="($value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setExcludeCategories </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>value</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="CPSLiveLogRoute_8php_source.html#l00031">31</a> of file <a class="el" href="CPSLiveLogRoute_8php_source.html">CPSLiveLogRoute.php</a>.</p>

<p><div class="fragment"><pre class="fragment">{ $this-&gt;_excludeCategories = $value; }
</pre></div></p>

</div>
</div>
<hr/><h2>Field Documentation</h2>
<a class="anchor" id="a25c9edaf8b1a5b6a83f88f220356ad62"></a><!-- doxytag: member="CPSLiveLogRoute::$_categoryWidth" ref="a25c9edaf8b1a5b6a83f88f220356ad62" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$_categoryWidth = 40<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="CPSLiveLogRoute_8php_source.html#l00036">36</a> of file <a class="el" href="CPSLiveLogRoute_8php_source.html">CPSLiveLogRoute.php</a>.</p>

</div>
</div>
<a class="anchor" id="a9c4b2e98f2d0c9401bc839d5104985ce"></a><!-- doxytag: member="CPSLiveLogRoute::$_excludeCategories" ref="a9c4b2e98f2d0c9401bc839d5104985ce" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$_excludeCategories = <a class="el" href="list_8php.html#aa3205d038c7f8feb5c9f01ac4dfadc88">array</a>()<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="CPSLiveLogRoute_8php_source.html#l00029">29</a> of file <a class="el" href="CPSLiveLogRoute_8php_source.html">CPSLiveLogRoute.php</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/usr/local/yiixl/lib/original/logging/<a class="el" href="CPSLiveLogRoute_8php_source.html">CPSLiveLogRoute.php</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Thu Mar 24 2011 20:11:41 for "The Yii Extension Library Of Doom!" by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
