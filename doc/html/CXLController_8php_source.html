<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>YiiXL -- The Yii Extension Library Of Doom!: CXLController.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="dir_1ec655711e29b55f31ff264c2bb65c33.html">usr</a>      </li>
      <li><a class="el" href="dir_6bb76cc6f95ff18987242ff417c6ce46.html">local</a>      </li>
      <li><a class="el" href="dir_c5bf51a4bce5f6288acec49aaf0c7f09.html">yiixl</a>      </li>
      <li><a class="el" href="dir_61700af67871dcbdf05fae1643014cc7.html">lib</a>      </li>
      <li><a class="el" href="dir_1fe0dc3b670ebeef3b7eceb42bf96cab.html">core</a>      </li>
      <li><a class="el" href="dir_58a605a4cd3c27182089a81563f0d21c.html">controllers</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>CXLController.php</h1>  </div>
</div>
<div class="contents">
<a href="CXLController_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00021"></a><a class="code" href="classCXLController.html">00021</a> <span class="keyword">abstract</span> <span class="keyword">class </span><a class="code" href="classCXLController.html" title="CXLController Provides filtered access to resources.">CXLController</a> <span class="keyword">extends</span> CController implements <a class="code" href="interfaceIXLController.html" title="An interface for all YiiXL controllers.">IXLController</a>, <a class="code" href="interfaceIXLAccessControl.html" title="This interface defines an object as an access control object.">IXLAccessControl</a>
<a name="l00022"></a>00022 {
<a name="l00023"></a>00023   <span class="comment">//********************************************************************************</span>
<a name="l00024"></a>00024   <span class="comment">//* Constants</span>
<a name="l00025"></a>00025   <span class="comment">//********************************************************************************</span>
<a name="l00026"></a>00026 
<a name="l00031"></a><a class="code" href="classCXLController.html#aa607ab5e557e6ebb60b85c5a20ad067f">00031</a>   <span class="keyword">const</span> <a class="code" href="classCXLController.html#aa607ab5e557e6ebb60b85c5a20ad067f" title="Our logging tag  string.">CLASS_LOG_TAG</a> = <span class="stringliteral">&#39;yiixl.core.components.CXLController&#39;</span>;
<a name="l00032"></a>00032 
<a name="l00033"></a>00033    <span class="comment">//********************************************************************************</span>
<a name="l00034"></a>00034   <span class="comment">//* Member Variables</span>
<a name="l00035"></a>00035   <span class="comment">//********************************************************************************</span>
<a name="l00036"></a>00036 
<a name="l00041"></a><a class="code" href="classCXLController.html#a4192f529627c76fa7a70ae23b9582516">00041</a>   <span class="keyword">protected</span> <a class="code" href="classCXLController.html#a4192f529627c76fa7a70ae23b9582516">$_menu</a> = array( );
<a name="l00049"></a><a class="code" href="classCXLController.html#aa29f8061f06b0d1991b405eb2b5817fd">00049</a>   <span class="keyword">protected</span> <a class="code" href="classCXLController.html#aa29f8061f06b0d1991b405eb2b5817fd">$_breadcrumbs</a> = array( );
<a name="l00055"></a><a class="code" href="classCXLController.html#a4d69ce5758da90c27ff027a2a585b12d">00055</a>   <span class="keyword">protected</span> <a class="code" href="classCXLController.html#a4d69ce5758da90c27ff027a2a585b12d">$_pageHeading</a>;
<a name="l00060"></a><a class="code" href="classCXLController.html#aa59919f08891da659e63b956bc0eb51b">00060</a>   <span class="keyword">protected</span> <a class="code" href="classCXLController.html#aa59919f08891da659e63b956bc0eb51b">$_actionMethodPrefix</a> = <span class="stringliteral">&#39;action&#39;</span>;
<a name="l00065"></a><a class="code" href="classCXLController.html#abdf2c7ca76e9731f3240034f06c59369">00065</a>   <span class="keyword">protected</span> <a class="code" href="classCXLController.html#abdf2c7ca76e9731f3240034f06c59369">$_currentModel</a> = null;
<a name="l00071"></a><a class="code" href="classCXLController.html#a90080dcb26627bf719d96ab99e51f958">00071</a>   <span class="keyword">protected</span> <a class="code" href="classCXLController.html#a90080dcb26627bf719d96ab99e51f958">$_modelClass</a> = null;
<a name="l00077"></a><a class="code" href="classCXLController.html#a60dfb02e8707a7eabb0f0573a607ba6d">00077</a>   <span class="keyword">protected</span> <a class="code" href="classCXLController.html#a60dfb02e8707a7eabb0f0573a607ba6d">$_contentTemplate</a> = null;
<a name="l00083"></a><a class="code" href="classCXLController.html#ab2767a4ea7c0e2a4469056d506d354ba">00083</a>   <span class="keyword">protected</span> <a class="code" href="classCXLController.html#ab2767a4ea7c0e2a4469056d506d354ba">$_autoFindLayout</a> = <span class="keyword">true</span>;
<a name="l00089"></a><a class="code" href="classCXLController.html#a6f28f5590fd179dd9b15a0647118661e">00089</a>   <span class="keyword">protected</span> <a class="code" href="classCXLController.html#a6f28f5590fd179dd9b15a0647118661e">$_autoFindAction</a> = <span class="keyword">true</span>;
<a name="l00095"></a><a class="code" href="classCXLController.html#aec275c56f2c1e8ffe8a5e454a2b695b5">00095</a>   <span class="keyword">protected</span> <a class="code" href="classCXLController.html#aec275c56f2c1e8ffe8a5e454a2b695b5">$_adminCommandMap</a> = array( );
<a name="l00100"></a><a class="code" href="classCXLController.html#a1a4bf00b331c163adc5f346e51ecb51f">00100</a>   <span class="keyword">protected</span> <a class="code" href="classCXLController.html#a1a4bf00b331c163adc5f346e51ecb51f">$_actionStack</a> = array( );
<a name="l00105"></a><a class="code" href="classCXLController.html#a2e9a5f68d4557c2e220a4a8b01cf9b1b">00105</a>   <span class="keyword">protected</span> <a class="code" href="classCXLController.html#a2e9a5f68d4557c2e220a4a8b01cf9b1b">$_portletActions</a> = array( );
<a name="l00110"></a><a class="code" href="classCXLController.html#a32acaa681d9d516f9964704f41590546">00110</a>   <span class="keyword">protected</span> <a class="code" href="classCXLController.html#a32acaa681d9d516f9964704f41590546">$_viewData</a> = array( );
<a name="l00116"></a><a class="code" href="classCXLController.html#a7d16c40c2d533779317b383d69e59ea0">00116</a>   <span class="keyword">protected</span> <a class="code" href="classCXLController.html#a7d16c40c2d533779317b383d69e59ea0">$_extraViewDataList</a> = array( );
<a name="l00122"></a><a class="code" href="classCXLController.html#a41793f2872b496a2d4effc0da5f82a3c">00122</a>   <span class="keyword">protected</span> <a class="code" href="classCXLController.html#a41793f2872b496a2d4effc0da5f82a3c">$_extraViewDataPrefix</a> = <span class="charliteral">&#39;_&#39;</span>;
<a name="l00123"></a>00123 
<a name="l00124"></a>00124   <span class="comment">//********************************************************************************</span>
<a name="l00125"></a>00125   <span class="comment">//* Public Methods</span>
<a name="l00126"></a>00126   <span class="comment">//********************************************************************************</span>
<a name="l00127"></a>00127 
<a name="l00131"></a><a class="code" href="classCXLController.html#a4be4055f3361d4800e16bc2e2e38cda6">00131</a>   <span class="keyword">public</span> function <a class="code" href="classCXLController.html#a4be4055f3361d4800e16bc2e2e38cda6" title="Initialize the controller.">init</a>()
<a name="l00132"></a>00132   {
<a name="l00133"></a>00133     <span class="comment">//  Phone home...</span>
<a name="l00134"></a>00134     <a class="code" href="classCXLController.html#a4be4055f3361d4800e16bc2e2e38cda6" title="Initialize the controller.">parent::init</a>();
<a name="l00135"></a>00135 
<a name="l00136"></a>00136     <span class="comment">//  Find layout...</span>
<a name="l00137"></a>00137     <span class="keywordflow">if</span> ( PHP_SAPI != <span class="stringliteral">&#39;cli&#39;</span> &amp;&amp; $this-&gt;_autoFindLayout &amp;&amp; ! <a class="code" href="classYiiXLBase.html#ae09ab8187b8a6c8c52edbf143ab29178" title="Shorthand version of Yii::app().">XL::_a</a>() instanceof CConsoleApplication )
<a name="l00138"></a>00138     {
<a name="l00139"></a>00139       <span class="keywordflow">if</span> ( file_exists( <a class="code" href="classYiiXLBase.html#affd02de4bb532b2fb524f94f4e5ea40a">XL::_gbp</a>() . <span class="stringliteral">&#39;/views/layouts/&#39;</span> . $this-&gt;getId() . <span class="stringliteral">&#39;.php&#39;</span> ) ) 
<a name="l00140"></a>00140         $this-&gt;_pageLayout = $this-&gt;getId();
<a name="l00141"></a>00141     }
<a name="l00142"></a>00142 
<a name="l00143"></a>00143     <span class="comment">//  Allow errors</span>
<a name="l00144"></a>00144     $this-&gt;addActionControl( self::ACCESS_TO_ANY, <span class="stringliteral">&#39;error&#39;</span> );
<a name="l00145"></a>00145 
<a name="l00146"></a>00146     <span class="comment">//  Ensure conformity</span>
<a name="l00147"></a>00147     <span class="keywordflow">if</span> ( !is_array( $this-&gt;_extraViewDataList ) ) 
<a name="l00148"></a>00148       $this-&gt;_extraViewDataList = array();
<a name="l00149"></a>00149 
<a name="l00150"></a>00150     <span class="comment">//  Add &quot;currentUser&quot; value to extra view data</span>
<a name="l00151"></a>00151     <span class="keywordflow">if</span> ( null === <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $this-&gt;_extraViewDataList, $this-&gt;_extraViewDataPrefix . <span class="stringliteral">&#39;currentUser&#39;</span> ) ) 
<a name="l00152"></a>00152       $this-&gt;_extraViewDataList[$this-&gt;_extraViewDataPrefix . <span class="stringliteral">&#39;currentUser&#39;</span>] = <a class="code" href="classYiiXLBase.html#a23d250b00a90dbb026ebe72ce040eca4">XL::_gcu</a>();
<a name="l00153"></a>00153 
<a name="l00154"></a>00154     <span class="comment">//  And some defaults...</span>
<a name="l00155"></a>00155     $this-&gt;defaultAction = <span class="stringliteral">&#39;index&#39;</span>;
<a name="l00156"></a>00156   }
<a name="l00157"></a>00157 
<a name="l00187"></a><a class="code" href="classCXLController.html#ae353790f09e1f72e1cc81d21a6eb9bed">00187</a>   <span class="keyword">public</span> function <a class="code" href="classCXLController.html#ae353790f09e1f72e1cc81d21a6eb9bed" title="How about a default action that displays static pages? Huh? Huh?">actions</a>()
<a name="l00188"></a>00188   {
<a name="l00189"></a>00189     <span class="keywordflow">return</span> array_merge(
<a name="l00190"></a>00190       array(
<a name="l00191"></a>00191         <span class="stringliteral">&#39;_static&#39;</span> =&gt; array(
<a name="l00192"></a>00192           <span class="stringliteral">&#39;class&#39;</span> =&gt; <span class="stringliteral">&#39;CViewAction&#39;</span>,
<a name="l00193"></a>00193           <span class="stringliteral">&#39;basePath&#39;</span> =&gt; <span class="stringliteral">&#39;_static&#39;</span>,
<a name="l00194"></a>00194         ),
<a name="l00195"></a>00195       ), parent::actions()
<a name="l00196"></a>00196     );
<a name="l00197"></a>00197   }
<a name="l00198"></a>00198 
<a name="l00207"></a><a class="code" href="classCXLController.html#ab9196d5e77e86dc16866c3b5373963a2">00207</a>   <span class="keyword">public</span> function <a class="code" href="classCXLController.html#ab9196d5e77e86dc16866c3b5373963a2" title="A generic action that renders a page and passes in the model.">genericAction</a>( $actionId, $model = null, $extraParameters = array( ), $modelVariableName = <span class="stringliteral">&#39;model&#39;</span>, $flashMessageKey = null, $flashMessageValue = null, $flashMessageDefaultValue = null )
<a name="l00208"></a>00208   {
<a name="l00209"></a>00209     <span class="keywordflow">if</span> ( $flashMessageKey ) 
<a name="l00210"></a>00210       <a class="code" href="classYiiXLBase.html#ac2bdee30f3e1ff39d01e094d6c6c311e" title="Stores a flash message.">XL::_sf</a>( $flashMessageKey, $flashMessageValue, $flashMessageDefaultValue );
<a name="l00211"></a>00211     
<a name="l00212"></a>00212     $this-&gt;render( 
<a name="l00213"></a>00213       $actionId, 
<a name="l00214"></a>00214       array_merge( 
<a name="l00215"></a>00215         $extraParameters, 
<a name="l00216"></a>00216         array( 
<a name="l00217"></a>00217           $modelVariableName =&gt; ( $model ) ? $model : $this-&gt;<a class="code" href="classCXLController.html#aee989705ca23d787542be0bf30a28000" title="Returns the data model based on the primary key given in the GET variable.">loadCurrentModel</a>() 
<a name="l00218"></a>00218         )
<a name="l00219"></a>00219       )
<a name="l00220"></a>00220     );
<a name="l00221"></a>00221   }
<a name="l00222"></a>00222 
<a name="l00230"></a><a class="code" href="classCXLController.html#aee989705ca23d787542be0bf30a28000">00230</a>   <span class="keyword">public</span> function <a class="code" href="classCXLController.html#aee989705ca23d787542be0bf30a28000" title="Returns the data model based on the primary key given in the GET variable.">loadCurrentModel</a>( $id = null )
<a name="l00231"></a>00231   {
<a name="l00232"></a>00232     <span class="keywordflow">if</span> ( null === $this-&gt;_currentModel )
<a name="l00233"></a>00233     {
<a name="l00234"></a>00234       $_id = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $_GET, <span class="stringliteral">&#39;id&#39;</span>, $id );
<a name="l00235"></a>00235       $this-&gt;_currentModel = $this-&gt;<a class="code" href="classCXLController.html#a60bcb5a5a2a82bb81a4ae4b07ef4d3bb">_load</a>( $_id );
<a name="l00236"></a>00236 
<a name="l00237"></a>00237       <span class="comment">//  No data? bug out</span>
<a name="l00238"></a>00238       <span class="keywordflow">if</span> ( null === $this-&gt;_currentModel )
<a name="l00239"></a>00239         $this-&gt;redirect( array( $this-&gt;defaultAction ) );
<a name="l00240"></a>00240 
<a name="l00241"></a>00241       <span class="comment">//  Get the name of this model...</span>
<a name="l00242"></a>00242       $this-&gt;<a class="code" href="group__propaccs__cxlcontroller.html#ga24e8b6f39d6a823d94317e35f1b94758">setModelClass</a>( get_class( $this-&gt;_currentModel ) );
<a name="l00243"></a>00243     }
<a name="l00244"></a>00244 
<a name="l00245"></a>00245     <span class="comment">//  Return our model...</span>
<a name="l00246"></a>00246     <span class="keywordflow">return</span> $this-&gt;_currentModel;
<a name="l00247"></a>00247   }
<a name="l00248"></a>00248 
<a name="l00255"></a><a class="code" href="classCXLController.html#a3d33455ae87de01aa0051c43be585ee7">00255</a>   <span class="keyword">public</span> function <a class="code" href="classCXLController.html#a3d33455ae87de01aa0051c43be585ee7" title="Provide automatic missing action mapping...">missingAction</a>( $actionId = null )
<a name="l00256"></a>00256   {
<a name="l00257"></a>00257     <span class="keywordflow">if</span> ( $this-&gt;_autoFindAction )
<a name="l00258"></a>00258     {
<a name="l00259"></a>00259       <span class="keywordflow">if</span> ( empty( $actionId ) ) $actionId = $this-&gt;defaultAction;
<a name="l00260"></a>00260 
<a name="l00261"></a>00261       <span class="keywordflow">if</span> ( $this-&gt;getViewFile( $actionId ) )
<a name="l00262"></a>00262       {
<a name="l00263"></a>00263         $this-&gt;render( $actionId );
<a name="l00264"></a>00264         <span class="keywordflow">return</span>;
<a name="l00265"></a>00265       }
<a name="l00266"></a>00266     }
<a name="l00267"></a>00267 
<a name="l00268"></a>00268     <a class="code" href="classCXLController.html#a3d33455ae87de01aa0051c43be585ee7" title="Provide automatic missing action mapping...">parent::missingAction</a>( $actionId );
<a name="l00269"></a>00269   }
<a name="l00270"></a>00270 
<a name="l00275"></a><a class="code" href="classCXLController.html#a8471fa2c95307d608c34f15dae47d254">00275</a>   <span class="keyword">public</span> function <a class="code" href="classCXLController.html#a8471fa2c95307d608c34f15dae47d254" title="Our error handler...">actionError</a>()
<a name="l00276"></a>00276   {
<a name="l00277"></a>00277     <span class="keywordflow">if</span> ( null === ( $_error = <a class="code" href="classYiiXLBase.html#af931bb2b4edcc29e082528f133f7a62f">XL::_gco</a>( <span class="stringliteral">&#39;errorHandler&#39;</span> )-&gt;error ) )
<a name="l00278"></a>00278     {
<a name="l00279"></a>00279       <span class="keywordflow">if</span> ( ! $this-&gt;isAjaxRequest() ) 
<a name="l00280"></a>00280         <span class="keywordflow">throw</span> <span class="keyword">new</span> CHttpException( 404, <span class="stringliteral">&#39;Page not found.&#39;</span> );
<a name="l00281"></a>00281       
<a name="l00282"></a>00282       echo $_error[<span class="stringliteral">&#39;message&#39;</span>];
<a name="l00283"></a>00283     }
<a name="l00284"></a>00284 
<a name="l00285"></a>00285     $this-&gt;render( 
<a name="l00286"></a>00286       <span class="stringliteral">&#39;error&#39;</span>, 
<a name="l00287"></a>00287       array( 
<a name="l00288"></a>00288         <span class="stringliteral">&#39;error&#39;</span> =&gt; $_error 
<a name="l00289"></a>00289       )
<a name="l00290"></a>00290     );
<a name="l00291"></a>00291   }
<a name="l00292"></a>00292 
<a name="l00297"></a><a class="code" href="classCXLController.html#adf1a35ad20e475c59cc0967d5764aa22">00297</a>   <span class="keyword">public</span> function <a class="code" href="classCXLController.html#adf1a35ad20e475c59cc0967d5764aa22" title="Convenience access to Yii request.">getRequest</a>()
<a name="l00298"></a>00298   {
<a name="l00299"></a>00299     <span class="keywordflow">return</span> <a class="code" href="classYiiXLBase.html#ad94454df47e24b75197910a090e61ffa" title="Returns the current request.">XL::_gr</a>();
<a name="l00300"></a>00300   }
<a name="l00301"></a>00301 
<a name="l00307"></a><a class="code" href="classCXLController.html#ae348b4354879b012496b19989bf6d9cf">00307</a>   <span class="keyword">public</span> function <a class="code" href="classCXLController.html#ae348b4354879b012496b19989bf6d9cf" title="See if there are any commands that need processing.">beforeAction</a>( $action )
<a name="l00308"></a>00308   {
<a name="l00309"></a>00309     <span class="comment">//  If we have commands, give it a shot...</span>
<a name="l00310"></a>00310     <span class="keywordflow">if</span> ( count( $this-&gt;_adminCommandMap ) &amp;&amp; parent::beforeAction( $action ) ) 
<a name="l00311"></a>00311       $this-&gt;<a class="code" href="classCXLController.html#aa4220b2012e6ab707b3d553c4a9e2fae" title="Executes any commands Maps to CXLController::commandMap and calls the appropriate method...">_processCommand</a>();
<a name="l00312"></a>00312 
<a name="l00313"></a>00313     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00314"></a>00314   }
<a name="l00315"></a>00315 
<a name="l00336"></a><a class="code" href="classCXLController.html#acaf53d84b70927098a40b8e626985146">00336</a>   <span class="keyword">public</span> function <a class="code" href="classCXLController.html#acaf53d84b70927098a40b8e626985146" title="Renders a view with a layout.">newRender</a>( $viewName, $viewData = null, $returnString = <span class="keyword">false</span> )
<a name="l00337"></a>00337   {
<a name="l00338"></a>00338     <span class="comment">//  make sure we&#39;re all on the same page...</span>
<a name="l00339"></a>00339     $this-&gt;_pageLayout = $this-&gt;layout;
<a name="l00340"></a>00340 
<a name="l00341"></a>00341     $_output = $this-&gt;<a class="code" href="classCXLController.html#a8324b095d3faa196d784f84a3f0cef25" title="Renders a view.">renderPartial</a>( $viewName, $viewData, <span class="keyword">true</span> );
<a name="l00342"></a>00342 
<a name="l00343"></a>00343     <span class="keywordflow">if</span> ( $this-&gt;_pageLayout &amp;&amp; <span class="keyword">false</span> !== ( $_layoutFile = $this-&gt;getLayoutFile( $this-&gt;_pageLayout ) ) )
<a name="l00344"></a>00344     {
<a name="l00345"></a>00345       <span class="comment">//  Process content layout if required</span>
<a name="l00346"></a>00346       <span class="keywordflow">if</span> ( $this-&gt;_contentTemplate &amp;&amp; <span class="keyword">false</span> !== ( $_contentTemplateFile = $this-&gt;getLayoutFile( $this-&gt;_contentTemplate ) ) ) $_output = $this-&gt;<a class="code" href="classCXLController.html#a8324b095d3faa196d784f84a3f0cef25" title="Renders a view.">renderPartial</a>( $_contentTemplateFile, $viewData, <span class="keyword">true</span> );
<a name="l00347"></a>00347 
<a name="l00348"></a>00348       $_output = $this-&gt;renderFile( $_layoutFile, array( <span class="stringliteral">&#39;content&#39;</span> =&gt; $_output ), <span class="keyword">true</span> );
<a name="l00349"></a>00349       $_output = $this-&gt;processOutput( $_output );
<a name="l00350"></a>00350     }
<a name="l00351"></a>00351 
<a name="l00352"></a>00352     <span class="keywordflow">if</span> ( $returnString ) <span class="keywordflow">return</span> $_output;
<a name="l00353"></a>00353 
<a name="l00354"></a>00354     echo $_output;
<a name="l00355"></a>00355   }
<a name="l00356"></a>00356 
<a name="l00381"></a><a class="code" href="classCXLController.html#a8324b095d3faa196d784f84a3f0cef25">00381</a>   <span class="keyword">public</span> function <a class="code" href="classCXLController.html#a8324b095d3faa196d784f84a3f0cef25" title="Renders a view.">renderPartial</a>( $view, $data = null, $return = <span class="keyword">false</span>, $processOutput = <span class="keyword">false</span> )
<a name="l00382"></a>00382   {
<a name="l00383"></a>00383     <span class="keywordflow">if</span> ( <span class="keyword">false</span> === ( $_viewFile = $this-&gt;getViewFile( $view ) ) )
<a name="l00384"></a>00384     {
<a name="l00385"></a>00385       <span class="keywordflow">throw</span> <span class="keyword">new</span> CException(
<a name="l00386"></a>00386         Yii::t(
<a name="l00387"></a>00387           self::CLASS_LOG_TAG,
<a name="l00388"></a>00388           <span class="stringliteral">&#39;{controller} cannot find the requested view &quot;{view}&quot;.&#39;</span>, 
<a name="l00389"></a>00389           array(
<a name="l00390"></a>00390             <span class="stringliteral">&#39;{controller}&#39;</span> =&gt; get_class( $this ),
<a name="l00391"></a>00391             <span class="stringliteral">&#39;{view}&#39;</span> =&gt; $view
<a name="l00392"></a>00392           )
<a name="l00393"></a>00393         )
<a name="l00394"></a>00394       );
<a name="l00395"></a>00395     }
<a name="l00396"></a>00396 
<a name="l00397"></a>00397     <span class="keywordflow">if</span> ( null === $data ) 
<a name="l00398"></a>00398       $data = array();
<a name="l00399"></a>00399 
<a name="l00400"></a>00400     $_output = $this-&gt;renderFile(
<a name="l00401"></a>00401       $_viewFile, 
<a name="l00402"></a>00402       array_merge(
<a name="l00403"></a>00403         $this-&gt;_extraViewDataList, 
<a name="l00404"></a>00404         $this-&gt;_viewData, 
<a name="l00405"></a>00405         $data
<a name="l00406"></a>00406       ),
<a name="l00407"></a>00407       <span class="keyword">true</span>
<a name="l00408"></a>00408     );
<a name="l00409"></a>00409 
<a name="l00410"></a>00410     <span class="keywordflow">if</span> ( $processOutput ) 
<a name="l00411"></a>00411       $_output = $this-&gt;processOutput( $_output );
<a name="l00412"></a>00412 
<a name="l00413"></a>00413     <span class="keywordflow">if</span> ( $return ) 
<a name="l00414"></a>00414       <span class="keywordflow">return</span> $_output;
<a name="l00415"></a>00415 
<a name="l00416"></a>00416     echo $_output;
<a name="l00417"></a>00417   }
<a name="l00418"></a>00418 
<a name="l00425"></a><a class="code" href="classCXLController.html#ae926a613a7702bb749e974f35a462d60">00425</a>   <span class="keyword">public</span> function <a class="code" href="classCXLController.html#ae926a613a7702bb749e974f35a462d60" title="Creates a standard form options array and loads page niceties.">setStandardFormOptions</a>( $model, $optionList = array( ) )
<a name="l00426"></a>00426   {
<a name="l00427"></a>00427     <span class="comment">//  Shortcut... only passed in the title...</span>
<a name="l00428"></a>00428     <span class="keywordflow">if</span> ( is_string( $optionList ) )
<a name="l00429"></a>00429     {
<a name="l00430"></a>00430       $_title = $optionList;
<a name="l00431"></a>00431 
<a name="l00432"></a>00432       $optionList = array(
<a name="l00433"></a>00433         <span class="stringliteral">&#39;title&#39;</span> =&gt; <a class="code" href="classYiiXLBase.html#a1d56b31ce9c7910652552fbbff54e753">XL::_gan</a>() . <span class="stringliteral">&#39; :: &#39;</span> . $_title,
<a name="l00434"></a>00434         <span class="stringliteral">&#39;breadcrumbs&#39;</span> =&gt; array( $_title ),
<a name="l00435"></a>00435       );
<a name="l00436"></a>00436     }
<a name="l00437"></a>00437 
<a name="l00438"></a>00438     <span class="comment">//  Abbreviated arguments?</span>
<a name="l00439"></a>00439     <span class="keywordflow">if</span> ( is_array( $model ) &amp;&amp; array( ) === $optionList )
<a name="l00440"></a>00440     {
<a name="l00441"></a>00441       $optionList = $model;
<a name="l00442"></a>00442       $model = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $optionList, <span class="stringliteral">&#39;model&#39;</span> );
<a name="l00443"></a>00443     }
<a name="l00444"></a>00444 
<a name="l00445"></a>00445     <span class="comment">//  Set the standard nav options</span>
<a name="l00446"></a>00446     $this-&gt;<a class="code" href="classCXLController.html#a592bdbc48efc56a00e5b49582db7c09f" title="Sets the standard page navigation options (title, crumbs, menu, etc.">setViewNavigationOptions</a>( $optionList );
<a name="l00447"></a>00447 
<a name="l00448"></a>00448     $_formId = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $optionList, <span class="stringliteral">&#39;id&#39;</span>, <span class="stringliteral">&#39;ps-edit-form&#39;</span> );
<a name="l00449"></a>00449 
<a name="l00450"></a>00450     <span class="comment">//  Put a cool flash span on the page</span>
<a name="l00451"></a>00451     <span class="keywordflow">if</span> ( <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $options, <span class="stringliteral">&#39;enableFlash&#39;</span>, <span class="keyword">true</span>, <span class="keyword">true</span> ) )
<a name="l00452"></a>00452     {
<a name="l00453"></a>00453       $_flashClass = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $options, <span class="stringliteral">&#39;flashSuccessClass&#39;</span>, <span class="stringliteral">&#39;operation-result-success&#39;</span> );
<a name="l00454"></a>00454 
<a name="l00455"></a>00455       <span class="keywordflow">if</span> ( null === ( $_message = <a class="code" href="classYiiXLBase.html#a1f5b11e66cea38099ad43bd1c41b6dc6" title="Returns a flash message.">XL::_gf</a>( <span class="stringliteral">&#39;success&#39;</span> ) ) )
<a name="l00456"></a>00456       {
<a name="l00457"></a>00457         <span class="keywordflow">if</span> ( null !== ( $_message = <a class="code" href="classYiiXLBase.html#a1f5b11e66cea38099ad43bd1c41b6dc6" title="Returns a flash message.">XL::_gf</a>( <span class="stringliteral">&#39;failure&#39;</span> ) ) ) $_flashClass = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $options, <span class="stringliteral">&#39;flashFailureClass&#39;</span>, <span class="stringliteral">&#39;operation-result-failure&#39;</span> );
<a name="l00458"></a>00458       }
<a name="l00459"></a>00459 
<a name="l00460"></a>00460       $_spanId = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $options, <span class="stringliteral">&#39;flashSpanId&#39;</span>, <span class="stringliteral">&#39;operation-result&#39;</span>, <span class="keyword">true</span> );
<a name="l00461"></a>00461       <a class="code" href="classYiiXLBase.html#aa5c4459afda5a8a58c46a26aecafaf37" title="Stores a variable from the user session.">XL::_ss</a>( <span class="stringliteral">&#39;psForm-flash-html&#39;</span>, XL::tag( <span class="stringliteral">&#39;span&#39;</span>, array( <span class="stringliteral">&#39;id&#39;</span> =&gt; $_spanId, <span class="stringliteral">&#39;class&#39;</span> =&gt; $_flashClass ), $_message ) );
<a name="l00462"></a>00462 
<a name="l00463"></a>00463       <span class="comment">//  Register a nice little fader...</span>
<a name="l00464"></a>00464       $_fader = &lt;&lt;&lt;SCRIPT
<a name="l00465"></a>00465 $(<span class="stringliteral">&#39;#{$_spanId}&#39;</span>).fadeIn(<span class="stringliteral">&#39;500&#39;</span>,function(){
<a name="l00466"></a>00466   $(<span class="keyword">this</span>).delay(3000).fadeOut(3500);
<a name="l00467"></a>00467 });
<a name="l00468"></a>00468 SCRIPT;
<a name="l00469"></a>00469 
<a name="l00470"></a>00470       <a class="code" href="classYiiXLBase.html#a982d30aee3a52f73b0e935ef7c81b03b" title="Registers a piece of javascript code.">XL::_rs</a>( $_formId . <span class="charliteral">&#39;.&#39;</span> . $_spanId . <span class="stringliteral">&#39;.fader&#39;</span>, $_fader, CClientScript::POS_READY );
<a name="l00471"></a>00471     }
<a name="l00472"></a>00472 
<a name="l00473"></a>00473     XL::setFormFieldContainerClass( <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $optionList, <span class="stringliteral">&#39;rowClass&#39;</span>, <span class="stringliteral">&#39;row&#39;</span> ) );
<a name="l00474"></a>00474 
<a name="l00475"></a>00475     $_formOptions = array(
<a name="l00476"></a>00476       <span class="stringliteral">&#39;id&#39;</span> =&gt; $_formId,
<a name="l00477"></a>00477       <span class="stringliteral">&#39;showLegend&#39;</span> =&gt; <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $optionList, <span class="stringliteral">&#39;showLegend&#39;</span>, <span class="keyword">true</span> ),
<a name="l00478"></a>00478       <span class="stringliteral">&#39;showDates&#39;</span> =&gt; <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $optionList, <span class="stringliteral">&#39;showDates&#39;</span>, <span class="keyword">false</span> ),
<a name="l00479"></a>00479       <span class="stringliteral">&#39;method&#39;</span> =&gt; <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $optionList, <span class="stringliteral">&#39;method&#39;</span>, <span class="stringliteral">&#39;POST&#39;</span> ),
<a name="l00480"></a>00480       <span class="stringliteral">&#39;uiStyle&#39;</span> =&gt; <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $optionList, <span class="stringliteral">&#39;uiStyle&#39;</span>, XL::UI_JQUERY ),
<a name="l00481"></a>00481       <span class="stringliteral">&#39;formClass&#39;</span> =&gt; <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $optionList, <span class="stringliteral">&#39;formClass&#39;</span>, <span class="stringliteral">&#39;form&#39;</span> ),
<a name="l00482"></a>00482       <span class="stringliteral">&#39;formModel&#39;</span> =&gt; $model,
<a name="l00483"></a>00483       <span class="stringliteral">&#39;errorCss&#39;</span> =&gt; <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $optionList, <span class="stringliteral">&#39;errorCss&#39;</span>, <span class="stringliteral">&#39;error&#39;</span> ),
<a name="l00484"></a>00484       <span class="comment">//  We want error summary...</span>
<a name="l00485"></a>00485       <span class="stringliteral">&#39;errorSummary&#39;</span> =&gt; <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $optionList, <span class="stringliteral">&#39;errorSummary&#39;</span>, <span class="keyword">true</span> ),
<a name="l00486"></a>00486       <span class="stringliteral">&#39;errorSummaryOptions&#39;</span> =&gt; array(
<a name="l00487"></a>00487         <span class="stringliteral">&#39;header&#39;</span> =&gt; <span class="stringliteral">&#39;&lt;p&gt;The following problems occurred:&lt;/p&gt;&#39;</span>,
<a name="l00488"></a>00488       ),
<a name="l00489"></a>00489       <span class="stringliteral">&#39;validate&#39;</span> =&gt; <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $optionList, <span class="stringliteral">&#39;validate&#39;</span>, <span class="keyword">true</span> ),
<a name="l00490"></a>00490       <span class="stringliteral">&#39;validateOptions&#39;</span> =&gt; <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $optionList, <span class="stringliteral">&#39;validateOptions&#39;</span>, array(
<a name="l00491"></a>00491         <span class="stringliteral">&#39;ignoreTitle&#39;</span> =&gt; <span class="keyword">true</span>,
<a name="l00492"></a>00492         <span class="stringliteral">&#39;errorClass&#39;</span> =&gt; <span class="stringliteral">&#39;ps-validate-error&#39;</span>,
<a name="l00493"></a>00493         )
<a name="l00494"></a>00494       ),
<a name="l00495"></a>00495     );
<a name="l00496"></a>00496 
<a name="l00497"></a>00497     <span class="comment">//  Do some auto-page-setup...</span>
<a name="l00498"></a>00498     <span class="keywordflow">if</span> ( null !== ( $_header = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $optionList, <span class="stringliteral">&#39;header&#39;</span>, <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $optionList, <span class="stringliteral">&#39;title&#39;</span> ) ) ) )
<a name="l00499"></a>00499     {
<a name="l00500"></a>00500       <span class="keywordflow">if</span> ( null !== ( $_headerIcon = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $optionList, <span class="stringliteral">&#39;headerIcon&#39;</span> ) ) ) $_header = XL::tag( <span class="stringliteral">&#39;span&#39;</span>, array( ), XL::image( $_headerIcon ) ) . $_header;
<a name="l00501"></a>00501 
<a name="l00502"></a>00502       echo XL::tag( <span class="stringliteral">&#39;h1&#39;</span>, array( <span class="stringliteral">&#39;class&#39;</span> =&gt; <span class="stringliteral">&#39;ui-generated-header&#39;</span> ), $_header );
<a name="l00503"></a>00503     }
<a name="l00504"></a>00504 
<a name="l00505"></a>00505     <span class="comment">//  Do some auto-page-setup...</span>
<a name="l00506"></a>00506     <span class="keywordflow">if</span> ( null !== ( $_subHeader = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $optionList, <span class="stringliteral">&#39;subHeader&#39;</span> ) ) ) echo XL::tag( <span class="stringliteral">&#39;div&#39;</span>, array( ), $_subHeader );
<a name="l00507"></a>00507 
<a name="l00508"></a>00508     <span class="keywordflow">if</span> ( <span class="keyword">false</span> !== <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $optionList, <span class="stringliteral">&#39;renderSearch&#39;</span>, <span class="keyword">false</span> ) )
<a name="l00509"></a>00509     {
<a name="l00510"></a>00510       echo XL::tag( <span class="charliteral">&#39;p&#39;</span>, array( ), self::SEARCH_HELP_TEXT );
<a name="l00511"></a>00511       echo XL::link( <span class="stringliteral">&#39;Advanced Search&#39;</span>, <span class="charliteral">&#39;#&#39;</span>, array( <span class="stringliteral">&#39;class&#39;</span> =&gt; <span class="stringliteral">&#39;search-button&#39;</span> ) );
<a name="l00512"></a>00512 
<a name="l00513"></a>00513       echo XL::tag(
<a name="l00514"></a>00514         <span class="stringliteral">&#39;div&#39;</span>, array( <span class="stringliteral">&#39;class&#39;</span> =&gt; <span class="stringliteral">&#39;search-form&#39;</span> ), $this-&gt;<a class="code" href="classCXLController.html#a8324b095d3faa196d784f84a3f0cef25" title="Renders a view.">renderPartial</a>( <span class="stringliteral">&#39;_search&#39;</span>, array( <span class="stringliteral">&#39;model&#39;</span> =&gt; $model ), <span class="keyword">true</span> )
<a name="l00515"></a>00515       );
<a name="l00516"></a>00516 
<a name="l00517"></a>00517       <span class="comment">//  Register the search script, if any</span>
<a name="l00518"></a>00518       <span class="keywordflow">if</span> ( null !== ( $_searchScript = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $optionList, <span class="stringliteral">&#39;__searchScript&#39;</span> ) ) ) <a class="code" href="classYiiXLBase.html#a982d30aee3a52f73b0e935ef7c81b03b" title="Registers a piece of javascript code.">XL::_rs</a>( <span class="stringliteral">&#39;search&#39;</span>, $_searchScript );
<a name="l00519"></a>00519     }
<a name="l00520"></a>00520 
<a name="l00521"></a>00521     <span class="keywordflow">if</span> ( XL::UI_JQUERY == ( $_uiStyle = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $optionList, <span class="stringliteral">&#39;uiStyle&#39;</span>, XL::UI_JQUERY ) ) ) CPSjqUIWrapper::loadScripts();
<a name="l00522"></a>00522 
<a name="l00523"></a>00523     <span class="keywordflow">return</span> $_formOptions;
<a name="l00524"></a>00524   }
<a name="l00525"></a>00525 
<a name="l00531"></a><a class="code" href="classCXLController.html#a136cf4fecb17df00146f6889ffdbccee">00531</a>   <span class="keyword">public</span> function <a class="code" href="classCXLController.html#a136cf4fecb17df00146f6889ffdbccee" title="Sets the content type for this page to the specified MIME type.">setContentType</a>( $contentType, $noLayout = <span class="keyword">true</span> )
<a name="l00532"></a>00532   {
<a name="l00533"></a>00533     <span class="keywordflow">if</span> ( $noLayout ) $this-&gt;layout = <span class="keyword">false</span>;
<a name="l00534"></a>00534     header( <span class="stringliteral">&#39;Content-Type: &#39;</span> . $contentType );
<a name="l00535"></a>00535   }
<a name="l00536"></a>00536 
<a name="l00541"></a><a class="code" href="classCXLController.html#a592bdbc48efc56a00e5b49582db7c09f">00541</a>   <span class="keyword">public</span> function <a class="code" href="classCXLController.html#a592bdbc48efc56a00e5b49582db7c09f" title="Sets the standard page navigation options (title, crumbs, menu, etc.">setViewNavigationOptions</a>( &amp;$options = array( ) )
<a name="l00542"></a>00542   {
<a name="l00543"></a>00543     <span class="comment">//  Page title</span>
<a name="l00544"></a>00544     $_title = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $options, <span class="stringliteral">&#39;title&#39;</span>, null, <span class="keyword">true</span> );
<a name="l00545"></a>00545     $_subtitle = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $options, <span class="stringliteral">&#39;subtitle&#39;</span>, null, <span class="keyword">true</span> );
<a name="l00546"></a>00546     $_header = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $options, <span class="stringliteral">&#39;header&#39;</span> );
<a name="l00547"></a>00547 
<a name="l00548"></a>00548     <span class="comment">//  Generate subtitle from header...</span>
<a name="l00549"></a>00549     <span class="keywordflow">if</span> ( null === $_title &amp;&amp; null === $_subtitle &amp;&amp; null !== $_header ) $_subtitle = $_header;
<a name="l00550"></a>00550 
<a name="l00551"></a>00551     <span class="keywordflow">if</span> ( $_subtitle ) $_title = <a class="code" href="classYiiXLBase.html#a1d56b31ce9c7910652552fbbff54e753">XL::_gan</a>() . <span class="stringliteral">&#39; :: &#39;</span> . $_subtitle;
<a name="l00552"></a>00552 
<a name="l00553"></a>00553     <span class="keywordflow">if</span> ( !$_title ) $_title = <a class="code" href="classYiiXLBase.html#a1d56b31ce9c7910652552fbbff54e753">XL::_gan</a>();
<a name="l00554"></a>00554 
<a name="l00555"></a>00555     $this-&gt;setPageTitle( $options[<span class="stringliteral">&#39;title&#39;</span>] = $_title );
<a name="l00556"></a>00556 
<a name="l00557"></a>00557     <span class="comment">//  Set crumbs</span>
<a name="l00558"></a>00558     $this-&gt;_breadcrumbs = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $options, <span class="stringliteral">&#39;breadcrumbs&#39;</span> );
<a name="l00559"></a>00559 
<a name="l00560"></a>00560     <span class="comment">//  Let side menu be set from here as well...</span>
<a name="l00561"></a>00561     <span class="keywordflow">if</span> ( null !== ( $_menuItems = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $options, <span class="stringliteral">&#39;menu&#39;</span>, null ) ) )
<a name="l00562"></a>00562     {
<a name="l00563"></a>00563       <span class="comment">//  Rebuild menu items if not in standard format</span>
<a name="l00564"></a>00564       $_finalMenu = array( );
<a name="l00565"></a>00565 
<a name="l00566"></a>00566       <span class="keywordflow">foreach</span> ( $_menuItems as $_itemLabel =&gt; $_itemLink )
<a name="l00567"></a>00567       {
<a name="l00568"></a>00568         <span class="keywordflow">if</span> ( null === ( $_label = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $_itemLink, <span class="stringliteral">&#39;label&#39;</span>, null, <span class="keyword">true</span> ) ) ) $_label = $_itemLabel;
<a name="l00569"></a>00569 
<a name="l00570"></a>00570         <span class="keywordflow">if</span> ( null === ( $_link = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $_itemLink, <span class="stringliteral">&#39;link&#39;</span>, null, <span class="keyword">true</span> ) ) ) $_link = $_itemLink;
<a name="l00571"></a>00571 
<a name="l00572"></a>00572         $_finalMenu[] = array(
<a name="l00573"></a>00573           <span class="stringliteral">&#39;label&#39;</span> =&gt; $_label,
<a name="l00574"></a>00574           <span class="stringliteral">&#39;url&#39;</span> =&gt; $_link,
<a name="l00575"></a>00575         );
<a name="l00576"></a>00576       }
<a name="l00577"></a>00577 
<a name="l00578"></a>00578       $options[<span class="stringliteral">&#39;menu&#39;</span>] = $this-&gt;_menu = $_finalMenu;
<a name="l00579"></a>00579     }
<a name="l00580"></a>00580 
<a name="l00581"></a>00581     $_enableSearch = ( <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $options, <span class="stringliteral">&#39;enableSearch&#39;</span>, <span class="keyword">false</span> ) || <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $options, <span class="stringliteral">&#39;renderSearch&#39;</span>, <span class="keyword">false</span> ) );
<a name="l00582"></a>00582 
<a name="l00583"></a>00583     <span class="comment">//  Drop the search script on the page if enabled...</span>
<a name="l00584"></a>00584     <span class="keywordflow">if</span> ( <span class="keyword">false</span> !== $_enableSearch )
<a name="l00585"></a>00585     {
<a name="l00586"></a>00586       $_searchSelector = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $options, <span class="stringliteral">&#39;searchSelector&#39;</span>, <span class="stringliteral">&#39;.search-button&#39;</span> );
<a name="l00587"></a>00587       $_toggleSpeed = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $options, <span class="stringliteral">&#39;toggleSpeed&#39;</span>, <span class="stringliteral">&#39;fast&#39;</span> );
<a name="l00588"></a>00588       $_searchForm = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $options, <span class="stringliteral">&#39;searchForm&#39;</span>, <span class="stringliteral">&#39;.search-form&#39;</span> );
<a name="l00589"></a>00589       $_targetFormId = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $options, <span class="stringliteral">&#39;id&#39;</span>, <span class="stringliteral">&#39;ps-edit-form&#39;</span> );
<a name="l00590"></a>00590 
<a name="l00591"></a>00591       $_searchScript = &lt;&lt;&lt;JS
<a name="l00592"></a>00592 $(function(){
<a name="l00593"></a>00593   $(<span class="stringliteral">&#39;{$_searchSelector}&#39;</span>).click(function(){
<a name="l00594"></a>00594     $(<span class="stringliteral">&#39;{$_searchForm}&#39;</span>).slideToggle(<span class="stringliteral">&#39;{$_toggleSpeed}&#39;</span>);
<a name="l00595"></a>00595     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00596"></a>00596   });
<a name="l00597"></a>00597 
<a name="l00598"></a>00598   $(<span class="stringliteral">&#39;{$_searchForm} form&#39;</span>).submit(function(){
<a name="l00599"></a>00599     $.fn.yiiGridView.update(<span class="stringliteral">&#39;{$_targetFormId}&#39;</span>, {
<a name="l00600"></a>00600       data: $(<span class="keyword">this</span>).serialize()
<a name="l00601"></a>00601     });
<a name="l00602"></a>00602     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00603"></a>00603   });
<a name="l00604"></a>00604 });
<a name="l00605"></a>00605 JS;
<a name="l00606"></a>00606       $options[<span class="stringliteral">&#39;__searchScript&#39;</span>] = $_searchScript;
<a name="l00607"></a>00607     }
<a name="l00608"></a>00608 
<a name="l00609"></a>00609     <span class="comment">//  Return reconstructed options for standard form use</span>
<a name="l00610"></a>00610     <span class="keywordflow">return</span> $options;
<a name="l00611"></a>00611   }
<a name="l00612"></a>00612 
<a name="l00613"></a>00613   <span class="comment">//********************************************************************************</span>
<a name="l00614"></a>00614   <span class="comment">//* Property Accessors</span>
<a name="l00615"></a>00615   <span class="comment">//********************************************************************************</span>
<a name="l00616"></a>00616 
<a name="l00632"></a><a class="code" href="group__propaccs__cxlcontroller.html#gacea2c7c705d91ba736a41e67314e5ae3">00632</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#gacea2c7c705d91ba736a41e67314e5ae3" title="Convenience access to isPostRequest.">getIsPostRequest</a>()
<a name="l00633"></a>00633   {
<a name="l00634"></a>00634     <span class="keywordflow">return</span> <a class="code" href="classYiiXLBase.html#a58562fcc2fc0a157f361c6eae58b641c">XL::isPostRequest</a>();
<a name="l00635"></a>00635   }
<a name="l00636"></a>00636 
<a name="l00641"></a><a class="code" href="group__propaccs__cxlcontroller.html#gaed1df55c262bb0238ae6ef0921a2552b">00641</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#gaed1df55c262bb0238ae6ef0921a2552b" title="Convenience access to isAjaxRequest.">getIsAjaxRequest</a>()
<a name="l00642"></a>00642   {
<a name="l00643"></a>00643     <span class="keywordflow">return</span> <a class="code" href="classYiiXLBase.html#ad29992b5c09cbad51dc5978f09903b28">XL::isAjaxRequest</a>();
<a name="l00644"></a>00644   }
<a name="l00645"></a>00645 
<a name="l00650"></a><a class="code" href="group__propaccs__cxlcontroller.html#gae32b7248cefed2da5b054c1a4ab674b1">00650</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#gae32b7248cefed2da5b054c1a4ab674b1" title="Returns the base url of the current app.">getAppBaseUrl</a>()
<a name="l00651"></a>00651   {
<a name="l00652"></a>00652     <span class="keywordflow">return</span> <a class="code" href="classYiiXLBase.html#a7c4e9be274589248e2464de14fad190e">XL::_gbu</a>();
<a name="l00653"></a>00653   }
<a name="l00654"></a>00654 
<a name="l00658"></a><a class="code" href="group__propaccs__cxlcontroller.html#ga637e84e2e9e99a87ea9b5f1771551af4">00658</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#ga637e84e2e9e99a87ea9b5f1771551af4">getMenu</a>()
<a name="l00659"></a>00659   {
<a name="l00660"></a>00660     <span class="keywordflow">return</span> $this-&gt;_menu;
<a name="l00661"></a>00661   }
<a name="l00662"></a>00662 
<a name="l00667"></a><a class="code" href="group__propaccs__cxlcontroller.html#ga5cf6c2464263681fdc1186bb94ee9ad8">00667</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#ga5cf6c2464263681fdc1186bb94ee9ad8">setMenu</a>( $value )
<a name="l00668"></a>00668   {
<a name="l00669"></a>00669     $this-&gt;_menu = $value;
<a name="l00670"></a>00670     <span class="keywordflow">return</span> $this;
<a name="l00671"></a>00671   }
<a name="l00672"></a>00672 
<a name="l00676"></a><a class="code" href="group__propaccs__cxlcontroller.html#gab53bf1b4b27392839a16ecf3ad62e88b">00676</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#gab53bf1b4b27392839a16ecf3ad62e88b">getBreadcrumbs</a>()
<a name="l00677"></a>00677   {
<a name="l00678"></a>00678     <span class="keywordflow">return</span> $this-&gt;_breadcrumbs;
<a name="l00679"></a>00679   }
<a name="l00680"></a>00680 
<a name="l00685"></a><a class="code" href="group__propaccs__cxlcontroller.html#ga9f9822dfb5d491a6e0b9c836d6ce4e3f">00685</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#ga9f9822dfb5d491a6e0b9c836d6ce4e3f">setBreadcrumbs</a>( $value )
<a name="l00686"></a>00686   {
<a name="l00687"></a>00687     $this-&gt;_breadcrumbs = $value;
<a name="l00688"></a>00688     <span class="keywordflow">return</span> $this;
<a name="l00689"></a>00689   }
<a name="l00690"></a>00690 
<a name="l00694"></a><a class="code" href="group__propaccs__cxlcontroller.html#gaf6a608839df34306457a0f877695bce0">00694</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#gaf6a608839df34306457a0f877695bce0">getPageHeading</a>()
<a name="l00695"></a>00695   {
<a name="l00696"></a>00696     <span class="keywordflow">return</span> $this-&gt;m_sPageHeading;
<a name="l00697"></a>00697   }
<a name="l00698"></a>00698 
<a name="l00703"></a><a class="code" href="group__propaccs__cxlcontroller.html#gaee7c1dbb383543b39ff09bf25dc6adf0">00703</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#gaee7c1dbb383543b39ff09bf25dc6adf0">setPageHeading</a>( $value )
<a name="l00704"></a>00704   {
<a name="l00705"></a>00705     $this-&gt;m_sPageHeading = $value;
<a name="l00706"></a>00706     <span class="keywordflow">return</span> $this;
<a name="l00707"></a>00707   }
<a name="l00708"></a>00708 
<a name="l00712"></a><a class="code" href="group__propaccs__cxlcontroller.html#gaf06d6acbc7631d7109d3281191b33bc9">00712</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#gaf06d6acbc7631d7109d3281191b33bc9">getActionMethodPrefix</a>()
<a name="l00713"></a>00713   {
<a name="l00714"></a>00714     <span class="keywordflow">return</span> $this-&gt;_actionMethodPrefix;
<a name="l00715"></a>00715   }
<a name="l00716"></a>00716 
<a name="l00721"></a><a class="code" href="group__propaccs__cxlcontroller.html#gacfc34f281282bbec29fe66ca52419651">00721</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#gacfc34f281282bbec29fe66ca52419651">setActionMethodPrefix</a>( $value )
<a name="l00722"></a>00722   {
<a name="l00723"></a>00723     $this-&gt;_actionMethodPrefix = $value;
<a name="l00724"></a>00724     <span class="keywordflow">return</span> $this;
<a name="l00725"></a>00725   }
<a name="l00726"></a>00726 
<a name="l00730"></a><a class="code" href="group__propaccs__cxlcontroller.html#ga71e9b2625e1f13a65ea101b53d2f264d">00730</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#ga71e9b2625e1f13a65ea101b53d2f264d">getCurrentModel</a>()
<a name="l00731"></a>00731   {
<a name="l00732"></a>00732     <span class="keywordflow">return</span> $this-&gt;_currentModel;
<a name="l00733"></a>00733   }
<a name="l00734"></a>00734 
<a name="l00739"></a><a class="code" href="group__propaccs__cxlcontroller.html#ga1da4e93942345da876819fb6b8614a26">00739</a>   <span class="keyword">protected</span> function <a class="code" href="group__propaccs__cxlcontroller.html#ga1da4e93942345da876819fb6b8614a26">setCurrentModel</a>( $value )
<a name="l00740"></a>00740   {
<a name="l00741"></a>00741     $this-&gt;_currentModel = $value;
<a name="l00742"></a>00742     <span class="keywordflow">return</span> $this;
<a name="l00743"></a>00743   }
<a name="l00744"></a>00744 
<a name="l00748"></a><a class="code" href="group__propaccs__cxlcontroller.html#gaef6109e8c58719533639e6526717fb1b">00748</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#gaef6109e8c58719533639e6526717fb1b">getModelClass</a>()
<a name="l00749"></a>00749   {
<a name="l00750"></a>00750     <span class="keywordflow">return</span> $this-&gt;_modelClass;
<a name="l00751"></a>00751   }
<a name="l00752"></a>00752 
<a name="l00757"></a><a class="code" href="group__propaccs__cxlcontroller.html#ga24e8b6f39d6a823d94317e35f1b94758">00757</a>   <span class="keyword">protected</span> function <a class="code" href="group__propaccs__cxlcontroller.html#ga24e8b6f39d6a823d94317e35f1b94758">setModelClass</a>( $value )
<a name="l00758"></a>00758   {
<a name="l00759"></a>00759     $this-&gt;_modelClass = $value;
<a name="l00760"></a>00760     <span class="keywordflow">return</span> $this;
<a name="l00761"></a>00761   }
<a name="l00762"></a>00762 
<a name="l00766"></a><a class="code" href="group__propaccs__cxlcontroller.html#ga68388edace82b8984b694c1d4e6beb82">00766</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#ga68388edace82b8984b694c1d4e6beb82">getContentTemplate</a>()
<a name="l00767"></a>00767   {
<a name="l00768"></a>00768     <span class="keywordflow">return</span> $this-&gt;_contentTemplate;
<a name="l00769"></a>00769   }
<a name="l00770"></a>00770 
<a name="l00775"></a><a class="code" href="group__propaccs__cxlcontroller.html#ga5166a144947cae70bcb6ad5b508cefcc">00775</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#ga5166a144947cae70bcb6ad5b508cefcc">setContentTemplate</a>( $value )
<a name="l00776"></a>00776   {
<a name="l00777"></a>00777     $this-&gt;_contentTemplate = $value;
<a name="l00778"></a>00778     <span class="keywordflow">return</span> $this;
<a name="l00779"></a>00779   }
<a name="l00780"></a>00780 
<a name="l00784"></a><a class="code" href="group__propaccs__cxlcontroller.html#ga9a7643aeb71f6ca0cdfd394f9bd7deda">00784</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#ga9a7643aeb71f6ca0cdfd394f9bd7deda">getAutoFindLayout</a>()
<a name="l00785"></a>00785   {
<a name="l00786"></a>00786     <span class="keywordflow">return</span> $this-&gt;_autoFindLayout;
<a name="l00787"></a>00787   }
<a name="l00788"></a>00788 
<a name="l00793"></a><a class="code" href="group__propaccs__cxlcontroller.html#ga39204785aa23a9a43f8a6e1bb3998efb">00793</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#ga39204785aa23a9a43f8a6e1bb3998efb">setAutoFindLayout</a>( $value )
<a name="l00794"></a>00794   {
<a name="l00795"></a>00795     $this-&gt;_autoFindLayout = $value;
<a name="l00796"></a>00796     <span class="keywordflow">return</span> $this;
<a name="l00797"></a>00797   }
<a name="l00798"></a>00798 
<a name="l00802"></a><a class="code" href="group__propaccs__cxlcontroller.html#gaee02b55545c3a77d1bf4b3480856e774">00802</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#gaee02b55545c3a77d1bf4b3480856e774">getAutoFindAction</a>()
<a name="l00803"></a>00803   {
<a name="l00804"></a>00804     <span class="keywordflow">return</span> $this-&gt;_autoFindAction;
<a name="l00805"></a>00805   }
<a name="l00806"></a>00806 
<a name="l00811"></a><a class="code" href="group__propaccs__cxlcontroller.html#ga8f4e999ffe16e8a84221c6e0de6f7bd9">00811</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#ga8f4e999ffe16e8a84221c6e0de6f7bd9">setAutoFindAction</a>( $value )
<a name="l00812"></a>00812   {
<a name="l00813"></a>00813     $this-&gt;_autoFindAction = $value;
<a name="l00814"></a>00814     <span class="keywordflow">return</span> $this;
<a name="l00815"></a>00815   }
<a name="l00816"></a>00816 
<a name="l00820"></a><a class="code" href="group__propaccs__cxlcontroller.html#gaa02a564e1ffff40fd78f509309154d95">00820</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#gaa02a564e1ffff40fd78f509309154d95">getAdminCommandMap</a>()
<a name="l00821"></a>00821   {
<a name="l00822"></a>00822     <span class="keywordflow">return</span> $this-&gt;_adminCommandMap;
<a name="l00823"></a>00823   }
<a name="l00824"></a>00824 
<a name="l00829"></a><a class="code" href="group__propaccs__cxlcontroller.html#ga23588c95ee01933abc6e0590c1aa1138">00829</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#ga23588c95ee01933abc6e0590c1aa1138">setAdminCommandMap</a>( $value )
<a name="l00830"></a>00830   {
<a name="l00831"></a>00831     $this-&gt;_adminCommandMap = $value;
<a name="l00832"></a>00832     <span class="keywordflow">return</span> $this;
<a name="l00833"></a>00833   }
<a name="l00834"></a>00834 
<a name="l00841"></a><a class="code" href="group__propaccs__cxlcontroller.html#gad7fa598cf33ccbba931578de18f074bf">00841</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#gad7fa598cf33ccbba931578de18f074bf">addCommandToMap</a>( $key, $value = null, $property = null )
<a name="l00842"></a>00842   {
<a name="l00843"></a>00843     $this-&gt;_adminCommandMap[$key] = $value;
<a name="l00844"></a>00844 
<a name="l00845"></a>00845     <span class="keywordflow">if</span> ( $property )
<a name="l00846"></a>00846       $this-&gt;addActionControls( $property, array( $key ) );
<a name="l00847"></a>00847 
<a name="l00848"></a>00848     <span class="keywordflow">return</span> $this;
<a name="l00849"></a>00849   }
<a name="l00850"></a>00850 
<a name="l00854"></a><a class="code" href="group__propaccs__cxlcontroller.html#gae3e26353e430eb74e086211a9bfcb957">00854</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#gae3e26353e430eb74e086211a9bfcb957">getPortletActions</a>()
<a name="l00855"></a>00855   {
<a name="l00856"></a>00856     <span class="keywordflow">return</span> $this-&gt;_portletActions;
<a name="l00857"></a>00857   }
<a name="l00858"></a>00858 
<a name="l00863"></a><a class="code" href="group__propaccs__cxlcontroller.html#ga62630bbea4f9a6d711684891ad307fda">00863</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#ga62630bbea4f9a6d711684891ad307fda">setPortletActions</a>( $value )
<a name="l00864"></a>00864   {
<a name="l00865"></a>00865     $this-&gt;_portletActions = $value;
<a name="l00866"></a>00866     <span class="keywordflow">return</span> $this;
<a name="l00867"></a>00867   }
<a name="l00868"></a>00868 
<a name="l00874"></a><a class="code" href="group__propaccs__cxlcontroller.html#ga1103c34c21ad3fac33acc05c977edd46">00874</a>   <span class="keyword">public</span> function <a class="code" href="group__propaccs__cxlcontroller.html#ga1103c34c21ad3fac33acc05c977edd46">addPortletAction</a>( $sName, $arCallback )
<a name="l00875"></a>00875   {
<a name="l00876"></a>00876     $this-&gt;_portletActions[$sName] = $arCallback;
<a name="l00877"></a>00877     <span class="keywordflow">return</span> $this;
<a name="l00878"></a>00878   }
<a name="l00879"></a>00879 
<a name="l00883"></a><a class="code" href="group__propaccs__cxlcontroller.html#ga09cb66dd061fa338ab2a85a31f5ccf00">00883</a>   <span class="keyword">protected</span> function <a class="code" href="group__propaccs__cxlcontroller.html#ga09cb66dd061fa338ab2a85a31f5ccf00">getViewData</a>()
<a name="l00884"></a>00884   {
<a name="l00885"></a>00885     <span class="keywordflow">return</span> $this-&gt;_viewData;
<a name="l00886"></a>00886   }
<a name="l00887"></a>00887 
<a name="l00892"></a><a class="code" href="group__propaccs__cxlcontroller.html#gade714d0b090e663e7acd6ef596d602ec">00892</a>   <span class="keyword">protected</span> function <a class="code" href="group__propaccs__cxlcontroller.html#gade714d0b090e663e7acd6ef596d602ec">setViewData</a>( $value )
<a name="l00893"></a>00893   {
<a name="l00894"></a>00894     $this-&gt;_viewData = $value;
<a name="l00895"></a>00895     <span class="keywordflow">return</span> $this;
<a name="l00896"></a>00896   }
<a name="l00897"></a>00897 
<a name="l00901"></a><a class="code" href="group__propaccs__cxlcontroller.html#ga095ad5a2da0a46cf0c5225c826b7fe4c">00901</a>   <span class="keyword">protected</span> function <a class="code" href="group__propaccs__cxlcontroller.html#ga095ad5a2da0a46cf0c5225c826b7fe4c">getExtraViewDataList</a>()
<a name="l00902"></a>00902   {
<a name="l00903"></a>00903     <span class="keywordflow">return</span> $this-&gt;_extraViewDataList;
<a name="l00904"></a>00904   }
<a name="l00905"></a>00905 
<a name="l00910"></a><a class="code" href="group__propaccs__cxlcontroller.html#ga537201d018053eaff662e290be1a8a81">00910</a>   <span class="keyword">protected</span> function <a class="code" href="group__propaccs__cxlcontroller.html#ga537201d018053eaff662e290be1a8a81">setExtraViewDataList</a>( $value )
<a name="l00911"></a>00911   {
<a name="l00912"></a>00912     $this-&gt;_extraViewDataList = $value;
<a name="l00913"></a>00913     <span class="keywordflow">return</span> $this;
<a name="l00914"></a>00914   }
<a name="l00915"></a>00915 
<a name="l00919"></a><a class="code" href="group__propaccs__cxlcontroller.html#ga1f4c82d1446cb4a49f0da9bc76e5aa1e">00919</a>   <span class="keyword">protected</span> function <a class="code" href="group__propaccs__cxlcontroller.html#ga1f4c82d1446cb4a49f0da9bc76e5aa1e">getExtraViewDataPrefix</a>()
<a name="l00920"></a>00920   {
<a name="l00921"></a>00921     <span class="keywordflow">return</span> $this-&gt;_extraViewDataPrefix;
<a name="l00922"></a>00922   }
<a name="l00923"></a>00923 
<a name="l00928"></a><a class="code" href="group__propaccs__cxlcontroller.html#gae80dd653d6c5d9e7be65cd7ae3f05627">00928</a>   <span class="keyword">protected</span> function <a class="code" href="group__propaccs__cxlcontroller.html#gae80dd653d6c5d9e7be65cd7ae3f05627">setExtraViewDataPrefix</a>( $value )
<a name="l00929"></a>00929   {
<a name="l00930"></a>00930     $this-&gt;_extraViewDataPrefix = $value;
<a name="l00931"></a>00931     <span class="keywordflow">return</span> $this;
<a name="l00932"></a>00932   }
<a name="l00933"></a>00933 
<a name="l00939"></a>00939   <span class="comment">//********************************************************************************</span>
<a name="l00940"></a>00940   <span class="comment">//* Private Methods</span>
<a name="l00941"></a>00941   <span class="comment">//********************************************************************************</span>
<a name="l00942"></a>00942 
<a name="l00949"></a><a class="code" href="classCXLController.html#aa4220b2012e6ab707b3d553c4a9e2fae">00949</a>   <span class="keyword">protected</span> function <a class="code" href="classCXLController.html#aa4220b2012e6ab707b3d553c4a9e2fae" title="Executes any commands Maps to CXLController::commandMap and calls the appropriate method...">_processCommand</a>( $arData = array( ), $sIndexName = self::COMMAND_FIELD_NAME )
<a name="l00950"></a>00950   {
<a name="l00951"></a>00951     <span class="comment">//  Our return variable</span>
<a name="l00952"></a>00952     $_oResults = null;
<a name="l00953"></a>00953 
<a name="l00954"></a>00954     <span class="comment">//  Get command&#39;s method...</span>
<a name="l00955"></a>00955     $_sCmd = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $_REQUEST, $sIndexName );
<a name="l00956"></a>00956 
<a name="l00957"></a>00957     <span class="comment">//  Do we have a command mapping?</span>
<a name="l00958"></a>00958     <span class="keywordflow">if</span> ( null !== ( $_arCmd = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $this-&gt;_adminCommandMap, $_sCmd ) ) )
<a name="l00959"></a>00959     {
<a name="l00960"></a>00960       <span class="comment">//  Get any miscellaneous data into the appropriate array</span>
<a name="l00961"></a>00961       <span class="keywordflow">if</span> ( count( $arData ) )
<a name="l00962"></a>00962       {
<a name="l00963"></a>00963         <span class="keywordflow">if</span> ( $this-&gt;<a class="code" href="group__propaccs__cxlcontroller.html#gacea2c7c705d91ba736a41e67314e5ae3" title="Convenience access to isPostRequest.">getIsPostRequest</a>() ) $_POST = array_merge( $_POST, $arData );
<a name="l00964"></a>00964         <span class="keywordflow">else</span> $_GET = array_merge( $_GET, $arData );
<a name="l00965"></a>00965       }
<a name="l00966"></a>00966 
<a name="l00967"></a>00967       $_oResults = call_user_func( $_arCmd[1] );
<a name="l00968"></a>00968     }
<a name="l00969"></a>00969 
<a name="l00970"></a>00970     <span class="comment">//  Return the results</span>
<a name="l00971"></a>00971     <span class="keywordflow">return</span> $_oResults;
<a name="l00972"></a>00972   }
<a name="l00973"></a>00973 
<a name="l00986"></a><a class="code" href="classCXLController.html#a07752b4247d9de652d5660545e5465e8">00986</a>   <span class="keyword">protected</span> function <a class="code" href="classCXLController.html#a07752b4247d9de652d5660545e5465e8" title="Saves the data in the model.">_saveCurrentModel</a>( &amp;$model, $arData = array( ), $sRedirectAction = <span class="stringliteral">&#39;show&#39;</span>, $bAttributesSet = <span class="keyword">false</span>, $sModelName = null, $sSuccessMessage = null, $bNoCommit = <span class="keyword">false</span>,
<a name="l00987"></a>00987                     $bSafeOnly = <span class="keyword">false</span> )
<a name="l00988"></a>00988   {
<a name="l00989"></a>00989     $_sMessage = <a class="code" href="classYiiXLBase.html#a666bf0c7e9a3320e2e1ca2d9b65301e6" title="NVL = Null VaLue.">XL::nvl</a>( $sSuccessMessage, <span class="stringliteral">&#39;Your changes have been saved.&#39;</span> );
<a name="l00990"></a>00990     $_sModelName = <a class="code" href="classYiiXLBase.html#a666bf0c7e9a3320e2e1ca2d9b65301e6" title="NVL = Null VaLue.">XL::nvl</a>( $sModelName, <a class="code" href="classYiiXLBase.html#a666bf0c7e9a3320e2e1ca2d9b65301e6" title="NVL = Null VaLue.">XL::nvl</a>( $model-&gt;getModelClass(), $this-&gt;_modelClass ) );
<a name="l00991"></a>00991 
<a name="l00992"></a>00992     <span class="keywordflow">if</span> ( isset( $arData, $arData[$_sModelName] ) )
<a name="l00993"></a>00993     {
<a name="l00994"></a>00994       <span class="keywordflow">if</span> ( !$bAttributesSet ) $model-&gt;setAttributes( $arData[$_sModelName], $bSafeOnly );
<a name="l00995"></a>00995 
<a name="l00996"></a>00996       <span class="keywordflow">if</span> ( $model-&gt;save() )
<a name="l00997"></a>00997       {
<a name="l00998"></a>00998         <span class="keywordflow">if</span> ( !$bNoCommit &amp;&amp; $model instanceof CPSModel &amp;&amp; $model-&gt;hasTransaction() ) $model-&gt;commitTransaction();
<a name="l00999"></a>00999 
<a name="l01000"></a>01000         Yii::app()-&gt;user-&gt;setFlash( <span class="stringliteral">&#39;success&#39;</span>, $_sMessage );
<a name="l01001"></a>01001 
<a name="l01002"></a>01002         <span class="keywordflow">if</span> ( $sRedirectAction ) $this-&gt;redirect( array( $sRedirectAction, <span class="stringliteral">&#39;id&#39;</span> =&gt; $model-&gt;id ) );
<a name="l01003"></a>01003 
<a name="l01004"></a>01004         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01005"></a>01005       }
<a name="l01006"></a>01006     }
<a name="l01007"></a>01007 
<a name="l01008"></a>01008     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01009"></a>01009   }
<a name="l01010"></a>01010 
<a name="l01011"></a>01011   <span class="comment">/*   * *</span>
<a name="l01012"></a>01012 <span class="comment">   * Just like saveModel, but doesn&#39;t commit, and never redirects.</span>
<a name="l01013"></a>01013 <span class="comment">   *</span>
<a name="l01014"></a>01014 <span class="comment">   * @param CPSModel $model</span>
<a name="l01015"></a>01015 <span class="comment">   * @param array $arData</span>
<a name="l01016"></a>01016 <span class="comment">   * @param boolean $bAttributesSet</span>
<a name="l01017"></a>01017 <span class="comment">   * @param string $sSuccessMessage</span>
<a name="l01018"></a>01018 <span class="comment">   * @return boolean</span>
<a name="l01019"></a>01019 <span class="comment">   * @see saveModel</span>
<a name="l01020"></a>01020 <span class="comment">   */</span>
<a name="l01021"></a>01021 
<a name="l01022"></a><a class="code" href="classCXLController.html#a4a6ed28d4c46fd7066ce1d371c05c785">01022</a>   <span class="keyword">protected</span> function <a class="code" href="classCXLController.html#a4a6ed28d4c46fd7066ce1d371c05c785">_saveTransactionCurrentModel</a>( &amp;$model, $arData = array( ), $bAttributesSet = <span class="keyword">false</span>, $sSuccessMessage = null )
<a name="l01023"></a>01023   {
<a name="l01024"></a>01024     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classCXLController.html#a07752b4247d9de652d5660545e5465e8" title="Saves the data in the model.">_saveCurrentModel</a>( $model, $arData, <span class="keyword">false</span>, $bAttributesSet, null, $sSuccessMessage, <span class="keyword">true</span> );
<a name="l01025"></a>01025   }
<a name="l01026"></a>01026 
<a name="l01033"></a><a class="code" href="classCXLController.html#a89270214365dbe72ef87e3119a6350bc">01033</a>   <span class="keyword">protected</span> function <a class="code" href="classCXLController.html#a89270214365dbe72ef87e3119a6350bc" title="Loads a page of models.">_loadPaged</a>( $bSort = <span class="keyword">false</span>, $oCriteria = null )
<a name="l01034"></a>01034   {
<a name="l01035"></a>01035     $_oSort = $_oCrit = $_oPage = null;
<a name="l01036"></a>01036 
<a name="l01037"></a>01037     <span class="comment">//  Make criteria</span>
<a name="l01038"></a>01038     $_oCrit = <a class="code" href="classYiiXLBase.html#a666bf0c7e9a3320e2e1ca2d9b65301e6" title="NVL = Null VaLue.">XL::nvl</a>( $oCriteria, <span class="keyword">new</span> CDbCriteria() );
<a name="l01039"></a>01039     $_oPage = <span class="keyword">new</span> CPagination( $this-&gt;<a class="code" href="classCXLController.html#a34707322443b65c1040b774113b10df8" title="Returns the count of rows that match the supplied criteria.">_loadCount</a>( $_oCrit ) );
<a name="l01040"></a>01040     $_oPage-&gt;pageSize = <a class="code" href="classYiiXLBase.html#abba281d4c1813d0fb984cbca6784930a" title="Retrieves an option from the given array.">XL::o</a>( $_REQUEST, <span class="stringliteral">&#39;perPage&#39;</span>, self::PAGE_SIZE );
<a name="l01041"></a>01041     <span class="keywordflow">if</span> ( isset( $_REQUEST, $_REQUEST[<span class="stringliteral">&#39;page&#39;</span>] ) ) $_oPage-&gt;setCurrentPage( intval( $_REQUEST[<span class="stringliteral">&#39;page&#39;</span>] ) - 1 );
<a name="l01042"></a>01042     $_oPage-&gt;applyLimit( $_oCrit );
<a name="l01043"></a>01043 
<a name="l01044"></a>01044     <span class="comment">//  Sort...</span>
<a name="l01045"></a>01045     <span class="keywordflow">if</span> ( $bSort )
<a name="l01046"></a>01046     {
<a name="l01047"></a>01047       $_oSort = <span class="keyword">new</span> CPSSort( $this-&gt;_modelClass );
<a name="l01048"></a>01048       $_oSort-&gt;applyOrder( $_oCrit );
<a name="l01049"></a>01049     }
<a name="l01050"></a>01050 
<a name="l01051"></a>01051     <span class="comment">//  Return an array of what we&#39;ve build...</span>
<a name="l01052"></a>01052     <span class="keywordflow">return</span> array( $this-&gt;<a class="code" href="classCXLController.html#a0e1591f560697e8a93005a0489cafc13" title="Loads all data using supplied criteria.">_loadAll</a>( $_oCrit ), $_oCrit, $_oPage, $_oSort );
<a name="l01053"></a>01053   }
<a name="l01054"></a>01054 
<a name="l01064"></a><a class="code" href="classCXLController.html#aa4366f95a403727195880be2634228bb">01064</a>   <span class="keyword">protected</span> function <a class="code" href="classCXLController.html#aa4366f95a403727195880be2634228bb" title="Loads a model(s) based on criteria and scopes.">_genericModelLoad</a>( $sMethod, &amp;$oCrit = null, $arScope = array( ), $arOptions = array( ) )
<a name="l01065"></a>01065   {
<a name="l01066"></a>01066     $_sMethod = $this-&gt;<a class="code" href="classCXLController.html#a34b95849087b6c8b67b8f2be164ff920" title="Builds a string suitable for eval.">_getModelLoadString</a>( $arScope, $arOptions ) . $sMethod;
<a name="l01067"></a>01067     <span class="keywordflow">return</span> eval( <span class="stringliteral">&quot;return (&quot;</span> . $_sMethod . <span class="stringliteral">&quot;);&quot;</span> );
<a name="l01068"></a>01068   }
<a name="l01069"></a>01069 
<a name="l01076"></a><a class="code" href="classCXLController.html#a60bcb5a5a2a82bb81a4ae4b07ef4d3bb">01076</a>   <span class="keyword">protected</span> function <a class="code" href="classCXLController.html#a60bcb5a5a2a82bb81a4ae4b07ef4d3bb">_load</a>( $id = null )
<a name="l01077"></a>01077   {
<a name="l01078"></a>01078     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classCXLController.html#aa4366f95a403727195880be2634228bb" title="Loads a model(s) based on criteria and scopes.">_genericModelLoad</a>( <span class="stringliteral">&#39;findByPk(&#39;</span> . $id . <span class="charliteral">&#39;)&#39;</span> );
<a name="l01079"></a>01079   }
<a name="l01080"></a>01080 
<a name="l01087"></a><a class="code" href="classCXLController.html#a0e1591f560697e8a93005a0489cafc13">01087</a>   <span class="keyword">protected</span> function <a class="code" href="classCXLController.html#a0e1591f560697e8a93005a0489cafc13" title="Loads all data using supplied criteria.">_loadAll</a>( &amp;$oCrit = null )
<a name="l01088"></a>01088   {
<a name="l01089"></a>01089     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classCXLController.html#aa4366f95a403727195880be2634228bb" title="Loads a model(s) based on criteria and scopes.">_genericModelLoad</a>( <span class="stringliteral">&#39;findAll(&#39;</span> . ( null !== $oCrit ? <span class="stringliteral">&#39;$oCrit&#39;</span> : <span class="stringliteral">&#39;&#39;</span> ) . <span class="charliteral">&#39;)&#39;</span>, $oCrit );
<a name="l01090"></a>01090   }
<a name="l01091"></a>01091 
<a name="l01098"></a><a class="code" href="classCXLController.html#a34707322443b65c1040b774113b10df8">01098</a>   <span class="keyword">protected</span> function <a class="code" href="classCXLController.html#a34707322443b65c1040b774113b10df8" title="Returns the count of rows that match the supplied criteria.">_loadCount</a>( &amp;$oCrit = null )
<a name="l01099"></a>01099   {
<a name="l01100"></a>01100     $_sCrit = ( $oCrit ) ? <span class="stringliteral">&#39;$oCrit&#39;</span> : null;
<a name="l01101"></a>01101     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classCXLController.html#aa4366f95a403727195880be2634228bb" title="Loads a model(s) based on criteria and scopes.">_genericModelLoad</a>( <span class="stringliteral">&#39;count(&#39;</span> . $_sCrit . <span class="charliteral">&#39;)&#39;</span>, $oCrit );
<a name="l01102"></a>01102   }
<a name="l01103"></a>01103 
<a name="l01111"></a><a class="code" href="classCXLController.html#a34b95849087b6c8b67b8f2be164ff920">01111</a>   <span class="keyword">protected</span> function <a class="code" href="classCXLController.html#a34b95849087b6c8b67b8f2be164ff920" title="Builds a string suitable for eval.">_getModelLoadString</a>( $arScope = array( ), $arOptions = array( ) )
<a name="l01112"></a>01112   {
<a name="l01113"></a>01113     $_sScopes = ( count( $arScope ) ) ? implode( <span class="stringliteral">&#39;-&gt;&#39;</span>, $arScope ) . <span class="stringliteral">&#39;-&gt;&#39;</span> : null;
<a name="l01114"></a>01114     <span class="keywordflow">return</span> $this-&gt;_modelClass . <span class="stringliteral">&#39;::model()-&gt;&#39;</span> . $_sScopes;
<a name="l01115"></a>01115   }
<a name="l01116"></a>01116 
<a name="l01122"></a><a class="code" href="classCXLController.html#a5251a4266510d11bebb4b7dfd5329328">01122</a>   <span class="keyword">protected</span> function <a class="code" href="classCXLController.html#a5251a4266510d11bebb4b7dfd5329328" title="Pushes an action onto the action queue.">_pushAction</a>( $action )
<a name="l01123"></a>01123   {
<a name="l01124"></a>01124     array_push( $this-&gt;_actionStack, $action );
<a name="l01125"></a>01125   }
<a name="l01126"></a>01126 
<a name="l01131"></a><a class="code" href="classCXLController.html#a53c19492c9d2a689d8eb050e55533c3f">01131</a>   <span class="keyword">protected</span> function <a class="code" href="classCXLController.html#a53c19492c9d2a689d8eb050e55533c3f" title="Retrieves the latest pushed action.">_popAction</a>()
<a name="l01132"></a>01132   {
<a name="l01133"></a>01133     <span class="keywordflow">return</span> array_pop( $this-&gt;_actionStack );
<a name="l01134"></a>01134   }
<a name="l01135"></a>01135 
<a name="l01142"></a><a class="code" href="classCXLController.html#aa4b08e9b479f58c7240676ee0ed77dd1">01142</a>   <span class="keyword">protected</span> function <a class="code" href="classCXLController.html#aa4b08e9b479f58c7240676ee0ed77dd1" title="Pushes a variable onto the view data stack.">_addViewData</a>( $variableName, $variableData = null )
<a name="l01143"></a>01143   {
<a name="l01144"></a>01144     $this-&gt;_viewData[$variableName] = $variableData;
<a name="l01145"></a>01145   }
<a name="l01146"></a>01146 
<a name="l01151"></a><a class="code" href="classCXLController.html#ac85fd84473628025c302d593abc32013">01151</a>   <span class="keyword">protected</span> function <a class="code" href="classCXLController.html#ac85fd84473628025c302d593abc32013" title="Clears the current search criteria.">_clearSearchCriteria</a>()
<a name="l01152"></a>01152   {
<a name="l01153"></a>01153     $this-&gt;m_arCurrentSearchCriteria = null;
<a name="l01154"></a>01154     Yii::app()-&gt;user-&gt;clearState( $this-&gt;m_sSearchStateId );
<a name="l01155"></a>01155 
<a name="l01156"></a>01156     <span class="keywordflow">return</span> null;
<a name="l01157"></a>01157   }
<a name="l01158"></a>01158 
<a name="l01165"></a><a class="code" href="classCXLController.html#a7063f698c3d296c849e56a97a007b280">01165</a>   <span class="keyword">protected</span> function <a class="code" href="classCXLController.html#a7063f698c3d296c849e56a97a007b280" title="Turns off the layout, echos the JSON encoded version of data and returns.">_ajaxReturn</a>( $payload = <span class="keyword">false</span>, $encode = <span class="keyword">false</span>, $encodeOptions = ENT_NOQUOTES )
<a name="l01166"></a>01166   {
<a name="l01167"></a>01167     $this-&gt;layout = <span class="keyword">false</span>;
<a name="l01168"></a>01168 
<a name="l01169"></a>01169     <span class="keywordflow">if</span> ( <span class="keyword">false</span> === $payload || <span class="keyword">true</span> === $payload ) $payload = ( $payload ? <span class="charliteral">&#39;1&#39;</span> : <span class="charliteral">&#39;0&#39;</span> );
<a name="l01170"></a>01170 
<a name="l01171"></a>01171     $_result = json_encode( $payload );
<a name="l01172"></a>01172     <span class="keywordflow">if</span> ( $encode ) $_result = htmlspecialchars( $_result, $encodeOptions );
<a name="l01173"></a>01173 
<a name="l01174"></a>01174     echo $_result;
<a name="l01175"></a>01175     <span class="keywordflow">return</span>;
<a name="l01176"></a>01176   }
<a name="l01177"></a>01177 
<a name="l01178"></a>01178 }
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Mar 25 2011 21:10:39 for YiiXL -- The Yii Extension Library Of Doom! by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
