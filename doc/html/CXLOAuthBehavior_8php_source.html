<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>YiiXL -- The Yii Extension Library Of Doom!: CXLOAuthBehavior.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="dir_1ec655711e29b55f31ff264c2bb65c33.html">usr</a>      </li>
      <li><a class="el" href="dir_6bb76cc6f95ff18987242ff417c6ce46.html">local</a>      </li>
      <li><a class="el" href="dir_c5bf51a4bce5f6288acec49aaf0c7f09.html">yiixl</a>      </li>
      <li><a class="el" href="dir_61700af67871dcbdf05fae1643014cc7.html">lib</a>      </li>
      <li><a class="el" href="dir_1fe0dc3b670ebeef3b7eceb42bf96cab.html">core</a>      </li>
      <li><a class="el" href="dir_7698770312b1c9dcc5505d70d6e88f90.html">behaviors</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>CXLOAuthBehavior.php</h1>  </div>
</div>
<div class="contents">
<a href="CXLOAuthBehavior_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00026"></a><a class="code" href="classCXLOAuthBehavior.html">00026</a> <span class="keyword">class </span><a class="code" href="classCXLOAuthBehavior.html">CXLOAuthBehavior</a> <span class="keyword">extends</span> <a class="code" href="classCXLBehavior.html" title="CXLBehavior The base class for all non-AR behaviors in the YiiXL system.">CXLBehavior</a>
<a name="l00027"></a>00027 {
<a name="l00028"></a>00028   <span class="comment">//********************************************************************************</span>
<a name="l00029"></a>00029   <span class="comment">//* Constants</span>
<a name="l00030"></a>00030   <span class="comment">//********************************************************************************</span>
<a name="l00031"></a>00031 
<a name="l00035"></a><a class="code" href="classCXLOAuthBehavior.html#aa607ab5e557e6ebb60b85c5a20ad067f">00035</a>   <span class="keyword">const</span> <a class="code" href="classCXLOAuthBehavior.html#aa607ab5e557e6ebb60b85c5a20ad067f" title="Our logging tag.">CLASS_LOG_TAG</a> = <span class="stringliteral">&#39;yxl.core.behaviors.CXLOAuthBehavior&#39;</span>;
<a name="l00036"></a>00036 
<a name="l00037"></a>00037   <span class="comment">//********************************************************************************</span>
<a name="l00038"></a>00038   <span class="comment">//* Properties</span>
<a name="l00039"></a>00039   <span class="comment">//********************************************************************************</span>
<a name="l00040"></a>00040 
<a name="l00045"></a><a class="code" href="classCXLOAuthBehavior.html#aea10c78c73d6333bc3bbc369b78da62e">00045</a>   <span class="keyword">protected</span> <a class="code" href="classCXLOAuthBehavior.html#aea10c78c73d6333bc3bbc369b78da62e">$_oauthToken</a> = null;
<a name="l00046"></a>00046 
<a name="l00051"></a><a class="code" href="classCXLOAuthBehavior.html#a3059e962acd36df1674d78ce69d3a733">00051</a>   <span class="keyword">protected</span> <a class="code" href="classCXLOAuthBehavior.html#a3059e962acd36df1674d78ce69d3a733">$_oauthObject</a> = null;
<a name="l00052"></a>00052   
<a name="l00057"></a><a class="code" href="classCXLOAuthBehavior.html#ade40e32a04ba6dd22db9f6204218b60b">00057</a>   <span class="keyword">protected</span> <a class="code" href="classCXLOAuthBehavior.html#ade40e32a04ba6dd22db9f6204218b60b">$_callbackUrl</a>;
<a name="l00062"></a><a class="code" href="classCXLOAuthBehavior.html#a1065be3580f4c6c6ecaeb45613525347">00062</a>   <span class="keyword">protected</span> <a class="code" href="classCXLOAuthBehavior.html#a1065be3580f4c6c6ecaeb45613525347">$_isAuthorized</a>;
<a name="l00067"></a><a class="code" href="classCXLOAuthBehavior.html#a9c9a16979cab986d2ebc611c942046bb">00067</a>   <span class="keyword">protected</span> <a class="code" href="classCXLOAuthBehavior.html#a9c9a16979cab986d2ebc611c942046bb">$_accessTokenUrl</a>;
<a name="l00072"></a><a class="code" href="classCXLOAuthBehavior.html#a394ba62f76b701f6ba696df4d7e025b1">00072</a>   <span class="keyword">protected</span> <a class="code" href="classCXLOAuthBehavior.html#a394ba62f76b701f6ba696df4d7e025b1">$_authorizeUrl</a>;
<a name="l00077"></a><a class="code" href="classCXLOAuthBehavior.html#a78f914fceb757ea6ceeefd223aa94245">00077</a>   <span class="keyword">protected</span> <a class="code" href="classCXLOAuthBehavior.html#a78f914fceb757ea6ceeefd223aa94245">$_requestTokenUrl</a>;
<a name="l00078"></a>00078   
<a name="l00079"></a>00079   <span class="comment">//********************************************************************************</span>
<a name="l00080"></a>00080   <span class="comment">//* Property Accessors</span>
<a name="l00081"></a>00081   <span class="comment">//********************************************************************************</span>
<a name="l00082"></a>00082 
<a name="l00087"></a><a class="code" href="classCXLOAuthBehavior.html#ab427c5f1592fd568bb84a7fef22bf980">00087</a>   <span class="keyword">public</span> function <a class="code" href="classCXLOAuthBehavior.html#ab427c5f1592fd568bb84a7fef22bf980" title="Retrieves the current OAuth token.">getOAuthToken</a>()
<a name="l00088"></a>00088   {
<a name="l00089"></a>00089     <span class="keywordflow">return</span> $this-&gt;_oauthToken;
<a name="l00090"></a>00090   }
<a name="l00091"></a>00091 
<a name="l00096"></a><a class="code" href="classCXLOAuthBehavior.html#a13fb41e10ef1a77aacb14d33ac1ce1be">00096</a>   <span class="keyword">public</span> function <a class="code" href="classCXLOAuthBehavior.html#a13fb41e10ef1a77aacb14d33ac1ce1be" title="Retrieves the OAuth object.">getOAuthObject</a>()
<a name="l00097"></a>00097   {
<a name="l00098"></a>00098     <span class="keywordflow">return</span> $this-&gt;_oauthObject;
<a name="l00099"></a>00099   }
<a name="l00100"></a>00100   
<a name="l00101"></a><a class="code" href="classCXLOAuthBehavior.html#a10b40817a4c75a202a41511d31629e6c">00101</a>   <span class="keyword">public</span> function <a class="code" href="classCXLOAuthBehavior.html#a10b40817a4c75a202a41511d31629e6c">getCallbackUrl</a>()  
<a name="l00102"></a>00102   {
<a name="l00103"></a>00103     <span class="keywordflow">return</span> $this-&gt;_callbackUrl;
<a name="l00104"></a>00104   }
<a name="l00105"></a>00105 
<a name="l00106"></a><a class="code" href="classCXLOAuthBehavior.html#a3a3fa8cd95b6783dcde3d34a7237022e">00106</a>   <span class="keyword">public</span> function <a class="code" href="classCXLOAuthBehavior.html#a3a3fa8cd95b6783dcde3d34a7237022e">setCallbackUrl</a>( $callbackUrl )
<a name="l00107"></a>00107   {
<a name="l00108"></a>00108     $this-&gt;_callbackUrl = $callbackUrl;
<a name="l00109"></a>00109     <span class="keywordflow">return</span> $this;
<a name="l00110"></a>00110   }
<a name="l00111"></a>00111 
<a name="l00112"></a><a class="code" href="classCXLOAuthBehavior.html#a9b29f2f3559502dcbd1c3c202eb5230e">00112</a>   <span class="keyword">public</span> function <a class="code" href="classCXLOAuthBehavior.html#a9b29f2f3559502dcbd1c3c202eb5230e">getIsAuthorized</a>()
<a name="l00113"></a>00113   {
<a name="l00114"></a>00114     <span class="keywordflow">return</span> $this-&gt;_isAuthorized;
<a name="l00115"></a>00115   }
<a name="l00116"></a>00116 
<a name="l00117"></a><a class="code" href="classCXLOAuthBehavior.html#af7249190812071dfa47a42f5901382f0">00117</a>   <span class="keyword">public</span> function <a class="code" href="classCXLOAuthBehavior.html#af7249190812071dfa47a42f5901382f0">setIsAuthorized</a>( $isAuthorized )
<a name="l00118"></a>00118   {
<a name="l00119"></a>00119     $this-&gt;_isAuthorized = $isAuthorized;
<a name="l00120"></a>00120     <span class="keywordflow">return</span> $this;
<a name="l00121"></a>00121   }
<a name="l00122"></a>00122 
<a name="l00123"></a><a class="code" href="classCXLOAuthBehavior.html#a65444343b71d28e0f96b3e4c60b8a393">00123</a>   <span class="keyword">public</span> function <a class="code" href="classCXLOAuthBehavior.html#a65444343b71d28e0f96b3e4c60b8a393">getAccessTokenUrl</a>()
<a name="l00124"></a>00124   {
<a name="l00125"></a>00125     <span class="keywordflow">return</span> $this-&gt;_accessTokenUrl;
<a name="l00126"></a>00126   }
<a name="l00127"></a>00127 
<a name="l00128"></a><a class="code" href="classCXLOAuthBehavior.html#ae25193177398cc0288403065233889a1">00128</a>   <span class="keyword">public</span> function <a class="code" href="classCXLOAuthBehavior.html#ae25193177398cc0288403065233889a1">setAccessTokenUrl</a>( $accessTokenUrl )
<a name="l00129"></a>00129   {
<a name="l00130"></a>00130     $this-&gt;_accessTokenUrl = $accessTokenUrl;
<a name="l00131"></a>00131     <span class="keywordflow">return</span> $this;
<a name="l00132"></a>00132   }
<a name="l00133"></a>00133 
<a name="l00138"></a><a class="code" href="classCXLOAuthBehavior.html#a94d630cf8cc55a8a7929862d81e3a6ab">00138</a>   <span class="keyword">public</span> function <a class="code" href="classCXLOAuthBehavior.html#a94d630cf8cc55a8a7929862d81e3a6ab" title="I Appends the current token to the authorizeUrl option.">getAuthorizeUrl</a>()
<a name="l00139"></a>00139   {
<a name="l00140"></a>00140     $_token = $this-&gt;_oauthObject-&gt;getRequestToken( $this-&gt;_apiBaseUrl . $this-&gt;_requestTokenUrl, $this-&gt;_callbackUrl );
<a name="l00141"></a>00141     <span class="keywordflow">return</span> $this-&gt;_apiBaseUrl . $this-&gt;_authorizeUrl . <span class="stringliteral">&#39;?oauth_token=&#39;</span> . $_token[<span class="stringliteral">&#39;oauth_token&#39;</span>];
<a name="l00142"></a>00142   }
<a name="l00143"></a>00143 
<a name="l00144"></a><a class="code" href="classCXLOAuthBehavior.html#a3ba92cd03bf24fc76d4a65fe8078f2c1">00144</a>   <span class="keyword">public</span> function <a class="code" href="classCXLOAuthBehavior.html#a3ba92cd03bf24fc76d4a65fe8078f2c1">setAuthorizeUrl</a>( $authorizeUrl )
<a name="l00145"></a>00145   {
<a name="l00146"></a>00146     $this-&gt;_authorizeUrl = $authorizeUrl;
<a name="l00147"></a>00147     <span class="keywordflow">return</span> $this;
<a name="l00148"></a>00148   }
<a name="l00149"></a>00149 
<a name="l00150"></a><a class="code" href="classCXLOAuthBehavior.html#a414cc1ac9b3577270afe51ca2405d6f2">00150</a>   <span class="keyword">public</span> function <a class="code" href="classCXLOAuthBehavior.html#a414cc1ac9b3577270afe51ca2405d6f2">getRequestTokenUrl</a>()
<a name="l00151"></a>00151   {
<a name="l00152"></a>00152     <span class="keywordflow">return</span> $this-&gt;_requestTokenUrl;
<a name="l00153"></a>00153   }
<a name="l00154"></a>00154 
<a name="l00155"></a><a class="code" href="classCXLOAuthBehavior.html#a192e5b1f622540ab290191f33fa52d49">00155</a>   <span class="keyword">public</span> function <a class="code" href="classCXLOAuthBehavior.html#a192e5b1f622540ab290191f33fa52d49">setRequestTokenUrl</a>( $requestTokenUrl )
<a name="l00156"></a>00156   {
<a name="l00157"></a>00157     $this-&gt;_requestTokenUrl = $requestTokenUrl;
<a name="l00158"></a>00158     <span class="keywordflow">return</span> $this;
<a name="l00159"></a>00159   }
<a name="l00160"></a>00160 
<a name="l00161"></a>00161   <span class="comment">//********************************************************************************</span>
<a name="l00162"></a>00162   <span class="comment">//* Constructor</span>
<a name="l00163"></a>00163   <span class="comment">//********************************************************************************</span>
<a name="l00164"></a>00164 
<a name="l00168"></a><a class="code" href="classCXLOAuthBehavior.html#a095c5d389db211932136b53f25f39685">00168</a>   <span class="keyword">public</span> function <a class="code" href="classCXLOAuthBehavior.html#a095c5d389db211932136b53f25f39685" title="Constructor.">__construct</a>()
<a name="l00169"></a>00169   {
<a name="l00170"></a>00170     <span class="comment">//  No oauth? No run...</span>
<a name="l00171"></a>00171     <span class="keywordflow">if</span> ( ! extension_loaded( <span class="stringliteral">&#39;oauth&#39;</span> ) )
<a name="l00172"></a>00172     {
<a name="l00173"></a>00173       <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classCXLException.html">CXLException</a>(
<a name="l00174"></a>00174         Yii::t(
<a name="l00175"></a>00175           self::CLASS_LOG_TAG, 
<a name="l00176"></a>00176           <span class="stringliteral">&#39;The &quot;oauth&quot; extension is not loaded. Please install and/or load the oath extension (PECL).&#39;</span>
<a name="l00177"></a>00177         )
<a name="l00178"></a>00178       );
<a name="l00179"></a>00179     }
<a name="l00180"></a>00180 
<a name="l00181"></a>00181     <span class="comment">//  Call daddy...</span>
<a name="l00182"></a>00182     <a class="code" href="classCXLOAuthBehavior.html#a095c5d389db211932136b53f25f39685" title="Constructor.">parent::__construct</a>();
<a name="l00183"></a>00183   }
<a name="l00184"></a>00184 
<a name="l00185"></a>00185   <span class="comment">//********************************************************************************</span>
<a name="l00186"></a>00186   <span class="comment">//* Public Methods</span>
<a name="l00187"></a>00187   <span class="comment">//********************************************************************************</span>
<a name="l00188"></a>00188 
<a name="l00192"></a><a class="code" href="classCXLOAuthBehavior.html#a4be4055f3361d4800e16bc2e2e38cda6">00192</a>   <span class="keyword">public</span> function <a class="code" href="classCXLOAuthBehavior.html#a4be4055f3361d4800e16bc2e2e38cda6" title="Initialize this behavior.">init</a>()
<a name="l00193"></a>00193   {
<a name="l00194"></a>00194     <span class="comment">//  Events...</span>
<a name="l00195"></a>00195     $this-&gt;attachEventHandler( <span class="stringliteral">&#39;onUserAuthorized&#39;</span>, array( $this, <span class="stringliteral">&#39;userAuthorized&#39;</span> ) );
<a name="l00196"></a>00196 
<a name="l00197"></a>00197     <span class="comment">//  Create our object...</span>
<a name="l00198"></a>00198     $this-&gt;_oauthObject = <span class="keyword">new</span> OAuth( $this-&gt;apiKey, $this-&gt;apiSecretKey, OAUTH_SIG_METHOD_HMACSHA1, OAUTH_AUTH_TYPE_URI );
<a name="l00199"></a>00199 
<a name="l00200"></a>00200     <span class="comment">//  Load any tokens we have...</span>
<a name="l00201"></a>00201     $this-&gt;<a class="code" href="classCXLOAuthBehavior.html#a5126349c471fcaff1a74b9d117b979b1" title="Loads a token from the user state oAuthToken.">loadToken</a>();
<a name="l00202"></a>00202 
<a name="l00203"></a>00203     <span class="comment">//  Have we been authenticated?</span>
<a name="l00204"></a>00204     <span class="keywordflow">if</span> ( !$this-&gt;isAuthorized )
<a name="l00205"></a>00205     {
<a name="l00206"></a>00206       <span class="keywordflow">if</span> ( isset( $_REQUEST[<span class="stringliteral">&#39;oauth_token&#39;</span>] ) )
<a name="l00207"></a>00207       {
<a name="l00208"></a>00208         <span class="keywordflow">if</span> ( $this-&gt;_oauthObject-&gt;setToken( $_REQUEST[<span class="stringliteral">&#39;oauth_token&#39;</span>], $_REQUEST[<span class="stringliteral">&#39;oauth_verifier&#39;</span>] ) )
<a name="l00209"></a>00209         {
<a name="l00210"></a>00210           $_token = $this-&gt;_oauthObject-&gt;getAccessToken( 
<a name="l00211"></a>00211             $this-&gt;_apiBaseUrl . $this-&gt;_accessTokenUrl,
<a name="l00212"></a>00212             null, 
<a name="l00213"></a>00213             $_REQUEST[<span class="stringliteral">&#39;oauth_verifier&#39;</span>]
<a name="l00214"></a>00214           );
<a name="l00215"></a>00215 
<a name="l00216"></a>00216           $this-&gt;<a class="code" href="classCXLOAuthBehavior.html#a8027c4853ebf41108725eb798ebfcd59" title="Stores the current token in a member variable and in the user state oAuthToken.">storeToken</a>( $_token );
<a name="l00217"></a>00217           $this-&gt;_isAuthorized = <span class="keyword">true</span>;
<a name="l00218"></a>00218         }
<a name="l00219"></a>00219 
<a name="l00220"></a>00220         <span class="comment">//  Raise our event</span>
<a name="l00221"></a>00221         <span class="keywordflow">if</span> ( $this-&gt;_isAuthorized ) 
<a name="l00222"></a>00222           $this-&gt;<a class="code" href="classCXLOAuthBehavior.html#aeea17b8cf4b07497f4c9a4d5462c752a" title="User has been authorized event.">onUserAuthorized</a>( <span class="keyword">new</span> CPSOAuthEvent( $this-&gt;_oauthToken ) );
<a name="l00223"></a>00223       }
<a name="l00224"></a>00224     }
<a name="l00225"></a>00225   }
<a name="l00226"></a>00226 
<a name="l00231"></a><a class="code" href="classCXLOAuthBehavior.html#a8027c4853ebf41108725eb798ebfcd59">00231</a>   <span class="keyword">public</span> function <a class="code" href="classCXLOAuthBehavior.html#a8027c4853ebf41108725eb798ebfcd59" title="Stores the current token in a member variable and in the user state oAuthToken.">storeToken</a>( $token = array() )
<a name="l00232"></a>00232   {
<a name="l00233"></a>00233     <span class="keywordflow">try</span>
<a name="l00234"></a>00234     {
<a name="l00235"></a>00235       <a class="code" href="classYiiXLBase.html#aa5c4459afda5a8a58c46a26aecafaf37" title="Stores a variable from the user session.">XL::_ss</a>( <a class="code" href="classCXLHash.html#ace936368fcb6b1d6d533c4d19cf7e596" title="Generic hashing method.">CXLHash::hash</a>( <span class="stringliteral">&#39;OAuthToken&#39;</span> . $this-&gt;_apiBaseUrl ), $token );
<a name="l00236"></a>00236       <a class="code" href="classYiiXLBase.html#aa5c4459afda5a8a58c46a26aecafaf37" title="Stores a variable from the user session.">XL::_ss</a>( <a class="code" href="classCXLHash.html#ace936368fcb6b1d6d533c4d19cf7e596" title="Generic hashing method.">CXLHash::hash</a>( <span class="stringliteral">&#39;OAuthorized&#39;</span> . $this-&gt;_apiBaseUrl ), (<span class="keywordtype">boolean</span>)$this-&gt;_isAuthorized );
<a name="l00237"></a>00237 
<a name="l00238"></a>00238       $this-&gt;_oauthToken = $token;
<a name="l00239"></a>00239     }
<a name="l00240"></a>00240     <span class="keywordflow">catch</span> ( Exception $_ex )
<a name="l00241"></a>00241     {
<a name="l00242"></a>00242       XL::logError(
<a name="l00243"></a>00243         self::CLASS_LOG_TAG,
<a name="l00244"></a>00244         Yii::t( 
<a name="l00245"></a>00245           self::CLASS_LOG_TAG, 
<a name="l00246"></a>00246           <span class="stringliteral">&#39;Error storing OAuth token &quot;{a}/{b}&quot; : {c}&#39;</span>, 
<a name="l00247"></a>00247           array( 
<a name="l00248"></a>00248             <span class="stringliteral">&quot;{a}&quot;</span> =&gt; $token[<span class="stringliteral">&#39;oauth_token&#39;</span>], 
<a name="l00249"></a>00249             <span class="stringliteral">&quot;{b}&quot;</span> =&gt; $token[<span class="stringliteral">&#39;oauth_token_secret&#39;</span>], 
<a name="l00250"></a>00250             <span class="stringliteral">&quot;{c}&quot;</span> =&gt; $_ex-&gt;getMessage() 
<a name="l00251"></a>00251           ) 
<a name="l00252"></a>00252         ) 
<a name="l00253"></a>00253       );
<a name="l00254"></a>00254     }
<a name="l00255"></a>00255   }
<a name="l00256"></a>00256 
<a name="l00260"></a><a class="code" href="classCXLOAuthBehavior.html#a5126349c471fcaff1a74b9d117b979b1">00260</a>   <span class="keyword">public</span> function <a class="code" href="classCXLOAuthBehavior.html#a5126349c471fcaff1a74b9d117b979b1" title="Loads a token from the user state oAuthToken.">loadToken</a>()
<a name="l00261"></a>00261   {
<a name="l00262"></a>00262     $_token = array();
<a name="l00263"></a>00263     
<a name="l00264"></a>00264     <span class="keywordflow">if</span> ( null != ( $_token = <a class="code" href="classYiiXLBase.html#adeaa7024db6a25cc45abc37c388661d3" title="Returns the value of a variable that is stored in the user session.">XL::_gs</a>( <a class="code" href="classCXLHash.html#ace936368fcb6b1d6d533c4d19cf7e596" title="Generic hashing method.">CXLHash::hash</a>( <span class="stringliteral">&#39;OAuthToken&#39;</span> . $this-&gt;_apiBaseUrl ) ) ) )
<a name="l00265"></a>00265     {
<a name="l00266"></a>00266       $this-&gt;_oauthToken = $_token;
<a name="l00267"></a>00267       $this-&gt;_isAuthorized = ( <span class="keyword">true</span> === <a class="code" href="classYiiXLBase.html#adeaa7024db6a25cc45abc37c388661d3" title="Returns the value of a variable that is stored in the user session.">XL::_gs</a>( <a class="code" href="classCXLHash.html#ace936368fcb6b1d6d533c4d19cf7e596" title="Generic hashing method.">CXLHash::hash</a>( <span class="stringliteral">&#39;OAuthorized&#39;</span> . $this-&gt;_apiBaseUrl ) ) );
<a name="l00268"></a>00268     }
<a name="l00269"></a>00269     
<a name="l00270"></a>00270     <span class="keywordflow">return</span> $_token;
<a name="l00271"></a>00271   }
<a name="l00272"></a>00272 
<a name="l00273"></a>00273   <span class="comment">//********************************************************************************</span>
<a name="l00274"></a>00274   <span class="comment">//* Events</span>
<a name="l00275"></a>00275   <span class="comment">//********************************************************************************</span>
<a name="l00276"></a>00276 
<a name="l00281"></a><a class="code" href="classCXLOAuthBehavior.html#aeea17b8cf4b07497f4c9a4d5462c752a">00281</a>   <span class="keyword">public</span> function <a class="code" href="classCXLOAuthBehavior.html#aeea17b8cf4b07497f4c9a4d5462c752a" title="User has been authorized event.">onUserAuthorized</a>( $event )
<a name="l00282"></a>00282   {
<a name="l00283"></a>00283     $this-&gt;raiseEvent( <span class="stringliteral">&#39;onUserAuthorized&#39;</span>, $event );
<a name="l00284"></a>00284   }
<a name="l00285"></a>00285 
<a name="l00286"></a>00286 }
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Mar 25 2011 21:10:39 for YiiXL -- The Yii Extension Library Of Doom! by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
