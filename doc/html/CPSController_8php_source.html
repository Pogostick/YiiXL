<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>&quot;The Yii Extension Library Of Doom!&quot;: /usr/local/yiixl/lib/original/controllers/CPSController.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>/usr/local/yiixl/lib/original/controllers/CPSController.php</h1>  </div>
</div>
<div class="contents">
<a href="CPSController_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00022"></a><a class="code" href="classCPSController.html">00022</a> <span class="keyword">abstract</span> <span class="keyword">class </span><a class="code" href="classCPSController.html">CPSController</a> <span class="keyword">extends</span> CController implements <a class="code" href="interfaceIPSBase.html">IPSBase</a>
<a name="l00023"></a>00023 {
<a name="l00024"></a>00024     <span class="comment">//********************************************************************************</span>
<a name="l00025"></a>00025     <span class="comment">//* Constants</span>
<a name="l00026"></a>00026     <span class="comment">//********************************************************************************</span>
<a name="l00027"></a>00027 
<a name="l00031"></a><a class="code" href="classCPSController.html#a4634a091c35db33009455321e1d259e3">00031</a>     <span class="keyword">const</span> <a class="code" href="classCPSController.html#a4634a091c35db33009455321e1d259e3">PAGE_SIZE</a> = 10;
<a name="l00032"></a>00032 
<a name="l00036"></a><a class="code" href="classCPSController.html#ab269679ab48227854fa6fa0a6d344324">00036</a>     <span class="keyword">const</span> <a class="code" href="classCPSController.html#ab269679ab48227854fa6fa0a6d344324">ACCESS_TO_ALL</a> = 0;
<a name="l00037"></a><a class="code" href="classCPSController.html#a8b17406db740d630ae61ecf3cd9bbd8c">00037</a>     <span class="keyword">const</span> <a class="code" href="classCPSController.html#a8b17406db740d630ae61ecf3cd9bbd8c">ACCESS_TO_ANY</a> = 0;
<a name="l00038"></a><a class="code" href="classCPSController.html#abc512a8f331daed89e84a7d8f44775c4">00038</a>     <span class="keyword">const</span> <a class="code" href="classCPSController.html#abc512a8f331daed89e84a7d8f44775c4">ACCESS_TO_ANON</a> = 0;
<a name="l00039"></a><a class="code" href="classCPSController.html#aaef8a39bfe4d39dca0f45fdb837a8d59">00039</a>     <span class="keyword">const</span> <a class="code" href="classCPSController.html#aaef8a39bfe4d39dca0f45fdb837a8d59">ACCESS_TO_GUEST</a> = 1;
<a name="l00040"></a><a class="code" href="classCPSController.html#a437b41cb9e13e41157d57e7736366295">00040</a>     <span class="keyword">const</span> <a class="code" href="classCPSController.html#a437b41cb9e13e41157d57e7736366295">ACCESS_TO_AUTH</a> = 2;
<a name="l00041"></a><a class="code" href="classCPSController.html#a16a362e48c9f7e6757bb15e0a3d9fa4f">00041</a>     <span class="keyword">const</span> <a class="code" href="classCPSController.html#a16a362e48c9f7e6757bb15e0a3d9fa4f">ACCESS_TO_ADMIN</a> = 3;
<a name="l00042"></a><a class="code" href="classCPSController.html#a91cdb5f485c387235bfbd09b1bb132bb">00042</a>     <span class="keyword">const</span> <a class="code" href="classCPSController.html#a91cdb5f485c387235bfbd09b1bb132bb">ACCESS_TO_SUPERADMIN</a> = 5;
<a name="l00043"></a>00043 
<a name="l00044"></a>00044     <span class="comment">//  Last...</span>
<a name="l00045"></a><a class="code" href="classCPSController.html#a63d56389fe1e58d0b097471ca4f4dc00">00045</a>     <span class="keyword">const</span> <a class="code" href="classCPSController.html#a63d56389fe1e58d0b097471ca4f4dc00">ACCESS_TO_NONE</a> = 6;
<a name="l00046"></a>00046 
<a name="l00050"></a><a class="code" href="classCPSController.html#acfa3d37fd2964302d32a8905a102196d">00050</a>     <span class="keyword">const</span> <a class="code" href="classCPSController.html#acfa3d37fd2964302d32a8905a102196d">COMMAND_FIELD_NAME</a> = <span class="stringliteral">&#39;__psCommand&#39;</span>;
<a name="l00051"></a>00051 
<a name="l00055"></a><a class="code" href="classCPSController.html#a21930d5a45a39f983d1b157fd28819dc">00055</a>     <span class="keyword">const</span> <a class="code" href="classCPSController.html#a21930d5a45a39f983d1b157fd28819dc">SEARCH_HELP_TEXT</a> = <span class="stringliteral">&#39;You may optionally enter a comparison operator (&lt;b&gt;&amp;lt;&lt;/b&gt;, &lt;b&gt;&amp;lt;=&lt;/b&gt;, &lt;b&gt;&amp;gt;&lt;/b&gt;, &lt;b&gt;&amp;gt;=&lt;/b&gt;, &lt;b&gt;&amp;lt;&amp;gt;&lt;/b&gt;or &lt;b&gt;=&lt;/b&gt;) at the beginning of each search value to specify how the comparison should be done.&#39;</span>;
<a name="l00056"></a>00056 
<a name="l00057"></a>00057     <span class="comment">//********************************************************************************</span>
<a name="l00058"></a>00058     <span class="comment">//* Member Variables</span>
<a name="l00059"></a>00059     <span class="comment">//********************************************************************************</span>
<a name="l00060"></a>00060 
<a name="l00064"></a><a class="code" href="classCPSController.html#a4192f529627c76fa7a70ae23b9582516">00064</a>     <span class="keyword">protected</span> <a class="code" href="classCPSController.html#a4192f529627c76fa7a70ae23b9582516">$_menu</a> = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>();
<a name="l00065"></a><a class="code" href="classCPSController.html#a637e84e2e9e99a87ea9b5f1771551af4">00065</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a637e84e2e9e99a87ea9b5f1771551af4">getMenu</a>() { <span class="keywordflow">return</span> $this-&gt;_menu; }
<a name="l00066"></a><a class="code" href="classCPSController.html#a5cf6c2464263681fdc1186bb94ee9ad8">00066</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a5cf6c2464263681fdc1186bb94ee9ad8">setMenu</a>( $value ) { $this-&gt;_menu = $value; }
<a name="l00067"></a>00067 
<a name="l00073"></a><a class="code" href="classCPSController.html#aa29f8061f06b0d1991b405eb2b5817fd">00073</a>     <span class="keyword">protected</span> <a class="code" href="classCPSController.html#aa29f8061f06b0d1991b405eb2b5817fd">$_breadcrumbs</a> = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>();
<a name="l00074"></a><a class="code" href="classCPSController.html#ab53bf1b4b27392839a16ecf3ad62e88b">00074</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#ab53bf1b4b27392839a16ecf3ad62e88b">getBreadcrumbs</a>() { <span class="keywordflow">return</span> $this-&gt;_breadcrumbs; }
<a name="l00075"></a><a class="code" href="classCPSController.html#a9f9822dfb5d491a6e0b9c836d6ce4e3f">00075</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a9f9822dfb5d491a6e0b9c836d6ce4e3f">setBreadcrumbs</a>( $value ) { $this-&gt;_breadcrumbs = $value; }
<a name="l00076"></a>00076 
<a name="l00081"></a><a class="code" href="classCPSController.html#a13d322a909191c149073cc615301d6c2">00081</a>     <span class="keyword">protected</span> <a class="code" href="classCPSController.html#a13d322a909191c149073cc615301d6c2">$m_sPageHeading</a>;
<a name="l00082"></a><a class="code" href="classCPSController.html#af6a608839df34306457a0f877695bce0">00082</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#af6a608839df34306457a0f877695bce0">getPageHeading</a>() { <span class="keywordflow">return</span> $this-&gt;m_sPageHeading; }
<a name="l00083"></a><a class="code" href="classCPSController.html#ae9f3d82f9cfc2b5c2b2f2387c85e7734">00083</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#ae9f3d82f9cfc2b5c2b2f2387c85e7734">setPageHeading</a>( $sValue ) { $this-&gt;m_sPageHeading = $sValue; }
<a name="l00084"></a>00084 
<a name="l00085"></a>00085     <span class="comment">/***</span>
<a name="l00086"></a>00086 <span class="comment">    * Allows you to change your action prefix</span>
<a name="l00087"></a>00087 <span class="comment">    *</span>
<a name="l00088"></a>00088 <span class="comment">    * @var string</span>
<a name="l00089"></a>00089 <span class="comment">    */</span>
<a name="l00090"></a><a class="code" href="classCPSController.html#a00395af87aa1ea39a227b3ff7f822455">00090</a>     <span class="keyword">protected</span> <a class="code" href="classCPSController.html#a00395af87aa1ea39a227b3ff7f822455">$m_sMethodPrefix</a> = <span class="stringliteral">&#39;action&#39;</span>;
<a name="l00091"></a><a class="code" href="classCPSController.html#a8a81d9dd6fbd83ceb09f97c07f499e5b">00091</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a8a81d9dd6fbd83ceb09f97c07f499e5b">getMethodPrefix</a>() { <span class="keywordflow">return</span> $this-&gt;m_sMethodPrefix; }
<a name="l00092"></a><a class="code" href="classCPSController.html#a5c477614d2275918d6498e2c92b41a4f">00092</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a5c477614d2275918d6498e2c92b41a4f">setMethodPrefix</a>( $sValue ) { $this-&gt;m_sMethodPrefix = $sValue; }
<a name="l00093"></a>00093 
<a name="l00098"></a><a class="code" href="classCPSController.html#ac050ea66692a19671c369961a81fb7f7">00098</a>     <span class="keyword">protected</span> <a class="code" href="classCPSController.html#ac050ea66692a19671c369961a81fb7f7">$m_oModel</a> = null;
<a name="l00099"></a><a class="code" href="classCPSController.html#a0a086ca877b41192556a2de7e4a97b98">00099</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a0a086ca877b41192556a2de7e4a97b98">getModel</a>() { <span class="keywordflow">return</span> $this-&gt;m_oModel; }
<a name="l00100"></a><a class="code" href="classCPSController.html#adfc5ef703eac3b48de3d2f81d8de6b14">00100</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#adfc5ef703eac3b48de3d2f81d8de6b14">setModel</a>( $oValue ) { $this-&gt;m_oModel = $oValue; }
<a name="l00101"></a>00101 
<a name="l00106"></a><a class="code" href="classCPSController.html#ac69f9415b98d14c89043029a9c2cb0cc">00106</a>     <span class="keyword">protected</span> <a class="code" href="classCPSController.html#ac69f9415b98d14c89043029a9c2cb0cc">$m_sModelName</a> = null;
<a name="l00107"></a><a class="code" href="classCPSController.html#a3caade7aa0b96407057e060e4a8bba1e">00107</a>     <span class="keyword">protected</span> <a class="code" href="classCPSController.html#a3caade7aa0b96407057e060e4a8bba1e">$_modelName</a> = null;
<a name="l00108"></a><a class="code" href="classCPSController.html#a7cd2e13f50fbc61e846e5980f02371f8">00108</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a7cd2e13f50fbc61e846e5980f02371f8">getModelName</a>() { <span class="keywordflow">return</span> $this-&gt;m_sModelName; }
<a name="l00109"></a><a class="code" href="classCPSController.html#a176dfa82642f33d337898c51f4bcd01e">00109</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#a176dfa82642f33d337898c51f4bcd01e">setModelName</a>( $value )
<a name="l00110"></a>00110     {
<a name="l00111"></a>00111         $this-&gt;_modelName = $this-&gt;m_sModelName = $value;
<a name="l00112"></a>00112         $this-&gt;m_sSearchStateId = <span class="stringliteral">&#39;PS_&#39;</span> . strtoupper( $value ) . <span class="stringliteral">&#39;_SEARCH_CRIT&#39;</span>;
<a name="l00113"></a>00113         $this-&gt;m_arCurrentSearchCriteria = PS::_gs( $this-&gt;m_sSearchStateId );
<a name="l00114"></a>00114     }
<a name="l00115"></a>00115 
<a name="l00120"></a><a class="code" href="classCPSController.html#acea2c7c705d91ba736a41e67314e5ae3">00120</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#acea2c7c705d91ba736a41e67314e5ae3">getIsPostRequest</a>() { <span class="keywordflow">return</span> Yii::app()-&gt;getRequest()-&gt;isPostRequest; }
<a name="l00121"></a>00121 
<a name="l00126"></a><a class="code" href="classCPSController.html#aed1df55c262bb0238ae6ef0921a2552b">00126</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#aed1df55c262bb0238ae6ef0921a2552b">getIsAjaxRequest</a>() { <span class="keywordflow">return</span> Yii::app()-&gt;getRequest()-&gt;isAjaxRequest; }
<a name="l00127"></a>00127 
<a name="l00132"></a><a class="code" href="classCPSController.html#ae32b7248cefed2da5b054c1a4ab674b1">00132</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#ae32b7248cefed2da5b054c1a4ab674b1">getAppBaseUrl</a>() { <span class="keywordflow">return</span> Yii::app()-&gt;getBaseUrl(); }
<a name="l00133"></a>00133 
<a name="l00139"></a><a class="code" href="classCPSController.html#abf7a80aa37d98c6879fdeac9b9ed0dfd">00139</a>     <span class="keyword">protected</span> <a class="code" href="classCPSController.html#abf7a80aa37d98c6879fdeac9b9ed0dfd">$m_sSearchStateId</a> = null;
<a name="l00140"></a>00140 
<a name="l00146"></a><a class="code" href="classCPSController.html#ad84b172fc8b07205968983aa7ead7f56">00146</a>     <span class="keyword">protected</span> <a class="code" href="classCPSController.html#ad84b172fc8b07205968983aa7ead7f56">$m_arCurrentSearchCriteria</a> = null;
<a name="l00147"></a><a class="code" href="classCPSController.html#ac366c580ea717b34409e76a8ab7a3ab5">00147</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#ac366c580ea717b34409e76a8ab7a3ab5">getSearchCriteria</a>() { <span class="keywordflow">return</span> $this-&gt;m_arCurrentSearchCriteria; }
<a name="l00148"></a><a class="code" href="classCPSController.html#a72e3b4ef82df75bc36fda985e7675f6c">00148</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a72e3b4ef82df75bc36fda985e7675f6c">setSearchCriteria</a>( $arValue )
<a name="l00149"></a>00149     {
<a name="l00150"></a>00150         $this-&gt;m_arCurrentSearchCriteria = $arValue;
<a name="l00151"></a>00151         Yii::app()-&gt;user-&gt;setState( $this-&gt;m_sSearchStateId, $arValue );
<a name="l00152"></a>00152     }
<a name="l00153"></a>00153 
<a name="l00158"></a><a class="code" href="classCPSController.html#a112cfb0eb5096b5a3d03c88d0aa1fa50">00158</a>     <span class="keyword">public</span> <a class="code" href="classCPSController.html#a112cfb0eb5096b5a3d03c88d0aa1fa50">$_pageLayout</a> = <span class="stringliteral">&#39;main&#39;</span>;
<a name="l00159"></a><a class="code" href="classCPSController.html#afd49c7d611aa05c4279a84605f81b771">00159</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#afd49c7d611aa05c4279a84605f81b771">getPageLayout</a>() { <span class="keywordflow">return</span> $this-&gt;_pageLayout = $this-&gt;layout; }
<a name="l00160"></a><a class="code" href="classCPSController.html#a017628084a8217853815f7bbf5715c5f">00160</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a017628084a8217853815f7bbf5715c5f">setPageLayout</a>( $value ) { $this-&gt;_pageLayout = $this-&gt;layout = $value; }
<a name="l00161"></a>00161 
<a name="l00166"></a><a class="code" href="classCPSController.html#a563111c63fb9315722e30c4798e1edf7">00166</a>     <span class="keyword">protected</span> <a class="code" href="classCPSController.html#a563111c63fb9315722e30c4798e1edf7">$_contentLayout</a> = null;
<a name="l00167"></a><a class="code" href="classCPSController.html#a0f302f5db2749bfa4476ac5ec749069c">00167</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a0f302f5db2749bfa4476ac5ec749069c">getContentLayout</a>() { <span class="keywordflow">return</span> $this-&gt;_contentLayout; }
<a name="l00168"></a><a class="code" href="classCPSController.html#a1d05eefc9d36e19d69d21f84d0235ccb">00168</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a1d05eefc9d36e19d69d21f84d0235ccb">setContentLayout</a>( $value ) { $this-&gt;_contentLayout = $value; }
<a name="l00169"></a>00169 
<a name="l00174"></a><a class="code" href="classCPSController.html#a82f270690d35ca2d667930309b40e52e">00174</a>     <span class="keyword">protected</span> <a class="code" href="classCPSController.html#a82f270690d35ca2d667930309b40e52e">$m_bAutoLayout</a> = <span class="keyword">true</span>;
<a name="l00175"></a><a class="code" href="classCPSController.html#a5ca02f261713deddbc733f9889262bc6">00175</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a5ca02f261713deddbc733f9889262bc6">getAutoLayout</a>() { <span class="keywordflow">return</span> $this-&gt;m_bAutoLayout; }
<a name="l00176"></a><a class="code" href="classCPSController.html#a4e941395b345a9e6dcf5881e1b500a7f">00176</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a4e941395b345a9e6dcf5881e1b500a7f">setAutoLayout</a>( $bValue ) { $this-&gt;m_bAutoLayout = $bValue; }
<a name="l00177"></a>00177 
<a name="l00182"></a><a class="code" href="classCPSController.html#a348549b714d32b0cd44fe0e63100ed8a">00182</a>     <span class="keyword">protected</span> <a class="code" href="classCPSController.html#a348549b714d32b0cd44fe0e63100ed8a">$m_bAutoMissing</a> = <span class="keyword">true</span>;
<a name="l00183"></a><a class="code" href="classCPSController.html#adcb044b9181c938a76c2f327a32a94cf">00183</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#adcb044b9181c938a76c2f327a32a94cf">getAutoMissing</a>() { <span class="keywordflow">return</span> $this-&gt;m_bAutoMissing; }
<a name="l00184"></a><a class="code" href="classCPSController.html#af65a56f5b2e170bcc04e7e58e7053468">00184</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#af65a56f5b2e170bcc04e7e58e7053468">setAutoMissing</a>( $bValue ) { $this-&gt;m_bAutoMissing = $sValue; }
<a name="l00185"></a>00185 
<a name="l00190"></a><a class="code" href="classCPSController.html#a8a9ecdbe8dd0813218e90b2e4642900b">00190</a>     <span class="keyword">protected</span> <a class="code" href="classCPSController.html#a8a9ecdbe8dd0813218e90b2e4642900b">$m_arCommandMap</a> = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>();
<a name="l00191"></a><a class="code" href="classCPSController.html#a89402cb8f4907eea9ae447e93580b78f">00191</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a89402cb8f4907eea9ae447e93580b78f">getCommandMap</a>() { <span class="keywordflow">return</span> $this-&gt;m_arCommandMap; }
<a name="l00192"></a><a class="code" href="classCPSController.html#aae34745f7eebb0acbab0de4bfd82e8ef">00192</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#aae34745f7eebb0acbab0de4bfd82e8ef">setCommandMap</a>( $oValue ) { $this-&gt;m_arCommandMap = $oValue; }
<a name="l00193"></a><a class="code" href="classCPSController.html#a9257841e8eb56318da1b6ccc7116f93b">00193</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a9257841e8eb56318da1b6ccc7116f93b">addCommandToMap</a>( $sKey, $oValue = null, $eWhich = null ) { $this-&gt;m_arCommandMap[ $sKey ] = $oValue; <span class="keywordflow">if</span> ( $eWhich ) $this-&gt;<a class="code" href="classCPSController.html#a208ea175f66013e55b87d10533089fd4">addUserActions</a>( $eWhich, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( $sKey ) ); }
<a name="l00194"></a>00194 
<a name="l00199"></a><a class="code" href="classCPSController.html#a38c24de57d837a560704c7d6aa27526b">00199</a>     <span class="keyword">protected</span> <a class="code" href="classCPSController.html#a38c24de57d837a560704c7d6aa27526b">$m_arActionQueue</a> = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>();
<a name="l00200"></a>00200 
<a name="l00205"></a><a class="code" href="classCPSController.html#a3c4633512ae87d3b845b59d4514115d5">00205</a>     <span class="keyword">protected</span> <a class="code" href="classCPSController.html#a3c4633512ae87d3b845b59d4514115d5">$m_arPortletActions</a> = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>();
<a name="l00206"></a><a class="code" href="classCPSController.html#ae3e26353e430eb74e086211a9bfcb957">00206</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#ae3e26353e430eb74e086211a9bfcb957">getPortletActions</a>() { <span class="keywordflow">return</span> $this-&gt;m_arPortletActions; }
<a name="l00207"></a><a class="code" href="classCPSController.html#a99a826c8042e271ff66a753b32b8de92">00207</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a99a826c8042e271ff66a753b32b8de92">setPortletActions</a>( $arValue ) { $this-&gt;m_arPortletActions = $arValue; }
<a name="l00208"></a><a class="code" href="classCPSController.html#a1103c34c21ad3fac33acc05c977edd46">00208</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a1103c34c21ad3fac33acc05c977edd46">addPortletAction</a>( $sName, $arCallback ) { $this-&gt;m_arPortletActions[ $sName ] = $arCallback; }
<a name="l00209"></a>00209 
<a name="l00214"></a><a class="code" href="classCPSController.html#ab936222c5497f6831286605649606119">00214</a>     <span class="keyword">protected</span> <a class="code" href="classCPSController.html#ab936222c5497f6831286605649606119">$m_arUserActionList</a> = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>();
<a name="l00215"></a><a class="code" href="classCPSController.html#a31c904e5fb114fc2dbaa9363859b0655">00215</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#a31c904e5fb114fc2dbaa9363859b0655">resetUserActionList</a>() { $this-&gt;m_arUserActionList = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(); $this-&gt;<a class="code" href="classCPSController.html#a2f24158b505e68f422cbc0682e588e14">addUserAction</a>( self::ACCESS_TO_ANY, <span class="stringliteral">&#39;error&#39;</span> ); }
<a name="l00216"></a><a class="code" href="classCPSController.html#aee2a89d58ba7ecfae1b0a6e5fa43c992">00216</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#aee2a89d58ba7ecfae1b0a6e5fa43c992">setUserActionList</a>( $eWhich, $arValue ) { $this-&gt;m_arUserActionList[ $eWhich ] = null; $this-&gt;<a class="code" href="classCPSController.html#a208ea175f66013e55b87d10533089fd4">addUserActions</a>( $eWhich, $arValue ); }
<a name="l00217"></a><a class="code" href="classCPSController.html#a476bee2f85d13492b886802c3797fbd6">00217</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a476bee2f85d13492b886802c3797fbd6">getUserActionList</a>( $eWhich ) { <span class="keywordflow">return</span> PS::o( $this-&gt;m_arUserActionList, $eWhich ); }
<a name="l00218"></a><a class="code" href="classCPSController.html#a773d259068d63346c06397103cf01889">00218</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a773d259068d63346c06397103cf01889">addUserActionRole</a>( $eWhich, $sRole, $sAction ) { $this-&gt;m_arUserActionList[ $eWhich ][<span class="stringliteral">&#39;roles&#39;</span>][] = $arValue; }
<a name="l00219"></a>00219 
<a name="l00220"></a><a class="code" href="classCPSController.html#a14ef986219c300d32d5f8f2cf716353c">00220</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a14ef986219c300d32d5f8f2cf716353c">removeUserAction</a>( $eWhich, $sAction )
<a name="l00221"></a>00221     {
<a name="l00222"></a>00222         <span class="keywordflow">if</span> ( ! isset( $this-&gt;m_arUserActionList[ $eWhich ] ) || ! is_array( $this-&gt;m_arUserActionList[ $eWhich ] ) )
<a name="l00223"></a>00223             <span class="keywordflow">return</span>;
<a name="l00224"></a>00224 
<a name="l00225"></a>00225         <span class="keywordflow">if</span> ( in_array( $sAction, $this-&gt;m_arUserActionList[ $eWhich ] ) )
<a name="l00226"></a>00226             unset( $this-&gt;m_arUserActionList[ $eWhich ][ $sAction ] );
<a name="l00227"></a>00227     }
<a name="l00228"></a>00228 
<a name="l00229"></a><a class="code" href="classCPSController.html#a2f24158b505e68f422cbc0682e588e14">00229</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a2f24158b505e68f422cbc0682e588e14">addUserAction</a>( $eWhich, $sAction )
<a name="l00230"></a>00230     {
<a name="l00231"></a>00231         <span class="keywordflow">if</span> ( ! isset( $this-&gt;m_arUserActionList[ $eWhich ] ) || ! is_array( $this-&gt;m_arUserActionList[ $eWhich ] ) )
<a name="l00232"></a>00232             $this-&gt;m_arUserActionList[ $eWhich ] = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>();
<a name="l00233"></a>00233 
<a name="l00234"></a>00234         <span class="keywordflow">if</span> ( ! in_array( $sAction, $this-&gt;m_arUserActionList[ $eWhich ] ) )
<a name="l00235"></a>00235             $this-&gt;m_arUserActionList[ $eWhich ][] = $sAction;
<a name="l00236"></a>00236 
<a name="l00237"></a>00237         <span class="comment">//  Make sure we don&#39;t lose our error handler...</span>
<a name="l00238"></a>00238         <span class="keywordflow">if</span> ( $eWhich == self::ACCESS_TO_ANY )
<a name="l00239"></a>00239         {
<a name="l00240"></a>00240             <span class="keywordflow">if</span> ( ! in_array( <span class="stringliteral">&#39;error&#39;</span>, $this-&gt;m_arUserActionList[ $eWhich ] ) )
<a name="l00241"></a>00241                 $this-&gt;<a class="code" href="classCPSController.html#a2f24158b505e68f422cbc0682e588e14">addUserAction</a>( self::ACCESS_TO_ANY, <span class="stringliteral">&#39;error&#39;</span> );
<a name="l00242"></a>00242         }
<a name="l00243"></a>00243     }
<a name="l00244"></a>00244 
<a name="l00245"></a><a class="code" href="classCPSController.html#a208ea175f66013e55b87d10533089fd4">00245</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a208ea175f66013e55b87d10533089fd4">addUserActions</a>( $eWhich, $arActions = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() )
<a name="l00246"></a>00246     {
<a name="l00247"></a>00247         <span class="keywordflow">if</span> ( ! is_array( PS::o( $this-&gt;m_arUserActionList, $eWhich ) ) )
<a name="l00248"></a>00248             $this-&gt;m_arUserActionList[ $eWhich ] = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>();
<a name="l00249"></a>00249 
<a name="l00250"></a>00250         <span class="keywordflow">foreach</span> ( $arActions as $_sAction )
<a name="l00251"></a>00251             $this-&gt;<a class="code" href="classCPSController.html#a2f24158b505e68f422cbc0682e588e14">addUserAction</a>( $eWhich, $_sAction );
<a name="l00252"></a>00252     }
<a name="l00253"></a>00253 
<a name="l00254"></a><a class="code" href="classCPSController.html#a888e2769fd7505af5c103a238c06b363">00254</a>     <span class="keyword">protected</span> <a class="code" href="classCPSController.html#a888e2769fd7505af5c103a238c06b363">$_displayName</a>;
<a name="l00255"></a><a class="code" href="classCPSController.html#abe464c0e9916ca43403a649587875804">00255</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#abe464c0e9916ca43403a649587875804">setDisplayName</a>( $value ) { $this-&gt;_displayName = $value; }
<a name="l00256"></a><a class="code" href="classCPSController.html#a273f6220e7dea1423919139742e04902">00256</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#a273f6220e7dea1423919139742e04902">getDisplayName</a>() { <span class="keywordflow">return</span> $this-&gt;_displayName; }
<a name="l00257"></a>00257 
<a name="l00258"></a><a class="code" href="classCPSController.html#a346b1f2edaa55ceb440e5eaef797e927">00258</a>     <span class="keyword">protected</span> <a class="code" href="classCPSController.html#a346b1f2edaa55ceb440e5eaef797e927">$_cleanTrail</a>;
<a name="l00259"></a><a class="code" href="classCPSController.html#ae3221c17c6defb911162b50823032f36">00259</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#ae3221c17c6defb911162b50823032f36">getCleanTrail</a>() { <span class="keywordflow">return</span> $this-&gt;_cleanTrail; }
<a name="l00260"></a><a class="code" href="classCPSController.html#ac4bc10f13ac2c2b7a97b2dc3dea3155a">00260</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#ac4bc10f13ac2c2b7a97b2dc3dea3155a">setCleanTrail</a>( $value ) { $this-&gt;_cleanTrail = $value; }
<a name="l00261"></a>00261     
<a name="l00265"></a><a class="code" href="classCPSController.html#a32acaa681d9d516f9964704f41590546">00265</a>     <span class="keyword">protected</span> <a class="code" href="classCPSController.html#a32acaa681d9d516f9964704f41590546">$_viewData</a> = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>();
<a name="l00266"></a><a class="code" href="classCPSController.html#a09cb66dd061fa338ab2a85a31f5ccf00">00266</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#a09cb66dd061fa338ab2a85a31f5ccf00">getViewData</a>() { <span class="keywordflow">return</span> $this-&gt;_viewData; }
<a name="l00267"></a><a class="code" href="classCPSController.html#ade714d0b090e663e7acd6ef596d602ec">00267</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#ade714d0b090e663e7acd6ef596d602ec">setViewData</a>( $value ) { $this-&gt;_viewData = $value; }
<a name="l00268"></a>00268 
<a name="l00272"></a><a class="code" href="classCPSController.html#a7d16c40c2d533779317b383d69e59ea0">00272</a>     <span class="keyword">protected</span> <a class="code" href="classCPSController.html#a7d16c40c2d533779317b383d69e59ea0">$_extraViewDataList</a>;
<a name="l00273"></a><a class="code" href="classCPSController.html#a095ad5a2da0a46cf0c5225c826b7fe4c">00273</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#a095ad5a2da0a46cf0c5225c826b7fe4c">getExtraViewDataList</a>() { <span class="keywordflow">return</span> $this-&gt;_extraViewDataList; }
<a name="l00274"></a><a class="code" href="classCPSController.html#a537201d018053eaff662e290be1a8a81">00274</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#a537201d018053eaff662e290be1a8a81">setExtraViewDataList</a>( $value ) { $this-&gt;_extraViewDataList = $value; }
<a name="l00275"></a>00275 
<a name="l00279"></a><a class="code" href="classCPSController.html#a41793f2872b496a2d4effc0da5f82a3c">00279</a>     <span class="keyword">protected</span> <a class="code" href="classCPSController.html#a41793f2872b496a2d4effc0da5f82a3c">$_extraViewDataPrefix</a> = <span class="charliteral">&#39;_&#39;</span>;
<a name="l00280"></a><a class="code" href="classCPSController.html#a1f4c82d1446cb4a49f0da9bc76e5aa1e">00280</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#a1f4c82d1446cb4a49f0da9bc76e5aa1e">getExtraViewDataPrefix</a>() { <span class="keywordflow">return</span> $this-&gt;_extraViewDataPrefix; }
<a name="l00281"></a><a class="code" href="classCPSController.html#ae80dd653d6c5d9e7be65cd7ae3f05627">00281</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#ae80dd653d6c5d9e7be65cd7ae3f05627">setExtraViewDataPrefix</a>( $value ) { $this-&gt;_extraViewDataPrefix = $value; }
<a name="l00282"></a>00282 
<a name="l00283"></a>00283     <span class="comment">//********************************************************************************</span>
<a name="l00284"></a>00284     <span class="comment">//* Public Methods</span>
<a name="l00285"></a>00285     <span class="comment">//********************************************************************************</span>
<a name="l00286"></a>00286 
<a name="l00291"></a><a class="code" href="classCPSController.html#a4be4055f3361d4800e16bc2e2e38cda6">00291</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a4be4055f3361d4800e16bc2e2e38cda6">init</a>()
<a name="l00292"></a>00292     {
<a name="l00293"></a>00293         <span class="comment">//  Phone home...</span>
<a name="l00294"></a>00294         <a class="code" href="classCPSController.html#a4be4055f3361d4800e16bc2e2e38cda6">parent::init</a>();
<a name="l00295"></a>00295 
<a name="l00296"></a>00296         <span class="comment">//  Find layout...</span>
<a name="l00297"></a>00297         <span class="keywordflow">if</span> ( PHP_SAPI != <span class="stringliteral">&#39;cli&#39;</span> &amp;&amp; $this-&gt;m_bAutoLayout &amp;&amp; ! Yii::app() instanceof CConsoleApplication ) <span class="keywordflow">if</span> ( file_exists( Yii::app()-&gt;getBasePath() . <span class="stringliteral">&#39;/views/layouts/&#39;</span> . $this-&gt;getId() . <span class="stringliteral">&#39;.php&#39;</span> ) ) $this-&gt;_pageLayout = $this-&gt;getId();
<a name="l00298"></a>00298 
<a name="l00299"></a>00299         <span class="comment">//  Allow errors</span>
<a name="l00300"></a>00300         $this-&gt;<a class="code" href="classCPSController.html#a2f24158b505e68f422cbc0682e588e14">addUserAction</a>( self::ACCESS_TO_ANY, <span class="stringliteral">&#39;error&#39;</span> );
<a name="l00301"></a>00301 
<a name="l00302"></a>00302         <span class="comment">//  Pull any search criteria we&#39;ve stored...</span>
<a name="l00303"></a>00303         <span class="keywordflow">if</span> ( $this-&gt;<a class="code" href="classCPSController.html#a7cd2e13f50fbc61e846e5980f02371f8">getModelName</a>() ) $this-&gt;m_arCurrentSearchCriteria = Yii::app()-&gt;user-&gt;getState( $this-&gt;m_sSearchStateId );
<a name="l00304"></a>00304 
<a name="l00305"></a>00305         <span class="comment">//  Ensure conformity</span>
<a name="l00306"></a>00306         <span class="keywordflow">if</span> ( ! is_array( $this-&gt;_extraViewDataList ) )
<a name="l00307"></a>00307             $this-&gt;_extraViewDataList = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>();
<a name="l00308"></a>00308 
<a name="l00309"></a>00309         <span class="comment">//  Add &quot;currentUser&quot; value to extra view data</span>
<a name="l00310"></a>00310         <span class="keywordflow">if</span> ( null === PS::o( $this-&gt;_extraViewDataList, $this-&gt;_extraViewDataPrefix . <span class="stringliteral">&#39;currentUser&#39;</span> ) )
<a name="l00311"></a>00311             $this-&gt;_extraViewDataList[ $this-&gt;_extraViewDataPrefix . <span class="stringliteral">&#39;currentUser&#39;</span> ] = PS::_gcu();
<a name="l00312"></a>00312 
<a name="l00313"></a>00313         <span class="comment">//  And some defaults...</span>
<a name="l00314"></a>00314         $this-&gt;_cleanTrail = $this-&gt;_displayName;
<a name="l00315"></a>00315         $this-&gt;defaultAction = <span class="stringliteral">&#39;index&#39;</span>;
<a name="l00316"></a>00316     }
<a name="l00317"></a>00317 
<a name="l00347"></a><a class="code" href="classCPSController.html#ae353790f09e1f72e1cc81d21a6eb9bed">00347</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#ae353790f09e1f72e1cc81d21a6eb9bed">actions</a>()
<a name="l00348"></a>00348     {
<a name="l00349"></a>00349         <span class="keywordflow">return</span> array_merge(
<a name="l00350"></a>00350             <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(
<a name="l00351"></a>00351                 <span class="stringliteral">&#39;_static&#39;</span> =&gt; <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(
<a name="l00352"></a>00352                     <span class="stringliteral">&#39;class&#39;</span> =&gt; <span class="stringliteral">&#39;CViewAction&#39;</span>,
<a name="l00353"></a>00353                     <span class="stringliteral">&#39;basePath&#39;</span> =&gt; <span class="stringliteral">&#39;_static&#39;</span>,
<a name="l00354"></a>00354                 ),
<a name="l00355"></a>00355             ),
<a name="l00356"></a>00356             parent::actions()
<a name="l00357"></a>00357         );
<a name="l00358"></a>00358     }
<a name="l00359"></a>00359 
<a name="l00368"></a><a class="code" href="classCPSController.html#a5d552693681c1d3c932a6ae5fbb56ac5">00368</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a5d552693681c1d3c932a6ae5fbb56ac5">genericAction</a>( $sActionId, $oModel = null, $arExtraParams = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(), $sModelVarName = <span class="stringliteral">&#39;model&#39;</span>, $sFlashKey = null, $sFlashValue = null, $sFlashDefaultValue = null )
<a name="l00369"></a>00369     {
<a name="l00370"></a>00370         <span class="keywordflow">if</span> ( $sFlashKey ) Yii::app()-&gt;user-&gt;setFlash( $sFlashKey, $sFlashValue, $sFlashDefaultValue );
<a name="l00371"></a>00371         $this-&gt;render( $sActionId, array_merge( $arExtraParams, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( $sModelVarName =&gt; ( $oModel ) ? $oModel : $this-&gt;<a class="code" href="classCPSController.html#a746b3a617d7e9d1c0012aa471cf25325">loadModel</a>() ) ) );
<a name="l00372"></a>00372     }
<a name="l00373"></a>00373 
<a name="l00381"></a><a class="code" href="classCPSController.html#a746b3a617d7e9d1c0012aa471cf25325">00381</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a746b3a617d7e9d1c0012aa471cf25325">loadModel</a>( $iId = null )
<a name="l00382"></a>00382     {
<a name="l00383"></a>00383         <span class="keywordflow">if</span> ( null === $this-&gt;m_oModel )
<a name="l00384"></a>00384         {
<a name="l00385"></a>00385             $_iId = PS::o( $_GET, <span class="stringliteral">&#39;id&#39;</span>, $iId );
<a name="l00386"></a>00386             $this-&gt;m_oModel = $this-&gt;<a class="code" href="classCPSController.html#affcc785cc14ed277532e5462fcb0463c">load</a>( $_iId );
<a name="l00387"></a>00387 
<a name="l00388"></a>00388             <span class="comment">//  No data? bug out</span>
<a name="l00389"></a>00389             <span class="keywordflow">if</span> ( null === $this-&gt;m_oModel ) $this-&gt;redirect( <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( $this-&gt;defaultAction ) );
<a name="l00390"></a>00390 
<a name="l00391"></a>00391             <span class="comment">//  Get the name of this model...</span>
<a name="l00392"></a>00392             $this-&gt;<a class="code" href="classCPSController.html#a176dfa82642f33d337898c51f4bcd01e">setModelName</a>( get_class( $this-&gt;m_oModel ) );
<a name="l00393"></a>00393         }
<a name="l00394"></a>00394 
<a name="l00395"></a>00395         <span class="comment">//  Return our model...</span>
<a name="l00396"></a>00396         <span class="keywordflow">return</span> $this-&gt;m_oModel;
<a name="l00397"></a>00397     }
<a name="l00398"></a>00398 
<a name="l00405"></a><a class="code" href="classCPSController.html#a21b71f8b9833d55edd503961ac3f4280">00405</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a21b71f8b9833d55edd503961ac3f4280">missingAction</a>( $sActionId = null )
<a name="l00406"></a>00406     {
<a name="l00407"></a>00407         <span class="keywordflow">if</span> ( $this-&gt;m_bAutoMissing )
<a name="l00408"></a>00408         {
<a name="l00409"></a>00409             <span class="keywordflow">if</span> ( empty( $sActionId ) ) $sActionId = $this-&gt;defaultAction;
<a name="l00410"></a>00410 
<a name="l00411"></a>00411             <span class="keywordflow">if</span> ( $this-&gt;getViewFile( $sActionId ) )
<a name="l00412"></a>00412             {
<a name="l00413"></a>00413                 $this-&gt;render( $sActionId );
<a name="l00414"></a>00414                 <span class="keywordflow">return</span>;
<a name="l00415"></a>00415             }
<a name="l00416"></a>00416         }
<a name="l00417"></a>00417 
<a name="l00418"></a>00418         <a class="code" href="classCPSController.html#a21b71f8b9833d55edd503961ac3f4280">parent::missingAction</a>( $sActionId );
<a name="l00419"></a>00419     }
<a name="l00420"></a>00420 
<a name="l00425"></a><a class="code" href="classCPSController.html#a8471fa2c95307d608c34f15dae47d254">00425</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a8471fa2c95307d608c34f15dae47d254">actionError</a>()
<a name="l00426"></a>00426     {
<a name="l00427"></a>00427         <span class="keywordflow">if</span> ( ! $_arError = Yii::app()-&gt;errorHandler-&gt;error )
<a name="l00428"></a>00428         {
<a name="l00429"></a>00429             <span class="keywordflow">if</span> ( $this-&gt;isAjaxRequest )
<a name="l00430"></a>00430                 echo $_arError[<span class="stringliteral">&#39;message&#39;</span>];
<a name="l00431"></a>00431             <span class="keywordflow">else</span>
<a name="l00432"></a>00432                 <span class="keywordflow">throw</span> <span class="keyword">new</span> CHttpException( 404, <span class="stringliteral">&#39;Page not found.&#39;</span> );
<a name="l00433"></a>00433         }
<a name="l00434"></a>00434 
<a name="l00435"></a>00435         $this-&gt;render( <span class="stringliteral">&#39;error&#39;</span>, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( <span class="stringliteral">&#39;error&#39;</span> =&gt; $_arError ) );
<a name="l00436"></a>00436     }
<a name="l00437"></a>00437 
<a name="l00442"></a><a class="code" href="classCPSController.html#adf1a35ad20e475c59cc0967d5764aa22">00442</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#adf1a35ad20e475c59cc0967d5764aa22">getRequest</a>()
<a name="l00443"></a>00443     {
<a name="l00444"></a>00444         <span class="keywordflow">return</span> Yii::app()-&gt;getRequest();
<a name="l00445"></a>00445     }
<a name="l00446"></a>00446 
<a name="l00452"></a><a class="code" href="classCPSController.html#a17b3b891c90dd35778e9596ce304ddd1">00452</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a17b3b891c90dd35778e9596ce304ddd1">beforeAction</a>( $oAction )
<a name="l00453"></a>00453     {
<a name="l00454"></a>00454         <span class="comment">//  If we have commands, give it a shot...</span>
<a name="l00455"></a>00455         <span class="keywordflow">if</span> ( count( $this-&gt;m_arCommandMap ) &amp;&amp; parent::beforeAction( $oAction ) )
<a name="l00456"></a>00456             $this-&gt;<a class="code" href="classCPSController.html#ae4991b44dadced9ed4c2548c8a52b72e">processCommand</a>();
<a name="l00457"></a>00457 
<a name="l00458"></a>00458         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00459"></a>00459     }
<a name="l00460"></a>00460 
<a name="l00481"></a><a class="code" href="classCPSController.html#acaf53d84b70927098a40b8e626985146">00481</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#acaf53d84b70927098a40b8e626985146">newRender</a>( $viewName, $viewData = null, $returnString = <span class="keyword">false</span> )
<a name="l00482"></a>00482     {
<a name="l00483"></a>00483         <span class="comment">//  make sure we&#39;re all on the same page...</span>
<a name="l00484"></a>00484         $this-&gt;_pageLayout = $this-&gt;layout;
<a name="l00485"></a>00485 
<a name="l00486"></a>00486         $_output = $this-&gt;<a class="code" href="classCPSController.html#a8324b095d3faa196d784f84a3f0cef25">renderPartial</a>( $viewName, $viewData, <span class="keyword">true</span> );
<a name="l00487"></a>00487 
<a name="l00488"></a>00488         <span class="keywordflow">if</span> ( $this-&gt;_pageLayout &amp;&amp; <span class="keyword">false</span> !== ( $_layoutFile = $this-&gt;getLayoutFile( $this-&gt;_pageLayout ) ) )
<a name="l00489"></a>00489         {
<a name="l00490"></a>00490             <span class="comment">//  Process content layout if required</span>
<a name="l00491"></a>00491             <span class="keywordflow">if</span> ( $this-&gt;_contentLayout &amp;&amp; <span class="keyword">false</span> !== ( $_contentLayoutFile = $this-&gt;getLayoutFile( $this-&gt;_contentLayout ) ) )
<a name="l00492"></a>00492                 $_output = $this-&gt;<a class="code" href="classCPSController.html#a8324b095d3faa196d784f84a3f0cef25">renderPartial</a>( $_contentLayoutFile, $viewData, <span class="keyword">true</span> );
<a name="l00493"></a>00493 
<a name="l00494"></a>00494             $_output = $this-&gt;renderFile( $_layoutFile, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( <span class="stringliteral">&#39;content&#39;</span> =&gt; $_output ), <span class="keyword">true</span> );
<a name="l00495"></a>00495             $_output = $this-&gt;processOutput( $_output );
<a name="l00496"></a>00496         }
<a name="l00497"></a>00497 
<a name="l00498"></a>00498         <span class="keywordflow">if</span> ( $returnString )
<a name="l00499"></a>00499             <span class="keywordflow">return</span> $_output;
<a name="l00500"></a>00500 
<a name="l00501"></a>00501         echo $_output;
<a name="l00502"></a>00502     }
<a name="l00503"></a>00503 
<a name="l00528"></a><a class="code" href="classCPSController.html#a8324b095d3faa196d784f84a3f0cef25">00528</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a8324b095d3faa196d784f84a3f0cef25">renderPartial</a>( $view, $data = null, $return = <span class="keyword">false</span>, $processOutput = <span class="keyword">false</span> )
<a name="l00529"></a>00529     {
<a name="l00530"></a>00530         <span class="keywordflow">if</span> ( <span class="keyword">false</span> === ( $_viewFile = $this-&gt;getViewFile( $view ) ) )
<a name="l00531"></a>00531         {
<a name="l00532"></a>00532             <span class="keywordflow">throw</span> <span class="keyword">new</span> CException(
<a name="l00533"></a>00533                 Yii::t(
<a name="l00534"></a>00534                     <span class="stringliteral">&#39;yii&#39;</span>,
<a name="l00535"></a>00535                     <span class="stringliteral">&#39;{controller} cannot find the requested view &quot;{view}&quot;.&#39;</span>,
<a name="l00536"></a>00536                     <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(
<a name="l00537"></a>00537                         <span class="stringliteral">&#39;{controller}&#39;</span> =&gt; get_class( $this ),
<a name="l00538"></a>00538                         <span class="stringliteral">&#39;{view}&#39;</span> =&gt; $view
<a name="l00539"></a>00539                     )
<a name="l00540"></a>00540                 )
<a name="l00541"></a>00541             );
<a name="l00542"></a>00542         }
<a name="l00543"></a>00543         
<a name="l00544"></a>00544         <span class="keywordflow">if</span> ( null === $data )
<a name="l00545"></a>00545             $data = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>();
<a name="l00546"></a>00546 
<a name="l00547"></a>00547         $_output = $this-&gt;renderFile( 
<a name="l00548"></a>00548             $_viewFile, 
<a name="l00549"></a>00549             array_merge( 
<a name="l00550"></a>00550                 $this-&gt;_extraViewDataList, 
<a name="l00551"></a>00551                 $this-&gt;_viewData, 
<a name="l00552"></a>00552                 $data 
<a name="l00553"></a>00553             ), 
<a name="l00554"></a>00554             <span class="keyword">true</span> 
<a name="l00555"></a>00555         );
<a name="l00556"></a>00556 
<a name="l00557"></a>00557         <span class="keywordflow">if</span> ( $processOutput )
<a name="l00558"></a>00558             $_output = $this-&gt;processOutput( $_output );
<a name="l00559"></a>00559 
<a name="l00560"></a>00560         <span class="keywordflow">if</span> ( $return )
<a name="l00561"></a>00561             <span class="keywordflow">return</span> $_output;
<a name="l00562"></a>00562 
<a name="l00563"></a>00563         echo $_output;
<a name="l00564"></a>00564     }
<a name="l00565"></a>00565 
<a name="l00572"></a><a class="code" href="classCPSController.html#ae926a613a7702bb749e974f35a462d60">00572</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#ae926a613a7702bb749e974f35a462d60">setStandardFormOptions</a>( $model, $optionList = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() )
<a name="l00573"></a>00573     {
<a name="l00574"></a>00574         <span class="comment">//  Shortcut... only passed in the title...</span>
<a name="l00575"></a>00575         <span class="keywordflow">if</span> ( is_string( $optionList ) )
<a name="l00576"></a>00576         {
<a name="l00577"></a>00577             $_title = $optionList;
<a name="l00578"></a>00578 
<a name="l00579"></a>00579             $optionList = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(
<a name="l00580"></a>00580                 <span class="stringliteral">&#39;title&#39;</span> =&gt; PS::_gan() . <span class="stringliteral">&#39; :: &#39;</span> . $_title,
<a name="l00581"></a>00581                 <span class="stringliteral">&#39;breadcrumbs&#39;</span> =&gt; <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( $_title ),
<a name="l00582"></a>00582             );
<a name="l00583"></a>00583         }
<a name="l00584"></a>00584 
<a name="l00585"></a>00585         <span class="comment">//  Abbreviated arguments?</span>
<a name="l00586"></a>00586         <span class="keywordflow">if</span> ( is_array( $model ) &amp;&amp; <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() === $optionList )
<a name="l00587"></a>00587         {
<a name="l00588"></a>00588             $optionList = $model;
<a name="l00589"></a>00589             $model = PS::o( $optionList, <span class="stringliteral">&#39;model&#39;</span> );
<a name="l00590"></a>00590         }
<a name="l00591"></a>00591 
<a name="l00592"></a>00592         <span class="comment">//  Set the standard nav options</span>
<a name="l00593"></a>00593         $this-&gt;<a class="code" href="classCPSController.html#a592bdbc48efc56a00e5b49582db7c09f">setViewNavigationOptions</a>( $optionList );
<a name="l00594"></a>00594 
<a name="l00595"></a>00595         $_formId = PS::o( $optionList, <span class="stringliteral">&#39;id&#39;</span>, <span class="stringliteral">&#39;ps-edit-form&#39;</span> );
<a name="l00596"></a>00596 
<a name="l00597"></a>00597         <span class="comment">//  Put a cool flash span on the page</span>
<a name="l00598"></a>00598         <span class="keywordflow">if</span> ( PS::o( $options, <span class="stringliteral">&#39;enableFlash&#39;</span>, <span class="keyword">true</span>, <span class="keyword">true</span> ) )
<a name="l00599"></a>00599         {
<a name="l00600"></a>00600             $_flashClass = PS::o( $options, <span class="stringliteral">&#39;flashSuccessClass&#39;</span>, <span class="stringliteral">&#39;operation-result-success&#39;</span> );
<a name="l00601"></a>00601             
<a name="l00602"></a>00602             <span class="keywordflow">if</span> ( null === ( $_message = PS::_gf( <span class="stringliteral">&#39;success&#39;</span> ) ) )
<a name="l00603"></a>00603             {
<a name="l00604"></a>00604                 <span class="keywordflow">if</span> ( null !== ( $_message = PS::_gf( <span class="stringliteral">&#39;failure&#39;</span> ) ) )
<a name="l00605"></a>00605                     $_flashClass = PS::o( $options, <span class="stringliteral">&#39;flashFailureClass&#39;</span>, <span class="stringliteral">&#39;operation-result-failure&#39;</span> );
<a name="l00606"></a>00606             }
<a name="l00607"></a>00607 
<a name="l00608"></a>00608             $_spanId = PS::o( $options, <span class="stringliteral">&#39;flashSpanId&#39;</span>, <span class="stringliteral">&#39;operation-result&#39;</span>, <span class="keyword">true</span> );
<a name="l00609"></a>00609             PS::_ss( <span class="stringliteral">&#39;psForm-flash-html&#39;</span>, PS::tag( <span class="stringliteral">&#39;span&#39;</span>, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( <span class="stringliteral">&#39;id&#39;</span> =&gt; $_spanId, <span class="stringliteral">&#39;class&#39;</span> =&gt; $_flashClass ), $_message ) );
<a name="l00610"></a>00610             
<a name="l00611"></a>00611             <span class="comment">//  Register a nice little fader...</span>
<a name="l00612"></a>00612             $_fader =&lt;&lt;&lt;SCRIPT
<a name="l00613"></a>00613 $(<span class="stringliteral">&#39;#{$_spanId}&#39;</span>).fadeIn(<span class="stringliteral">&#39;500&#39;</span>,function(){
<a name="l00614"></a>00614     $(<span class="keyword">this</span>).delay(3000).fadeOut(3500);
<a name="l00615"></a>00615 });
<a name="l00616"></a>00616 SCRIPT;
<a name="l00617"></a>00617                 
<a name="l00618"></a>00618             PS::_rs( $_formId . <span class="charliteral">&#39;.&#39;</span> . $_spanId . <span class="stringliteral">&#39;.fader&#39;</span>, $_fader, CClientScript::POS_READY );
<a name="l00619"></a>00619         }
<a name="l00620"></a>00620         
<a name="l00621"></a>00621         PS::setFormFieldContainerClass( PS::o( $optionList, <span class="stringliteral">&#39;rowClass&#39;</span>, <span class="stringliteral">&#39;row&#39;</span> ) );
<a name="l00622"></a>00622 
<a name="l00623"></a>00623         $_formOptions = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(
<a name="l00624"></a>00624             <span class="stringliteral">&#39;id&#39;</span> =&gt; $_formId,
<a name="l00625"></a>00625             <span class="stringliteral">&#39;showLegend&#39;</span> =&gt; PS::o( $optionList, <span class="stringliteral">&#39;showLegend&#39;</span>, <span class="keyword">true</span> ),
<a name="l00626"></a>00626             <span class="stringliteral">&#39;showDates&#39;</span> =&gt; PS::o( $optionList, <span class="stringliteral">&#39;showDates&#39;</span>, <span class="keyword">false</span> ),
<a name="l00627"></a>00627             <span class="stringliteral">&#39;method&#39;</span> =&gt; PS::o( $optionList, <span class="stringliteral">&#39;method&#39;</span>, <span class="stringliteral">&#39;POST&#39;</span> ),
<a name="l00628"></a>00628 
<a name="l00629"></a>00629             <span class="stringliteral">&#39;uiStyle&#39;</span> =&gt; PS::o( $optionList, <span class="stringliteral">&#39;uiStyle&#39;</span>, PS::UI_JQUERY ),
<a name="l00630"></a>00630             <span class="stringliteral">&#39;formClass&#39;</span> =&gt; PS::o( $optionList, <span class="stringliteral">&#39;formClass&#39;</span>, <span class="stringliteral">&#39;form&#39;</span> ),
<a name="l00631"></a>00631             <span class="stringliteral">&#39;formModel&#39;</span> =&gt; $model,
<a name="l00632"></a>00632             <span class="stringliteral">&#39;errorCss&#39;</span> =&gt; PS::o( $optionList, <span class="stringliteral">&#39;errorCss&#39;</span>, <span class="stringliteral">&#39;error&#39;</span> ),
<a name="l00633"></a>00633 
<a name="l00634"></a>00634             <span class="comment">//  We want error summary...</span>
<a name="l00635"></a>00635             <span class="stringliteral">&#39;errorSummary&#39;</span> =&gt; PS::o( $optionList, <span class="stringliteral">&#39;errorSummary&#39;</span>, <span class="keyword">true</span> ),
<a name="l00636"></a>00636             <span class="stringliteral">&#39;errorSummaryOptions&#39;</span> =&gt; <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(
<a name="l00637"></a>00637                 <span class="stringliteral">&#39;header&#39;</span> =&gt; <span class="stringliteral">&#39;&lt;p&gt;The following problems occurred:&lt;/p&gt;&#39;</span>,
<a name="l00638"></a>00638             ),
<a name="l00639"></a>00639 
<a name="l00640"></a>00640             <span class="stringliteral">&#39;validate&#39;</span> =&gt; PS::o( $optionList, <span class="stringliteral">&#39;validate&#39;</span>, <span class="keyword">true</span> ),
<a name="l00641"></a>00641 
<a name="l00642"></a>00642             <span class="stringliteral">&#39;validateOptions&#39;</span> =&gt; PS::o( $optionList, <span class="stringliteral">&#39;validateOptions&#39;</span>,
<a name="l00643"></a>00643                 <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(
<a name="l00644"></a>00644                     <span class="stringliteral">&#39;ignoreTitle&#39;</span> =&gt; <span class="keyword">true</span>,
<a name="l00645"></a>00645                     <span class="stringliteral">&#39;errorClass&#39;</span> =&gt; <span class="stringliteral">&#39;ps-validate-error&#39;</span>,
<a name="l00646"></a>00646                 )
<a name="l00647"></a>00647             ),
<a name="l00648"></a>00648         );
<a name="l00649"></a>00649 
<a name="l00650"></a>00650         <span class="comment">//  Do some auto-page-setup...</span>
<a name="l00651"></a>00651         <span class="keywordflow">if</span> ( null !== ( $_header = PS::o( $optionList, <span class="stringliteral">&#39;header&#39;</span>, PS::o( $optionList, <span class="stringliteral">&#39;title&#39;</span> ) ) ) )
<a name="l00652"></a>00652         {
<a name="l00653"></a>00653             <span class="keywordflow">if</span> ( null !== ( $_headerIcon = PS::o( $optionList, <span class="stringliteral">&#39;headerIcon&#39;</span> ) ) )
<a name="l00654"></a>00654                 $_header = PS::tag( <span class="stringliteral">&#39;span&#39;</span>, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(), PS::image( $_headerIcon ) ) . $_header;
<a name="l00655"></a>00655 
<a name="l00656"></a>00656             echo PS::tag( <span class="stringliteral">&#39;h1&#39;</span>, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( <span class="stringliteral">&#39;class&#39;</span> =&gt; <span class="stringliteral">&#39;ui-generated-header&#39;</span> ), $_header );
<a name="l00657"></a>00657         }
<a name="l00658"></a>00658 
<a name="l00659"></a>00659         <span class="comment">//  Do some auto-page-setup...</span>
<a name="l00660"></a>00660         <span class="keywordflow">if</span> ( null !== ( $_subHeader = PS::o( $optionList, <span class="stringliteral">&#39;subHeader&#39;</span> ) ) )
<a name="l00661"></a>00661             echo PS::tag( <span class="stringliteral">&#39;div&#39;</span>, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(), $_subHeader );
<a name="l00662"></a>00662 
<a name="l00663"></a>00663         <span class="keywordflow">if</span> ( <span class="keyword">false</span> !== PS::o( $optionList, <span class="stringliteral">&#39;renderSearch&#39;</span>, <span class="keyword">false</span> ) )
<a name="l00664"></a>00664         {
<a name="l00665"></a>00665             echo PS::tag( <span class="charliteral">&#39;p&#39;</span>, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(), self::SEARCH_HELP_TEXT );
<a name="l00666"></a>00666             echo PS::link( <span class="stringliteral">&#39;Advanced Search&#39;</span>, <span class="charliteral">&#39;#&#39;</span>, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( <span class="stringliteral">&#39;class&#39;</span> =&gt; <span class="stringliteral">&#39;search-button&#39;</span> ) );
<a name="l00667"></a>00667 
<a name="l00668"></a>00668             echo PS::tag( 
<a name="l00669"></a>00669                 <span class="stringliteral">&#39;div&#39;</span>, 
<a name="l00670"></a>00670                 <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( <span class="stringliteral">&#39;class&#39;</span> =&gt; <span class="stringliteral">&#39;search-form&#39;</span> ), 
<a name="l00671"></a>00671                 $this-&gt;<a class="code" href="classCPSController.html#a8324b095d3faa196d784f84a3f0cef25">renderPartial</a>( <span class="stringliteral">&#39;_search&#39;</span>, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( <span class="stringliteral">&#39;model&#39;</span> =&gt; $model ), <span class="keyword">true</span> )
<a name="l00672"></a>00672             );
<a name="l00673"></a>00673             
<a name="l00674"></a>00674             <span class="comment">//  Register the search script, if any</span>
<a name="l00675"></a>00675             <span class="keywordflow">if</span> ( null !== ( $_searchScript = PS::o( $optionList, <span class="stringliteral">&#39;__searchScript&#39;</span> ) ) )
<a name="l00676"></a>00676                 PS::_rs( <span class="stringliteral">&#39;search&#39;</span>, $_searchScript );
<a name="l00677"></a>00677         }
<a name="l00678"></a>00678 
<a name="l00679"></a>00679         <span class="keywordflow">if</span> ( PS::UI_JQUERY == ( $_uiStyle = PS::o( $optionList, <span class="stringliteral">&#39;uiStyle&#39;</span>, PS::UI_JQUERY ) ) )
<a name="l00680"></a>00680             <a class="code" href="classCPSjqUIWrapper.html#ac23dbff4185dd0a77d381116a054bb50">CPSjqUIWrapper::loadScripts</a>();
<a name="l00681"></a>00681 
<a name="l00682"></a>00682         <span class="keywordflow">return</span> $_formOptions;
<a name="l00683"></a>00683     }
<a name="l00684"></a>00684 
<a name="l00690"></a><a class="code" href="classCPSController.html#a136cf4fecb17df00146f6889ffdbccee">00690</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a136cf4fecb17df00146f6889ffdbccee">setContentType</a>( $contentType, $noLayout = <span class="keyword">true</span> )
<a name="l00691"></a>00691     {
<a name="l00692"></a>00692         <span class="keywordflow">if</span> ( $noLayout ) $this-&gt;layout = <span class="keyword">false</span>;
<a name="l00693"></a>00693         header( <span class="stringliteral">&#39;Content-Type: &#39;</span> . $contentType );
<a name="l00694"></a>00694     }
<a name="l00695"></a>00695 
<a name="l00700"></a><a class="code" href="classCPSController.html#a592bdbc48efc56a00e5b49582db7c09f">00700</a>     <span class="keyword">public</span> function <a class="code" href="classCPSController.html#a592bdbc48efc56a00e5b49582db7c09f">setViewNavigationOptions</a>( &amp;$options = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() )
<a name="l00701"></a>00701     {
<a name="l00702"></a>00702         <span class="comment">//  Page title</span>
<a name="l00703"></a>00703         $_title = PS::o( $options, <span class="stringliteral">&#39;title&#39;</span>, null, <span class="keyword">true</span> );
<a name="l00704"></a>00704         $_subtitle = PS::o( $options, <span class="stringliteral">&#39;subtitle&#39;</span>, null, <span class="keyword">true</span> );
<a name="l00705"></a>00705         $_header = PS::o( $options, <span class="stringliteral">&#39;header&#39;</span> );
<a name="l00706"></a>00706         
<a name="l00707"></a>00707         <span class="comment">//  Generate subtitle from header...</span>
<a name="l00708"></a>00708         <span class="keywordflow">if</span> ( null === $_title &amp;&amp; null === $_subtitle &amp;&amp; null !== $_header )
<a name="l00709"></a>00709             $_subtitle = $_header;
<a name="l00710"></a>00710 
<a name="l00711"></a>00711         <span class="keywordflow">if</span> ( $_subtitle )
<a name="l00712"></a>00712             $_title = PS::_gan() . <span class="stringliteral">&#39; :: &#39;</span> . $_subtitle;
<a name="l00713"></a>00713 
<a name="l00714"></a>00714         <span class="keywordflow">if</span> ( ! $_title )
<a name="l00715"></a>00715             $_title =  PS::_gan();
<a name="l00716"></a>00716 
<a name="l00717"></a>00717         $this-&gt;setPageTitle( $options[<span class="stringliteral">&#39;title&#39;</span>] = $_title );
<a name="l00718"></a>00718 
<a name="l00719"></a>00719         <span class="comment">//  Set crumbs</span>
<a name="l00720"></a>00720         $this-&gt;_breadcrumbs = PS::o( $options, <span class="stringliteral">&#39;breadcrumbs&#39;</span> );
<a name="l00721"></a>00721 
<a name="l00722"></a>00722         <span class="comment">//  Let side menu be set from here as well...</span>
<a name="l00723"></a>00723         <span class="keywordflow">if</span> ( null !== ( $_menuItems = PS::o( $options, <span class="stringliteral">&#39;menu&#39;</span>, null ) ) )
<a name="l00724"></a>00724         {
<a name="l00725"></a>00725             <span class="comment">//  Rebuild menu items if not in standard format</span>
<a name="l00726"></a>00726             $_finalMenu = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>();
<a name="l00727"></a>00727 
<a name="l00728"></a>00728             <span class="keywordflow">foreach</span> ( $_menuItems as $_itemLabel =&gt; $_itemLink )
<a name="l00729"></a>00729             {
<a name="l00730"></a>00730                 <span class="keywordflow">if</span> ( null === ( $_label = PS::o( $_itemLink, <span class="stringliteral">&#39;label&#39;</span>, null, <span class="keyword">true</span> ) ) )
<a name="l00731"></a>00731                     $_label = $_itemLabel;
<a name="l00732"></a>00732                 
<a name="l00733"></a>00733                 <span class="keywordflow">if</span> ( null === ( $_link = PS::o( $_itemLink, <span class="stringliteral">&#39;link&#39;</span>, null, <span class="keyword">true</span> ) ) )
<a name="l00734"></a>00734                     $_link = $_itemLink;
<a name="l00735"></a>00735                 
<a name="l00736"></a>00736                 $_finalMenu[] = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(
<a name="l00737"></a>00737                     <span class="stringliteral">&#39;label&#39;</span> =&gt; $_label,
<a name="l00738"></a>00738                     <span class="stringliteral">&#39;url&#39;</span> =&gt; $_link,
<a name="l00739"></a>00739                 );
<a name="l00740"></a>00740             }
<a name="l00741"></a>00741 
<a name="l00742"></a>00742             $options[<span class="stringliteral">&#39;menu&#39;</span>] = $this-&gt;_menu = $_finalMenu;
<a name="l00743"></a>00743         }
<a name="l00744"></a>00744 
<a name="l00745"></a>00745         $_enableSearch = ( PS::o( $options, <span class="stringliteral">&#39;enableSearch&#39;</span>, <span class="keyword">false</span> ) || PS::o( $options, <span class="stringliteral">&#39;renderSearch&#39;</span>, <span class="keyword">false</span> ) );
<a name="l00746"></a>00746 
<a name="l00747"></a>00747         <span class="comment">//  Drop the search script on the page if enabled...</span>
<a name="l00748"></a>00748         <span class="keywordflow">if</span> ( <span class="keyword">false</span> !== $_enableSearch )
<a name="l00749"></a>00749         {
<a name="l00750"></a>00750             $_searchSelector = PS::o( $options, <span class="stringliteral">&#39;searchSelector&#39;</span>, <span class="stringliteral">&#39;.search-button&#39;</span> );
<a name="l00751"></a>00751             $_toggleSpeed = PS::o( $options, <span class="stringliteral">&#39;toggleSpeed&#39;</span>, <span class="stringliteral">&#39;fast&#39;</span> );
<a name="l00752"></a>00752             $_searchForm = PS::o( $options, <span class="stringliteral">&#39;searchForm&#39;</span>, <span class="stringliteral">&#39;.search-form&#39;</span> );
<a name="l00753"></a>00753             $_targetFormId = PS::o( $options, <span class="stringliteral">&#39;id&#39;</span>, <span class="stringliteral">&#39;ps-edit-form&#39;</span> );
<a name="l00754"></a>00754 
<a name="l00755"></a>00755             $_searchScript =&lt;&lt;&lt;JS
<a name="l00756"></a>00756 $(function(){
<a name="l00757"></a>00757     $(<span class="stringliteral">&#39;{$_searchSelector}&#39;</span>).click(function(){
<a name="l00758"></a>00758         $(<span class="stringliteral">&#39;{$_searchForm}&#39;</span>).slideToggle(<span class="stringliteral">&#39;{$_toggleSpeed}&#39;</span>);
<a name="l00759"></a>00759         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00760"></a>00760     });
<a name="l00761"></a>00761 
<a name="l00762"></a>00762     $(<span class="stringliteral">&#39;{$_searchForm} form&#39;</span>).submit(function(){
<a name="l00763"></a>00763         $.fn.yiiGridView.update(<span class="stringliteral">&#39;{$_targetFormId}&#39;</span>, {
<a name="l00764"></a>00764             data: $(<span class="keyword">this</span>).serialize()
<a name="l00765"></a>00765         });
<a name="l00766"></a>00766         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00767"></a>00767     });
<a name="l00768"></a>00768 });
<a name="l00769"></a>00769 JS;
<a name="l00770"></a>00770             $options[<span class="stringliteral">&#39;__searchScript&#39;</span>] = $_searchScript;
<a name="l00771"></a>00771         }
<a name="l00772"></a>00772         
<a name="l00773"></a>00773         <span class="comment">//  Return reconstructed options for standard form use</span>
<a name="l00774"></a>00774         <span class="keywordflow">return</span> $options;
<a name="l00775"></a>00775     }
<a name="l00776"></a>00776 
<a name="l00777"></a>00777     <span class="comment">//********************************************************************************</span>
<a name="l00778"></a>00778     <span class="comment">//* Private Methods</span>
<a name="l00779"></a>00779     <span class="comment">//********************************************************************************</span>
<a name="l00780"></a>00780 
<a name="l00787"></a><a class="code" href="classCPSController.html#ae4991b44dadced9ed4c2548c8a52b72e">00787</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#ae4991b44dadced9ed4c2548c8a52b72e">processCommand</a>( $arData = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(), $sIndexName = self::COMMAND_FIELD_NAME )
<a name="l00788"></a>00788     {
<a name="l00789"></a>00789         <span class="comment">//  Our return variable</span>
<a name="l00790"></a>00790         $_oResults = null;
<a name="l00791"></a>00791 
<a name="l00792"></a>00792         <span class="comment">//  Get command&#39;s method...</span>
<a name="l00793"></a>00793         $_sCmd = PS::o( $_REQUEST, $sIndexName );
<a name="l00794"></a>00794 
<a name="l00795"></a>00795         <span class="comment">//  Do we have a command mapping?</span>
<a name="l00796"></a>00796         <span class="keywordflow">if</span> ( null !== ( $_arCmd = PS::o( $this-&gt;m_arCommandMap, $_sCmd ) ) )
<a name="l00797"></a>00797         {
<a name="l00798"></a>00798             <span class="comment">//  Get any miscellaneous data into the appropriate array</span>
<a name="l00799"></a>00799             <span class="keywordflow">if</span> ( count( $arData ) )
<a name="l00800"></a>00800             {
<a name="l00801"></a>00801                 <span class="keywordflow">if</span> ( $this-&gt;<a class="code" href="classCPSController.html#acea2c7c705d91ba736a41e67314e5ae3">getIsPostRequest</a>() )
<a name="l00802"></a>00802                     $_POST = array_merge( $_POST, $arData );
<a name="l00803"></a>00803                 <span class="keywordflow">else</span>
<a name="l00804"></a>00804                     $_GET = array_merge( $_GET, $arData );
<a name="l00805"></a>00805             }
<a name="l00806"></a>00806 
<a name="l00807"></a>00807             $_oResults = call_user_func( $_arCmd[1] );
<a name="l00808"></a>00808         }
<a name="l00809"></a>00809 
<a name="l00810"></a>00810         <span class="comment">//  Return the results</span>
<a name="l00811"></a>00811         <span class="keywordflow">return</span> $_oResults;
<a name="l00812"></a>00812     }
<a name="l00813"></a>00813 
<a name="l00826"></a><a class="code" href="classCPSController.html#a2c9d1571a7e74596a369bfe9601b25fc">00826</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#a2c9d1571a7e74596a369bfe9601b25fc">saveModel</a>( &amp;$oModel, $arData = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(), $sRedirectAction = <span class="stringliteral">&#39;show&#39;</span>, $bAttributesSet = <span class="keyword">false</span>, $sModelName = null, $sSuccessMessage = null, $bNoCommit = <span class="keyword">false</span>, $bSafeOnly = <span class="keyword">false</span> )
<a name="l00827"></a>00827     {
<a name="l00828"></a>00828         $_sMessage = PS::nvl( $sSuccessMessage, <span class="stringliteral">&#39;Your changes have been saved.&#39;</span> );
<a name="l00829"></a>00829         $_sModelName = PS::nvl( $sModelName, PS::nvl( $oModel-&gt;getModelClass(), $this-&gt;m_sModelName ) );
<a name="l00830"></a>00830 
<a name="l00831"></a>00831         <span class="keywordflow">if</span> ( isset( $arData, $arData[ $_sModelName ] ) )
<a name="l00832"></a>00832         {
<a name="l00833"></a>00833             <span class="keywordflow">if</span> ( ! $bAttributesSet ) $oModel-&gt;setAttributes( $arData[ $_sModelName ], $bSafeOnly );
<a name="l00834"></a>00834 
<a name="l00835"></a>00835             <span class="keywordflow">if</span> ( $oModel-&gt;save() )
<a name="l00836"></a>00836             {
<a name="l00837"></a>00837                 <span class="keywordflow">if</span> ( ! $bNoCommit &amp;&amp; $oModel instanceof <a class="code" href="classCPSModel.html">CPSModel</a> &amp;&amp; $oModel-&gt;hasTransaction() ) $oModel-&gt;commitTransaction();
<a name="l00838"></a>00838 
<a name="l00839"></a>00839                 Yii::app()-&gt;user-&gt;setFlash( <span class="stringliteral">&#39;success&#39;</span>, $_sMessage );
<a name="l00840"></a>00840 
<a name="l00841"></a>00841                 <span class="keywordflow">if</span> ( $sRedirectAction )
<a name="l00842"></a>00842                     $this-&gt;redirect( <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( $sRedirectAction, <span class="stringliteral">&#39;id&#39;</span> =&gt; $oModel-&gt;id ) );
<a name="l00843"></a>00843 
<a name="l00844"></a>00844                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00845"></a>00845             }
<a name="l00846"></a>00846         }
<a name="l00847"></a>00847 
<a name="l00848"></a>00848         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00849"></a>00849     }
<a name="l00850"></a>00850 
<a name="l00851"></a>00851     <span class="comment">/***</span>
<a name="l00852"></a>00852 <span class="comment">    * Just like saveModel, but doesn&#39;t commit, and never redirects.</span>
<a name="l00853"></a>00853 <span class="comment">    *</span>
<a name="l00854"></a>00854 <span class="comment">    * @param CPSModel $oModel</span>
<a name="l00855"></a>00855 <span class="comment">    * @param array $arData</span>
<a name="l00856"></a>00856 <span class="comment">    * @param boolean $bAttributesSet</span>
<a name="l00857"></a>00857 <span class="comment">    * @param string $sSuccessMessage</span>
<a name="l00858"></a>00858 <span class="comment">    * @return boolean</span>
<a name="l00859"></a>00859 <span class="comment">    * @see saveModel</span>
<a name="l00860"></a>00860 <span class="comment">    */</span>
<a name="l00861"></a><a class="code" href="classCPSController.html#a73c5580cd2f21dbe67d7989423b846e0">00861</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#a73c5580cd2f21dbe67d7989423b846e0">saveTransactionModel</a>( &amp;$oModel, $arData = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(), $bAttributesSet = <span class="keyword">false</span>, $sSuccessMessage = null )
<a name="l00862"></a>00862     {
<a name="l00863"></a>00863         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classCPSController.html#a2c9d1571a7e74596a369bfe9601b25fc">saveModel</a>( $oModel, $arData, <span class="keyword">false</span>, $bAttributesSet, null, $sSuccessMessage, <span class="keyword">true</span> );
<a name="l00864"></a>00864     }
<a name="l00865"></a>00865 
<a name="l00872"></a><a class="code" href="classCPSController.html#a138d56ab26b272430a88450638c6d466">00872</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#a138d56ab26b272430a88450638c6d466">loadPaged</a>( $bSort = <span class="keyword">false</span>, $oCriteria = null )
<a name="l00873"></a>00873     {
<a name="l00874"></a>00874         $_oSort = $_oCrit = $_oPage = null;
<a name="l00875"></a>00875 
<a name="l00876"></a>00876         <span class="comment">//  Make criteria</span>
<a name="l00877"></a>00877         $_oCrit = PS::nvl( $oCriteria, <span class="keyword">new</span> CDbCriteria() );
<a name="l00878"></a>00878         $_oPage = <span class="keyword">new</span> CPagination( $this-&gt;<a class="code" href="classCPSController.html#a97e32933f78c7a0e8e6829ac513deb4d">loadCount</a>( $_oCrit ) );
<a name="l00879"></a>00879         $_oPage-&gt;pageSize = PS::o( $_REQUEST, <span class="stringliteral">&#39;perPage&#39;</span>, self::PAGE_SIZE );
<a name="l00880"></a>00880         <span class="keywordflow">if</span> ( isset( $_REQUEST, $_REQUEST[<span class="stringliteral">&#39;page&#39;</span>] ) ) $_oPage-&gt;setCurrentPage( intval( $_REQUEST[<span class="stringliteral">&#39;page&#39;</span>] ) - 1 );
<a name="l00881"></a>00881         $_oPage-&gt;applyLimit( $_oCrit );
<a name="l00882"></a>00882 
<a name="l00883"></a>00883         <span class="comment">//  Sort...</span>
<a name="l00884"></a>00884         <span class="keywordflow">if</span> ( $bSort )
<a name="l00885"></a>00885         {
<a name="l00886"></a>00886             $_oSort = <span class="keyword">new</span> <a class="code" href="classCPSSort.html">CPSSort</a>( $this-&gt;m_sModelName );
<a name="l00887"></a>00887             $_oSort-&gt;applyOrder( $_oCrit );
<a name="l00888"></a>00888         }
<a name="l00889"></a>00889 
<a name="l00890"></a>00890         <span class="comment">//  Return an array of what we&#39;ve build...</span>
<a name="l00891"></a>00891         <span class="keywordflow">return</span> <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( $this-&gt;<a class="code" href="classCPSController.html#a4e6ee9ca4aff15fe9592ad24f5ebd509">loadAll</a>( $_oCrit ), $_oCrit, $_oPage, $_oSort );
<a name="l00892"></a>00892     }
<a name="l00893"></a>00893 
<a name="l00903"></a><a class="code" href="classCPSController.html#aacb2f651978f6aa962de80bc0248b3d9">00903</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#aacb2f651978f6aa962de80bc0248b3d9">genericModelLoad</a>( $sMethod, &amp;$oCrit = null, $arScope = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(), $arOptions = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() )
<a name="l00904"></a>00904     {
<a name="l00905"></a>00905         $_sMethod = $this-&gt;<a class="code" href="classCPSController.html#a594123c5fb3f7fab375d51468f7d5074">getModelLoadString</a>( $arScope, $arOptions ) . $sMethod;
<a name="l00906"></a>00906         <span class="keywordflow">return</span> eval( <span class="stringliteral">&quot;return (&quot;</span> . $_sMethod . <span class="stringliteral">&quot;);&quot;</span> );
<a name="l00907"></a>00907     }
<a name="l00908"></a>00908 
<a name="l00915"></a><a class="code" href="classCPSController.html#affcc785cc14ed277532e5462fcb0463c">00915</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#affcc785cc14ed277532e5462fcb0463c">load</a>( $iId = null )
<a name="l00916"></a>00916     {
<a name="l00917"></a>00917         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classCPSController.html#aacb2f651978f6aa962de80bc0248b3d9">genericModelLoad</a>( <span class="stringliteral">&#39;findByPk(&#39;</span> . $iId . <span class="charliteral">&#39;)&#39;</span> );
<a name="l00918"></a>00918     }
<a name="l00919"></a>00919 
<a name="l00926"></a><a class="code" href="classCPSController.html#a4e6ee9ca4aff15fe9592ad24f5ebd509">00926</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#a4e6ee9ca4aff15fe9592ad24f5ebd509">loadAll</a>( &amp;$oCrit = null )
<a name="l00927"></a>00927     {
<a name="l00928"></a>00928         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classCPSController.html#aacb2f651978f6aa962de80bc0248b3d9">genericModelLoad</a>( <span class="stringliteral">&#39;findAll(&#39;</span> . ( null !== $oCrit ? <span class="stringliteral">&#39;$oCrit&#39;</span> : <span class="stringliteral">&#39;&#39;</span> ) . <span class="charliteral">&#39;)&#39;</span>, $oCrit );
<a name="l00929"></a>00929     }
<a name="l00930"></a>00930 
<a name="l00937"></a><a class="code" href="classCPSController.html#a97e32933f78c7a0e8e6829ac513deb4d">00937</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#a97e32933f78c7a0e8e6829ac513deb4d">loadCount</a>( &amp;$oCrit = null )
<a name="l00938"></a>00938     {
<a name="l00939"></a>00939         $_sCrit = ( $oCrit ) ? <span class="stringliteral">&#39;$oCrit&#39;</span> : null;
<a name="l00940"></a>00940         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classCPSController.html#aacb2f651978f6aa962de80bc0248b3d9">genericModelLoad</a>( <span class="stringliteral">&#39;count(&#39;</span> . $_sCrit. <span class="charliteral">&#39;)&#39;</span>, $oCrit );
<a name="l00941"></a>00941     }
<a name="l00942"></a>00942 
<a name="l00950"></a><a class="code" href="classCPSController.html#a594123c5fb3f7fab375d51468f7d5074">00950</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#a594123c5fb3f7fab375d51468f7d5074">getModelLoadString</a>( $arScope = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(), $arOptions = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() )
<a name="l00951"></a>00951     {
<a name="l00952"></a>00952         $_sScopes = ( count( $arScope ) ) ? implode( <span class="stringliteral">&#39;-&gt;&#39;</span>, $arScope ) . <span class="stringliteral">&#39;-&gt;&#39;</span> : null;
<a name="l00953"></a>00953         <span class="keywordflow">return</span> $this-&gt;m_sModelName . <span class="stringliteral">&#39;::model()-&gt;&#39;</span> . $_sScopes;
<a name="l00954"></a>00954     }
<a name="l00955"></a>00955 
<a name="l00961"></a><a class="code" href="classCPSController.html#a12493e83d09e957f6d1f038aacff46da">00961</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#a12493e83d09e957f6d1f038aacff46da">pushAction</a>( $oAction )
<a name="l00962"></a>00962     {
<a name="l00963"></a>00963         array_push( $this-&gt;m_arActionQueue, $oAction );
<a name="l00964"></a>00964     }
<a name="l00965"></a>00965 
<a name="l00970"></a><a class="code" href="classCPSController.html#aaebe806c849a4c263ea874b67ba9c98b">00970</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#aaebe806c849a4c263ea874b67ba9c98b">popAction</a>()
<a name="l00971"></a>00971     {
<a name="l00972"></a>00972         <span class="keywordflow">return</span> array_pop( $this-&gt;m_arActionQueue );
<a name="l00973"></a>00973     }
<a name="l00974"></a>00974 
<a name="l00981"></a><a class="code" href="classCPSController.html#ac265d939123b5e6488026368b49ecd30">00981</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#ac265d939123b5e6488026368b49ecd30">addViewData</a>( $variableName, $variableData = null )
<a name="l00982"></a>00982     {
<a name="l00983"></a>00983         $this-&gt;_viewData[$variableName] = $variableData;
<a name="l00984"></a>00984     }
<a name="l00985"></a>00985 
<a name="l00990"></a><a class="code" href="classCPSController.html#aac45f7bcfa0fb866aff383996519ec35">00990</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#aac45f7bcfa0fb866aff383996519ec35">clearSearchCriteria</a>()
<a name="l00991"></a>00991     {
<a name="l00992"></a>00992         $this-&gt;m_arCurrentSearchCriteria = null;
<a name="l00993"></a>00993         Yii::app()-&gt;user-&gt;clearState( $this-&gt;m_sSearchStateId );
<a name="l00994"></a>00994 
<a name="l00995"></a>00995         <span class="keywordflow">return</span> null;
<a name="l00996"></a>00996     }
<a name="l00997"></a>00997 
<a name="l01004"></a><a class="code" href="classCPSController.html#a7063f698c3d296c849e56a97a007b280">01004</a>     <span class="keyword">protected</span> function <a class="code" href="classCPSController.html#a7063f698c3d296c849e56a97a007b280">_ajaxReturn</a>( $payload = <span class="keyword">false</span>, $encode = <span class="keyword">false</span>, $encodeOptions = ENT_NOQUOTES )
<a name="l01005"></a>01005     {
<a name="l01006"></a>01006         $this-&gt;layout = <span class="keyword">false</span>;
<a name="l01007"></a>01007 
<a name="l01008"></a>01008         <span class="keywordflow">if</span> ( <span class="keyword">false</span> === $payload || <span class="keyword">true</span> === $payload )
<a name="l01009"></a>01009             $payload = ( $payload ? <span class="charliteral">&#39;1&#39;</span> : <span class="charliteral">&#39;0&#39;</span> );
<a name="l01010"></a>01010 
<a name="l01011"></a>01011         $_result = json_encode( $payload );
<a name="l01012"></a>01012         <span class="keywordflow">if</span> ( $encode ) $_result = htmlspecialchars( $_result, $encodeOptions );
<a name="l01013"></a>01013 
<a name="l01014"></a>01014         echo $_result;
<a name="l01015"></a>01015         <span class="keywordflow">return</span>;
<a name="l01016"></a>01016     }
<a name="l01017"></a>01017 
<a name="l01018"></a>01018 }
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Thu Mar 24 2011 20:11:38 for "The Yii Extension Library Of Doom!" by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
