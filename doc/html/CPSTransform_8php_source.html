<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>&quot;The Yii Extension Library Of Doom!&quot;: /usr/local/yiixl/lib/original/helpers/CPSTransform.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>/usr/local/yiixl/lib/original/helpers/CPSTransform.php</h1>  </div>
</div>
<div class="contents">
<a href="CPSTransform_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00022"></a><a class="code" href="classCPSTransform.html">00022</a> <span class="keyword">class </span><a class="code" href="classCPSTransform.html">CPSTransform</a> <span class="keyword">implements</span> <a class="code" href="interfaceIPSBase.html">IPSBase</a>
<a name="l00023"></a>00023 {
<a name="l00024"></a>00024     <span class="comment">//********************************************************************************</span>
<a name="l00025"></a>00025     <span class="comment">//* Member Variables</span>
<a name="l00026"></a>00026     <span class="comment">//********************************************************************************</span>
<a name="l00027"></a>00027     
<a name="l00032"></a><a class="code" href="classCPSTransform.html#a02daa717c378ec40ccd5c56792be79b6">00032</a>     <span class="keyword">protected</span> <span class="keyword">static</span> <a class="code" href="classCPSTransform.html#a02daa717c378ec40ccd5c56792be79b6">$m_arTransform</a> = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(
<a name="l00033"></a>00033         <span class="charliteral">&#39;@&#39;</span> =&gt; <span class="stringliteral">&#39;linkTransform&#39;</span>,
<a name="l00034"></a>00034         <span class="charliteral">&#39;?&#39;</span> =&gt; <span class="stringliteral">&#39;boolTransform&#39;</span>,
<a name="l00035"></a>00035         <span class="charliteral">&#39;#&#39;</span> =&gt; <span class="stringliteral">&#39;timeTransform&#39;</span>,
<a name="l00036"></a>00036         <span class="charliteral">&#39;!&#39;</span> =&gt; <span class="stringliteral">&#39;styleTransform&#39;</span>,
<a name="l00037"></a>00037         <span class="charliteral">&#39;&lt;&#39;</span> =&gt; <span class="stringliteral">&#39;alignTransform&#39;</span>,
<a name="l00038"></a>00038         <span class="charliteral">&#39;|&#39;</span> =&gt; <span class="stringliteral">&#39;alignTransform&#39;</span>,
<a name="l00039"></a>00039         <span class="charliteral">&#39;&gt;&#39;</span> =&gt; <span class="stringliteral">&#39;alignTransform&#39;</span>,
<a name="l00040"></a>00040         <span class="charliteral">&#39;.&#39;</span> =&gt; <span class="stringliteral">&#39;numberTransform&#39;</span>,
<a name="l00041"></a>00041         <span class="charliteral">&#39;$&#39;</span> =&gt; <span class="stringliteral">&#39;currencyTransform&#39;</span>,
<a name="l00042"></a>00042         <span class="charliteral">&#39;,&#39;</span> =&gt; <span class="stringliteral">&#39;integerTransform&#39;</span>,
<a name="l00043"></a>00043         <span class="charliteral">&#39;*&#39;</span> =&gt; <span class="stringliteral">&#39;codeLookup&#39;</span>,
<a name="l00044"></a>00044     );
<a name="l00045"></a>00045     
<a name="l00050"></a><a class="code" href="classCPSTransform.html#ad005f4e9c81099cb3317e04d8b998492">00050</a>     <span class="keyword">protected</span> <span class="keyword">static</span> <a class="code" href="classCPSTransform.html#ad005f4e9c81099cb3317e04d8b998492">$m_sCurrencyCode</a> = <span class="charliteral">&#39;$&#39;</span>;
<a name="l00051"></a><a class="code" href="classCPSTransform.html#aaba192253f94bbad45870587c5a6cf47">00051</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classCPSTransform.html#aaba192253f94bbad45870587c5a6cf47">getCurrencyCode</a>() { <span class="keywordflow">return</span> self::$m_sCurrencyCode; }
<a name="l00052"></a><a class="code" href="classCPSTransform.html#a326aa5ab4d2acd64a6d1ceb91ada10a9">00052</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classCPSTransform.html#a326aa5ab4d2acd64a6d1ceb91ada10a9">setCurrencyCode</a>( $sValue ) { self::$m_sCurrencyCode = $sValue; }
<a name="l00053"></a>00053 
<a name="l00054"></a>00054     <span class="comment">//********************************************************************************</span>
<a name="l00055"></a>00055     <span class="comment">//* Public Methods</span>
<a name="l00056"></a>00056     <span class="comment">//********************************************************************************</span>
<a name="l00057"></a>00057     
<a name="l00063"></a><a class="code" href="classCPSTransform.html#aa255554fc788af56211439af1c7d537f">00063</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classCPSTransform.html#aa255554fc788af56211439af1c7d537f">cleanColumn</a>( $sColumn )
<a name="l00064"></a>00064     {
<a name="l00065"></a>00065         <span class="keywordflow">if</span> ( in_array( $sColumn[0], array_keys( self::$m_arTransform ) ) ) $sColumn = substr( $sColumn, 1 );
<a name="l00066"></a>00066         <span class="keywordflow">return</span> $sColumn;
<a name="l00067"></a>00067     }
<a name="l00068"></a>00068     
<a name="l00075"></a><a class="code" href="classCPSTransform.html#adaa9f9a55104660a4b1eb1cd4a7516fa">00075</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classCPSTransform.html#adaa9f9a55104660a4b1eb1cd4a7516fa">valueOf</a>( $sType, $oValue )
<a name="l00076"></a>00076     {
<a name="l00077"></a>00077         <span class="keywordflow">foreach</span> ( self::$m_arTransform as $_sChar =&gt; $_sMethod )
<a name="l00078"></a>00078         {
<a name="l00079"></a>00079             <span class="keywordflow">if</span> ( $sType == $_sChar )
<a name="l00080"></a>00080             {
<a name="l00081"></a>00081                 list( $oValue, $_bLink ) = self::$_sMethod( $sType, $oValue );
<a name="l00082"></a>00082                 <span class="keywordflow">break</span>;
<a name="l00083"></a>00083             }
<a name="l00084"></a>00084         }
<a name="l00085"></a>00085         
<a name="l00086"></a>00086         <span class="keywordflow">return</span> $oValue;
<a name="l00087"></a>00087     }
<a name="l00088"></a>00088     
<a name="l00096"></a><a class="code" href="classCPSTransform.html#a1455044b50d1f628be0d635c9da6114a">00096</a>     <span class="keyword">protected</span> <span class="keyword">static</span> function <a class="code" href="classCPSTransform.html#a1455044b50d1f628be0d635c9da6114a">setValue</a>( CModel $oModel, $sColumn, $oValue = null )
<a name="l00097"></a>00097     {
<a name="l00098"></a>00098         <span class="keywordflow">if</span> ( $oModel-&gt;hasAttribute( self::columnChain( $sColumn ) ) )
<a name="l00099"></a>00099         {
<a name="l00100"></a>00100             $_sColumn = <a class="code" href="classCPSTransform.html#a3fe1ccddc9aeb87c4edafc0c55c07b17">self::columnChain</a>( $sColumn );
<a name="l00101"></a>00101             $oModel-&gt;{$_sColumn} = $oValue;
<a name="l00102"></a>00102         }
<a name="l00103"></a>00103     }
<a name="l00104"></a>00104     
<a name="l00113"></a><a class="code" href="classCPSTransform.html#a9fde2db64e7ddc0307fe950ab660a9cf">00113</a>     <span class="keyword">protected</span> <span class="keyword">static</span> function getValue( $oModel, $sColumn, $sFormatColumn = null )
<a name="l00114"></a>00114     {
<a name="l00115"></a>00115         <span class="keywordflow">if</span> ( ! $oModel instanceof CModel ) 
<a name="l00116"></a>00116             <span class="keywordflow">return</span> $oModel[ self::columnChain( PS::nvl( $sFormatColumn, $sColumn ) ) ];
<a name="l00117"></a>00117         
<a name="l00118"></a>00118         <span class="keywordflow">return</span> eval( <span class="stringliteral">&#39;return $oModel-&gt;&#39;</span> . self::columnChain( $sColumn ) . <span class="charliteral">&#39;;&#39;</span> );
<a name="l00119"></a>00119     }
<a name="l00120"></a>00120     
<a name="l00127"></a><a class="code" href="classCPSTransform.html#a3fe1ccddc9aeb87c4edafc0c55c07b17">00127</a>     <span class="keyword">protected</span> <span class="keyword">static</span> function columnChain( $sColumn )
<a name="l00128"></a>00128     {
<a name="l00129"></a>00129         $_sCmd = $sColumn;
<a name="l00130"></a>00130         
<a name="l00131"></a>00131         <span class="keywordflow">if</span> ( <span class="keyword">false</span> !== strpos( $sColumn, <span class="charliteral">&#39;.&#39;</span> ) )
<a name="l00132"></a>00132         {
<a name="l00133"></a>00133             $_sCmd = null;
<a name="l00134"></a>00134             $_arParts = explode( <span class="charliteral">&#39;.&#39;</span>, $sColumn );
<a name="l00135"></a>00135             <span class="keywordflow">foreach</span> ( $_arParts as $_sPart ) $_sCmd .= ( $_sCmd !== null ? <span class="stringliteral">&#39;-&gt;&#39;</span> : <span class="stringliteral">&#39;&#39;</span> ) . $_sPart;
<a name="l00136"></a>00136         }
<a name="l00137"></a>00137 
<a name="l00138"></a>00138         <span class="keywordflow">return</span> $_sCmd;
<a name="l00139"></a>00139     }
<a name="l00140"></a>00140     
<a name="l00151"></a><a class="code" href="classCPSTransform.html#aeabce54d5af0d17071617701b870308f">00151</a>     <span class="keyword">public</span> <span class="keyword">static</span> function column( CModel $oModel, $arColumns = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(), $sLinkView = <span class="stringliteral">&#39;update&#39;</span>, $sWrapTag = <span class="stringliteral">&#39;td&#39;</span>, $arWrapOptions = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() )
<a name="l00152"></a>00152     {
<a name="l00153"></a>00153         $_bValue = $_sOut = null;
<a name="l00154"></a>00154         $_arValueMap = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>();
<a name="l00155"></a>00155         $_bIsModel = ( $oModel instanceof CModel );
<a name="l00156"></a>00156         $_sPK = ( $_bIsModel ) ? $oModel-&gt;getTableSchema()-&gt;primaryKey : null;
<a name="l00157"></a>00157         
<a name="l00158"></a>00158         <span class="comment">//  Build columns</span>
<a name="l00159"></a>00159         <span class="keywordflow">foreach</span> ( $arColumns as $_sKey =&gt; $_oColumn )
<a name="l00160"></a>00160         {
<a name="l00161"></a>00161             $_bLink = <span class="keyword">false</span>;
<a name="l00162"></a>00162             $_bCodeValue = $_sNullDisplay = $_sDisplayFormat = $_arValueMap = $_oValue = null;
<a name="l00163"></a>00163             $_sColumn = $_oColumn;
<a name="l00164"></a>00164             
<a name="l00165"></a>00165             <span class="comment">//  Any column options?</span>
<a name="l00166"></a>00166             <span class="keywordflow">if</span> ( is_array( $_oColumn ) )
<a name="l00167"></a>00167             {
<a name="l00168"></a>00168                 $_sColumn = array_shift( $_oColumn );
<a name="l00169"></a>00169                 $_arColOpts = $_oColumn;
<a name="l00170"></a>00170 
<a name="l00171"></a>00171                 <span class="comment">//  Get column options</span>
<a name="l00172"></a>00172                 <span class="keywordflow">if</span> ( $_arColOpts ) 
<a name="l00173"></a>00173                 {
<a name="l00174"></a>00174                     $_arValueMap = PS::o( $_arColOpts, <span class="stringliteral">&#39;valueMap&#39;</span>, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(), <span class="keyword">true</span> );
<a name="l00175"></a>00175                     $_sDisplayFormat = PS::o( $_arColOpts, <span class="stringliteral">&#39;displayFormat&#39;</span>, null, <span class="keyword">true</span> );
<a name="l00176"></a>00176                     $_sNullDisplay = PS::o( $_arColOpts, <span class="stringliteral">&#39;nullDisplay&#39;</span>, null, <span class="keyword">true</span> );
<a name="l00177"></a>00177                     $_bCodeValue = PS::o( $_arColOpts, <span class="stringliteral">&#39;codeValue&#39;</span>, null, <span class="keyword">true</span> );
<a name="l00178"></a>00178                     
<a name="l00179"></a>00179                     <span class="comment">//  Anything remaining gets rolled into wrap options</span>
<a name="l00180"></a>00180                     $arWrapOptions = PS::smart_array_merge( $_arColOpts, $arWrapOptions );
<a name="l00181"></a>00181                 }
<a name="l00182"></a>00182             }
<a name="l00183"></a>00183             
<a name="l00184"></a>00184             <span class="comment">//  Process column...</span>
<a name="l00185"></a>00185             <span class="keywordflow">if</span> ( in_array( $_sColumn[0], array_keys( self::$m_arTransform ) ) )
<a name="l00186"></a>00186             {
<a name="l00187"></a>00187                 $_sRealCol = self::cleanColumn( $_sColumn );
<a name="l00188"></a>00188                 $_sMethod = self::$m_arTransform[ $_sColumn[0] ];
<a name="l00189"></a>00189                 $_oValue = self::getValue( $oModel, $_bIsModel ? $_sRealCol : $_sColumn );
<a name="l00190"></a>00190                 list( $_oValue, $_bLink, $_arWrapOpts ) = self::$_sMethod( $_sColumn[0], $_oValue, $_sDisplayFormat );
<a name="l00191"></a>00191                 $arWrapOptions = PS::smart_array_merge( $arWrapOptions, $_arWrapOpts );
<a name="l00192"></a>00192             }
<a name="l00193"></a>00193             <span class="keywordflow">else</span>
<a name="l00194"></a>00194                 $_sRealCol = $_sColumn;
<a name="l00195"></a>00195 
<a name="l00196"></a>00196             <span class="keywordflow">if</span> ( ! strlen( $_oValue ) ) $_oValue = self::getValue( $oModel, $_sRealCol );
<a name="l00197"></a>00197             
<a name="l00198"></a>00198             <span class="comment">//  Map value for display...</span>
<a name="l00199"></a>00199             <span class="keywordflow">if</span> ( $_arValueMap &amp;&amp; isset( $_oValue ) &amp;&amp; in_array( $_oValue, array_keys( $_arValueMap ) ) )
<a name="l00200"></a>00200                 <span class="keywordflow">if</span> ( isset( $_arValueMap[ $_oValue ] ) ) $_oValue = $_arValueMap[ $_oValue ];
<a name="l00201"></a>00201 
<a name="l00202"></a>00202             <span class="comment">//  Pretty it up...</span>
<a name="l00203"></a>00203             <span class="keywordflow">if</span> ( is_array( $sLinkView ) )
<a name="l00204"></a>00204             {
<a name="l00205"></a>00205                 $_arLink = $sLinkView;
<a name="l00206"></a>00206                 $_arLink[ $_sPK ] = $oModel-&gt;{$_sPK};
<a name="l00207"></a>00207             }
<a name="l00208"></a>00208             <span class="keywordflow">else</span>
<a name="l00209"></a>00209                 $_arLink = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( $sLinkView, $_sPK =&gt; $oModel-&gt;{$_sPK} );
<a name="l00210"></a>00210             
<a name="l00211"></a>00211             $_sColumn = ( $_bLink || $_sPK == $_sRealCol ) ?
<a name="l00212"></a>00212                 PS::link( $_oValue, $_arLink )
<a name="l00213"></a>00213                 :
<a name="l00214"></a>00214                 ( PS::o( $arWrapOptions, <span class="stringliteral">&#39;encode&#39;</span>, <span class="keyword">true</span> ) ? PS::encode( $_oValue ) : $_oValue );
<a name="l00215"></a>00215 
<a name="l00216"></a>00216             $_sOut .= ( $sWrapTag ) ? PS::tag( $sWrapTag, $arWrapOptions, $_sColumn ) : $_sColumn;
<a name="l00217"></a>00217         }
<a name="l00218"></a>00218 
<a name="l00219"></a>00219         <span class="keywordflow">return</span> $_sOut;
<a name="l00220"></a>00220     }
<a name="l00221"></a>00221     
<a name="l00229"></a><a class="code" href="classCPSTransform.html#afb9fa6864edba1cdfc91092132bc1da3">00229</a>     <span class="keyword">public</span> <span class="keyword">static</span> function arrayToXml( $arData, $sRootNodeName = <span class="stringliteral">&#39;data&#39;</span>, $sXml = null )
<a name="l00230"></a>00230     {
<a name="l00231"></a>00231         <span class="comment">// turn off compatibility mode as simple xml doesn&#39;t like it</span>
<a name="l00232"></a>00232         <span class="keywordflow">if</span> ( 1 == ini_get( <span class="stringliteral">&#39;zend.ze1_compatibility_mode&#39;</span> ) )
<a name="l00233"></a>00233             ini_set( <span class="stringliteral">&#39;zend.ze1_compatibility_mode&#39;</span>, 0 );
<a name="l00234"></a>00234 
<a name="l00235"></a>00235         <span class="keywordflow">if</span> ( null == $sXml )
<a name="l00236"></a>00236             $sXml = simplexml_load_string( <span class="stringliteral">&quot;&lt;?xml version=&#39;1.0&#39; encoding=&#39;utf-8&#39;?&gt;&lt;{$sRootNodeName} /&gt;&quot;</span> );
<a name="l00237"></a>00237 
<a name="l00238"></a>00238         <span class="comment">// loop through the data passed in.</span>
<a name="l00239"></a>00239         <span class="keywordflow">foreach</span> ( $arData as $_sKey =&gt; $_oValue )
<a name="l00240"></a>00240         {
<a name="l00241"></a>00241             <span class="comment">// no numeric keys in our xml please!</span>
<a name="l00242"></a>00242             <span class="keywordflow">if</span> ( is_numeric($_sKey ) )
<a name="l00243"></a>00243                 $_sKey = <span class="stringliteral">&quot;unknownNode_&quot;</span>. ( string )$_sKey;
<a name="l00244"></a>00244 
<a name="l00245"></a>00245             <span class="comment">// replace anything not alpha numeric</span>
<a name="l00246"></a>00246             $_sKey = preg_replace( <span class="stringliteral">&#39;/[^a-z]/i&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $_sKey );
<a name="l00247"></a>00247 
<a name="l00248"></a>00248             <span class="comment">// if there is another array found recrusively call this function</span>
<a name="l00249"></a>00249             <span class="keywordflow">if</span> ( is_array( $_oValue ) )
<a name="l00250"></a>00250             {
<a name="l00251"></a>00251                 $_oNode = $sXml-&gt;addChild( $_sKey );
<a name="l00252"></a>00252                 self::arrayToXml( $_oValue, $sRootNodeName, $_oNode );
<a name="l00253"></a>00253             }
<a name="l00254"></a>00254             <span class="keywordflow">else</span>
<a name="l00255"></a>00255             {
<a name="l00256"></a>00256                 <span class="comment">// add single node.</span>
<a name="l00257"></a>00257                 $_oValue = htmlentities( $_oValue );
<a name="l00258"></a>00258                 $sXml-&gt;addChild( $_sKey, $_oValue );
<a name="l00259"></a>00259             }
<a name="l00260"></a>00260         }
<a name="l00261"></a>00261 
<a name="l00262"></a>00262         <span class="keywordflow">return</span>( $sXml-&gt;asXML() );
<a name="l00263"></a>00263     }
<a name="l00264"></a>00264     
<a name="l00265"></a>00265     <span class="comment">//********************************************************************************</span>
<a name="l00266"></a>00266     <span class="comment">//* Private Transformation Methods </span>
<a name="l00267"></a>00267     <span class="comment">//********************************************************************************</span>
<a name="l00268"></a>00268     
<a name="l00276"></a><a class="code" href="classCPSTransform.html#af3bdd179e3007dcd172efbb832cca822">00276</a>     <span class="keyword">protected</span> <span class="keyword">static</span> function linkTransform( $sHow, $oValue = null )
<a name="l00277"></a>00277     {
<a name="l00278"></a>00278         <span class="keywordflow">return</span> <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( $oValue, <span class="keyword">true</span>, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() );
<a name="l00279"></a>00279     }
<a name="l00280"></a>00280     
<a name="l00289"></a><a class="code" href="classCPSTransform.html#a7491d0a6ec45acde6b8ea3f55766afbe">00289</a>     <span class="keyword">protected</span> <span class="keyword">static</span> function boolTransform( $sHow, $oValue )
<a name="l00290"></a>00290     {
<a name="l00291"></a>00291         $_oValue = ( empty( $oValue ) || $oValue === <span class="charliteral">&#39;N&#39;</span> || $oValue === <span class="charliteral">&#39;n&#39;</span> || $oValue === 0 ) ? <span class="stringliteral">&#39;No&#39;</span> : <span class="stringliteral">&#39;Yes&#39;</span>;
<a name="l00292"></a>00292         <span class="keywordflow">return</span> self::alignTransform( <span class="charliteral">&#39;|&#39;</span>, $_oValue );
<a name="l00293"></a>00293     }
<a name="l00294"></a>00294     
<a name="l00303"></a><a class="code" href="classCPSTransform.html#aca8d939a1d46f31565cc285f1219be53">00303</a>     <span class="keyword">protected</span> <span class="keyword">static</span> function timeTransform( $sHow, $oValue, $sFormat = <span class="stringliteral">&#39;F d, Y&#39;</span> )
<a name="l00304"></a>00304     {
<a name="l00305"></a>00305         <span class="keywordflow">return</span> <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( date( $sFormat, strtotime( $oValue ) ), <span class="keyword">false</span>, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() );
<a name="l00306"></a>00306     }
<a name="l00307"></a>00307     
<a name="l00316"></a><a class="code" href="classCPSTransform.html#a4c967738a3904b14a2f50f331299fa93">00316</a>     <span class="keyword">protected</span> <span class="keyword">static</span> function numberTransform( $sHow, $oValue, $iDecimals = 2 )
<a name="l00317"></a>00317     {
<a name="l00318"></a>00318         <span class="keywordflow">return</span> self::alignTransform( <span class="charliteral">&#39;&gt;&#39;</span>, number_format( doubleval( $oValue ), $iDecimals ) );
<a name="l00319"></a>00319     }
<a name="l00320"></a>00320     
<a name="l00328"></a><a class="code" href="classCPSTransform.html#a04f8fee4f0dae9c538c23fae82011556">00328</a>     <span class="keyword">protected</span> <span class="keyword">static</span> function integerTransform( $sHow, $oValue )
<a name="l00329"></a>00329     {
<a name="l00330"></a>00330         <span class="keywordflow">return</span> self::numberTransform( $sHow, $oValue, 0 );
<a name="l00331"></a>00331     }
<a name="l00332"></a>00332 
<a name="l00343"></a><a class="code" href="classCPSTransform.html#a08395eb6a5783fd6d1ebca3ac1673720">00343</a>     <span class="keyword">protected</span> <span class="keyword">static</span> function currencyTransform( $sHow, $oValue, $iDecimals = 2 )
<a name="l00344"></a>00344     {
<a name="l00345"></a>00345         <span class="keywordflow">return</span> self::alignTransform( <span class="charliteral">&#39;&gt;&#39;</span>, self::$m_sCurrencyCode . number_format( doubleval( $oValue ), $iDecimals ) );
<a name="l00346"></a>00346     }
<a name="l00347"></a>00347     
<a name="l00355"></a><a class="code" href="classCPSTransform.html#ad86611f0425895db4f816facded1f05b">00355</a>     <span class="keyword">protected</span> <span class="keyword">static</span> function styleTransform( $sHow, $oValue )
<a name="l00356"></a>00356     {   
<a name="l00357"></a>00357         <span class="keywordflow">return</span> self::alignTransform( $sHow, $oValue );
<a name="l00358"></a>00358     }
<a name="l00359"></a>00359     
<a name="l00368"></a><a class="code" href="classCPSTransform.html#accb985cf2dadc7fe1cf11f1c3cb97250">00368</a>     <span class="keyword">protected</span> <span class="keyword">static</span> function codeLookup( $sHow, $oValue )
<a name="l00369"></a>00369     {
<a name="l00370"></a>00370         <span class="keywordflow">if</span> ( $_sCodeModel = PS::getCodeModel() )
<a name="l00371"></a>00371             $oValue = call_user_func_array( <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( $_sCodeModel, <span class="stringliteral">&#39;getCodeDescription&#39;</span> ), <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( $oValue ) );
<a name="l00372"></a>00372 
<a name="l00373"></a>00373         <span class="keywordflow">return</span> <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( $oValue, <span class="keyword">false</span>, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() );
<a name="l00374"></a>00374     }
<a name="l00375"></a>00375     
<a name="l00383"></a><a class="code" href="classCPSTransform.html#a51a672918b2d46c8f8033f692161414a">00383</a>     <span class="keyword">protected</span> <span class="keyword">static</span> function alignTransform( $sHow, $oValue )
<a name="l00384"></a>00384     {
<a name="l00385"></a>00385         $_arStyle = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>();
<a name="l00386"></a>00386         
<a name="l00387"></a>00387         <span class="keywordflow">switch</span> ( $sHow )
<a name="l00388"></a>00388         {
<a name="l00389"></a>00389             <span class="keywordflow">case</span> <span class="charliteral">&#39;|&#39;</span>:
<a name="l00390"></a>00390                 $_arStyle[<span class="stringliteral">&#39;style&#39;</span>] = <span class="stringliteral">&#39;text-align:center;&#39;</span>;
<a name="l00391"></a>00391                 <span class="keywordflow">break</span>;
<a name="l00392"></a>00392                 
<a name="l00393"></a>00393             <span class="keywordflow">case</span> <span class="charliteral">&#39;&gt;&#39;</span>:
<a name="l00394"></a>00394                 $_arStyle[<span class="stringliteral">&#39;style&#39;</span>] = <span class="stringliteral">&#39;text-align:right;&#39;</span>;
<a name="l00395"></a>00395                 <span class="keywordflow">break</span>;
<a name="l00396"></a>00396                 
<a name="l00397"></a>00397             <span class="keywordflow">case</span> <span class="charliteral">&#39;&lt;&#39;</span>:
<a name="l00398"></a>00398             <span class="keywordflow">default</span>:
<a name="l00399"></a>00399                 $_arStyle[<span class="stringliteral">&#39;style&#39;</span>] = <span class="stringliteral">&#39;text-align:left;&#39;</span>;
<a name="l00400"></a>00400                 <span class="keywordflow">break</span>;
<a name="l00401"></a>00401         }
<a name="l00402"></a>00402         
<a name="l00403"></a>00403         <span class="keywordflow">return</span> <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( $oValue, <span class="keyword">false</span>, $_arStyle );
<a name="l00404"></a>00404     }
<a name="l00405"></a>00405     
<a name="l00413"></a><a class="code" href="classCPSTransform.html#a47574be513de930ec832fce1062dd033">00413</a>     <span class="keyword">public</span> <span class="keyword">static</span> function underscorize( $sString, $sChar = <span class="charliteral">&#39;_&#39;</span> )
<a name="l00414"></a>00414     {
<a name="l00415"></a>00415         $sString = strtolower( $sString[ 0 ] ) . substr( $sString, 1 );
<a name="l00416"></a>00416         
<a name="l00417"></a>00417         <span class="comment">//  If the string is already underscore notation then leave it</span>
<a name="l00418"></a>00418         <span class="keywordflow">if</span> ( <span class="keyword">false</span> !== strpos( $sString, $sChar ) )
<a name="l00419"></a>00419         {
<a name="l00420"></a>00420             <span class="comment">// Allow humanized string to be passed in</span>
<a name="l00421"></a>00421         }
<a name="l00422"></a>00422         elseif ( <span class="keyword">false</span> !== strpos( $sString, <span class="charliteral">&#39; &#39;</span> ) ) 
<a name="l00423"></a>00423         {
<a name="l00424"></a>00424             $sString = strtolower( preg_replace(<span class="stringliteral">&#39;#\s+#&#39;</span>, $sChar, $sString ) );
<a name="l00425"></a>00425         }
<a name="l00426"></a>00426         <span class="keywordflow">else</span>
<a name="l00427"></a>00427         {
<a name="l00428"></a>00428             <span class="keywordflow">do</span>
<a name="l00429"></a>00429             {
<a name="l00430"></a>00430                 $_sOld = $sString;
<a name="l00431"></a>00431                 $sString = preg_replace( <span class="stringliteral">&#39;/([a-zA-Z])([0-9])/&#39;</span>, <span class="charliteral">&#39;\1&#39;</span> . $sChar . <span class="charliteral">&#39;\2&#39;</span>, $sString );
<a name="l00432"></a>00432                 $sString = preg_replace( <span class="stringliteral">&#39;/([a-z0-9A-Z])([A-Z])/&#39;</span>, <span class="charliteral">&#39;\1&#39;</span> . $sChar . <span class="charliteral">&#39;\2&#39;</span>, $sString );
<a name="l00433"></a>00433             }
<a name="l00434"></a>00434             <span class="keywordflow">while</span> ( $_sOld != $sString );
<a name="l00435"></a>00435             
<a name="l00436"></a>00436             $sString = strtolower( $sString );
<a name="l00437"></a>00437         }
<a name="l00438"></a>00438 
<a name="l00439"></a>00439         <span class="keywordflow">return</span> $sString;
<a name="l00440"></a>00440     }
<a name="l00441"></a>00441     
<a name="l00442"></a>00442     <span class="comment">//********************************************************************************</span>
<a name="l00443"></a>00443     <span class="comment">//* as* Transformation Methods</span>
<a name="l00444"></a>00444     <span class="comment">//********************************************************************************</span>
<a name="l00445"></a>00445 
<a name="l00446"></a><a class="code" href="classCPSTransform.html#a4260063eeb39947020f6d4ccb7e206e0">00446</a>     <span class="keyword">public</span> <span class="keyword">static</span> function asUnorderedListFromArray( $arList, $arOptions = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(), $bRecursiveCall = <span class="keyword">false</span> )
<a name="l00447"></a>00447     {
<a name="l00448"></a>00448         $_arKeys = array_keys( $arList );
<a name="l00449"></a>00449         $_i = 0;
<a name="l00450"></a>00450         $_count = count( $arList );
<a name="l00451"></a>00451         $_sOut = null;
<a name="l00452"></a>00452         $_listOptions = PS::o( $arOptions, <span class="stringliteral">&#39;listOptions&#39;</span>, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(), <span class="keyword">true</span> );
<a name="l00453"></a>00453 
<a name="l00454"></a>00454         <span class="keywordflow">while</span> ( $_i &lt; $_count )
<a name="l00455"></a>00455         {
<a name="l00456"></a>00456             $_oValue = $arList[ $_arKeys[ $_i ] ];
<a name="l00457"></a>00457 
<a name="l00458"></a>00458             $_sOut .= PS::tag( 
<a name="l00459"></a>00459                 <span class="stringliteral">&#39;li&#39;</span>,
<a name="l00460"></a>00460                 PS::o( $arOptions, <span class="stringliteral">&#39;itemOptions&#39;</span>, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() ),
<a name="l00461"></a>00461                 PS::link( 
<a name="l00462"></a>00462                     is_array( $_oValue ) ? $_arKeys[ $_i ] : $_oValue,
<a name="l00463"></a>00463                     $_arKeys[ $_i ],
<a name="l00464"></a>00464                     PS::o( $arOptions, <span class="stringliteral">&#39;linkOptions&#39;</span>, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() )
<a name="l00465"></a>00465                 ),
<a name="l00466"></a>00466                 <span class="keyword">false</span>
<a name="l00467"></a>00467             ) . PHP_EOL;
<a name="l00468"></a>00468             
<a name="l00469"></a>00469             <span class="keywordflow">if</span> ( is_array( $_oValue ) )
<a name="l00470"></a>00470             {
<a name="l00471"></a>00471                 $_sOut .= PS::tag(
<a name="l00472"></a>00472                     <span class="stringliteral">&#39;ul&#39;</span>,
<a name="l00473"></a>00473                     <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(),
<a name="l00474"></a>00474                     <a class="code" href="classCPSTransform.html#a4260063eeb39947020f6d4ccb7e206e0">CPSTransform::asUnorderedListFromArray</a>( $arList[ $_arKeys[ $_i ] ], $arOptions, <span class="keyword">true</span> )
<a name="l00475"></a>00475                 ) . PHP_EOL;
<a name="l00476"></a>00476             }
<a name="l00477"></a>00477 
<a name="l00478"></a>00478             $_sOut .= PS::closeTag( <span class="stringliteral">&#39;li&#39;</span> ) . PHP_EOL;
<a name="l00479"></a>00479 
<a name="l00480"></a>00480             $_i++;
<a name="l00481"></a>00481         }
<a name="l00482"></a>00482 
<a name="l00483"></a>00483         <span class="keywordflow">if</span> ( $bRecursiveCall ) <span class="keywordflow">return</span> $_sOut;
<a name="l00484"></a>00484 
<a name="l00485"></a>00485         <span class="keywordflow">return</span> PS::tag( <span class="stringliteral">&#39;ul&#39;</span>, $_listOptions, $_sOut ) . PHP_EOL;
<a name="l00486"></a>00486     }
<a name="l00487"></a>00487 
<a name="l00496"></a><a class="code" href="classCPSTransform.html#adccbddee16965574f2d40fdd059a9d00">00496</a>     <span class="keyword">public</span> <span class="keyword">static</span> function asUnorderedList( $arModel = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(), $arOptions = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() )
<a name="l00497"></a>00497     {
<a name="l00498"></a>00498         <span class="keyword">static</span> $_bInit = <span class="keyword">false</span>;
<a name="l00499"></a>00499         <span class="keyword">static</span> $_sValColumn;
<a name="l00500"></a>00500         <span class="keyword">static</span> $_sKeyColumn;
<a name="l00501"></a>00501         <span class="keyword">static</span> $_sChildrenRelation;
<a name="l00502"></a>00502         <span class="keyword">static</span> $_bLinkText;
<a name="l00503"></a>00503         <span class="keyword">static</span> $_bEncode = <span class="keyword">true</span>;
<a name="l00504"></a>00504 
<a name="l00505"></a>00505         <a class="code" href="controller_2controller_8php.html#a7d53885feef470ba528847a3f2f1f93a">$_sClass</a> = $_sId = $_sOut = null;
<a name="l00506"></a>00506         
<a name="l00507"></a>00507         <span class="keywordflow">if</span> ( ! $_bInit )
<a name="l00508"></a>00508         {
<a name="l00509"></a>00509             $_sId = PS::o( $arOptions, <span class="stringliteral">&#39;id&#39;</span>, null, <span class="keyword">true</span> );
<a name="l00510"></a>00510             $_bLinkText = PS::o( $arOptions, <span class="stringliteral">&#39;linkText&#39;</span>, <span class="keyword">true</span>, <span class="keyword">true</span> );
<a name="l00511"></a>00511             $_sKeyColumn = PS::o( $arOptions, <span class="stringliteral">&#39;keyColumn&#39;</span>, <span class="stringliteral">&#39;id&#39;</span>, <span class="keyword">true</span> );
<a name="l00512"></a>00512             $_sValColumn = PS::o( $arOptions, <span class="stringliteral">&#39;valueColumn&#39;</span>, null, <span class="keyword">true</span> );
<a name="l00513"></a>00513             $_sChildrenRelation = PS::o( $arOptions, <span class="stringliteral">&#39;childrenRelation&#39;</span>, <span class="stringliteral">&#39;children&#39;</span>, <span class="keyword">true</span> );
<a name="l00514"></a>00514             <a class="code" href="controller_2controller_8php.html#a7d53885feef470ba528847a3f2f1f93a">$_sClass</a> = PS::o( $arOptions, <span class="stringliteral">&#39;class&#39;</span>, null, <span class="keyword">true</span> );
<a name="l00515"></a>00515             $_bEncode = PS::o( $arOptions, <span class="stringliteral">&#39;encode&#39;</span>, <span class="keyword">true</span>, <span class="keyword">true</span> );
<a name="l00516"></a>00516 
<a name="l00517"></a>00517             $_bInit = <span class="keyword">true</span>;
<a name="l00518"></a>00518         }
<a name="l00519"></a>00519 
<a name="l00520"></a>00520         <span class="comment">//  Loop...</span>
<a name="l00521"></a>00521         <span class="keywordflow">foreach</span> ( $arModel as $_oModel )
<a name="l00522"></a>00522         {
<a name="l00523"></a>00523             <span class="comment">//  Does this model have relational kids?</span>
<a name="l00524"></a>00524             <span class="keywordflow">if</span> ( $_oModel instanceof <a class="code" href="classCPSModel.html">CPSModel</a> &amp;&amp; $_oModel-&gt;hasBehavior( <span class="stringliteral">&#39;CPSParentChildBehavior&#39;</span> ) )
<a name="l00525"></a>00525             {
<a name="l00526"></a>00526                 $_bHasKids = ( in_array( $_sChildrenRelation, array_keys( $_oModel-&gt;relations() ) ) &amp;&amp; $_oModel-&gt;hasChildren() );
<a name="l00527"></a>00527             }
<a name="l00528"></a>00528             <span class="keywordflow">else</span>
<a name="l00529"></a>00529             {
<a name="l00530"></a>00530                 $_bHasKids = <span class="keyword">false</span>;
<a name="l00531"></a>00531             }
<a name="l00532"></a>00532                     
<a name="l00533"></a>00533             $_oValue = $_oModel-&gt;{$_sValColumn};
<a name="l00534"></a>00534             $_arLinkOpts = PS::o( $arOptions, <span class="stringliteral">&#39;linkOptions&#39;</span>, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() );
<a name="l00535"></a>00535             $_sContent = $_bEncode ? PS::encode( $_oValue ) : $_oValue;
<a name="l00536"></a>00536             $_arLinkOpts[<span class="stringliteral">&#39;rel&#39;</span>] = $_oModel-&gt;{$_sKeyColumn};
<a name="l00537"></a>00537             <span class="keywordflow">if</span> ( $_bLinkText ) $_sContent = PS::link( $_sContent, PS::o( $_arLinkOpts, <span class="stringliteral">&#39;href&#39;</span>, <span class="charliteral">&#39;#&#39;</span>, <span class="keyword">true</span>), $_arLinkOpts );
<a name="l00538"></a>00538             <span class="keywordflow">if</span> ( $_bHasKids ) $_sContent .= self::asUnorderedList( $_oModel-&gt;{$_sChildrenRelation}, $arOptions );
<a name="l00539"></a>00539 
<a name="l00540"></a>00540             $_arLiOpts = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( <span class="stringliteral">&#39;rel&#39;</span> =&gt; $_oModel-&gt;{$_sKeyColumn} );
<a name="l00541"></a>00541             $_sOut .= PS::tag( <span class="stringliteral">&#39;li&#39;</span>, $_arLiOpts, $_sContent );
<a name="l00542"></a>00542         }
<a name="l00543"></a>00543 
<a name="l00544"></a>00544         <a class="code" href="themeRoller_8php.html#ad6e41e6da579a605bb979b745aa3a612">$_arOpts</a> = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>();
<a name="l00545"></a>00545         <span class="keywordflow">if</span> ( $_sId ) <a class="code" href="themeRoller_8php.html#ad6e41e6da579a605bb979b745aa3a612">$_arOpts</a>[<span class="stringliteral">&#39;id&#39;</span>] = $_sId;
<a name="l00546"></a>00546         <span class="keywordflow">if</span> ( <a class="code" href="controller_2controller_8php.html#a7d53885feef470ba528847a3f2f1f93a">$_sClass</a> ) <a class="code" href="themeRoller_8php.html#ad6e41e6da579a605bb979b745aa3a612">$_arOpts</a>[<span class="stringliteral">&#39;class&#39;</span>] = <a class="code" href="controller_2controller_8php.html#a7d53885feef470ba528847a3f2f1f93a">$_sClass</a>;
<a name="l00547"></a>00547 
<a name="l00548"></a>00548         <span class="keywordflow">return</span> $_sOut ? PS::tag( <span class="stringliteral">&#39;ul&#39;</span>, <a class="code" href="themeRoller_8php.html#ad6e41e6da579a605bb979b745aa3a612">$_arOpts</a>, $_sOut ) : null;
<a name="l00549"></a>00549     }
<a name="l00550"></a>00550     
<a name="l00559"></a><a class="code" href="classCPSTransform.html#ad4d5a2bf97cacd382d3019fbbc21a399">00559</a>     <span class="keyword">public</span> <span class="keyword">static</span> function asXml( $arData = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(), $arOptions = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() )
<a name="l00560"></a>00560     {
<a name="l00561"></a>00561         <span class="comment">//  Initialize...</span>
<a name="l00562"></a>00562         $_sHeader = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00563"></a>00563         $_sOut = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00564"></a>00564         $_oSchema = null;
<a name="l00565"></a>00565 
<a name="l00566"></a>00566         <span class="comment">//  Default options for jqGrid</span>
<a name="l00567"></a>00567         <span class="keywordflow">if</span> ( $_bjqGrid = PS::o( $arOptions, <span class="stringliteral">&#39;jqGrid&#39;</span>, <span class="keyword">false</span> ) )
<a name="l00568"></a>00568         {
<a name="l00569"></a>00569             $_sContainer = <span class="stringliteral">&#39;row&#39;</span>;
<a name="l00570"></a>00570             $_sElement = <span class="stringliteral">&#39;cell&#39;</span>;
<a name="l00571"></a>00571             $_bUseColumnElementNames = <span class="keyword">false</span>;
<a name="l00572"></a>00572             $_bIdInAttribute = <span class="keyword">true</span>;
<a name="l00573"></a>00573             $_sIdName = <span class="stringliteral">&#39;id&#39;</span>;
<a name="l00574"></a>00574             $_bUseCDataForStrings = <span class="keyword">true</span>;
<a name="l00575"></a>00575             $_bEncloseResults = <span class="keyword">true</span>;
<a name="l00576"></a>00576             $_sEncloseTag = <span class="stringliteral">&#39;rows&#39;</span>;
<a name="l00577"></a>00577             $_arAddElements = PS::o( $arOptions, <span class="stringliteral">&#39;addElements&#39;</span>, null );
<a name="l00578"></a>00578             $_bAddTypes = <span class="keyword">false</span>;
<a name="l00579"></a>00579         }
<a name="l00580"></a>00580         <span class="keywordflow">else</span>
<a name="l00581"></a>00581         {
<a name="l00582"></a>00582             $_sContainer = PS::o( $arOptions, <span class="stringliteral">&#39;container&#39;</span>, <span class="stringliteral">&#39;row&#39;</span> );
<a name="l00583"></a>00583             $_sElement = PS::o( $arOptions, <span class="stringliteral">&#39;element&#39;</span>, <span class="stringliteral">&#39;cell&#39;</span> );
<a name="l00584"></a>00584             $_bUseColumnElementNames = PS::o( $arOptions, <span class="stringliteral">&#39;useColumnElementNames&#39;</span>, <span class="keyword">false</span> );
<a name="l00585"></a>00585             $_bIdInAttribute = PS::o( $arOptions, <span class="stringliteral">&#39;idInAttribute&#39;</span>, <span class="keyword">true</span> );
<a name="l00586"></a>00586             $_bUseCDataForStrings = PS::o( $arOptions, <span class="stringliteral">&#39;useCDataForStrings&#39;</span>, <span class="keyword">true</span> );
<a name="l00587"></a>00587             $_bEncloseResults = PS::o( $arOptions, <span class="stringliteral">&#39;encloseResults&#39;</span>, <span class="keyword">false</span> );
<a name="l00588"></a>00588             $_sEncloseTag = PS::o( $arOptions, <span class="stringliteral">&#39;encloseTag&#39;</span>, <span class="stringliteral">&#39;rows&#39;</span> );
<a name="l00589"></a>00589             $_bAddTypes = PS::o( $arOptions, <span class="stringliteral">&#39;addTypes&#39;</span>, <span class="keyword">false</span> );
<a name="l00590"></a>00590             $_sAddTypeAttributeName = PS::o( $arOptions, <span class="stringliteral">&#39;addTypeAttributeName&#39;</span>, <span class="stringliteral">&#39;type&#39;</span> );
<a name="l00591"></a>00591         }
<a name="l00592"></a>00592 
<a name="l00593"></a>00593         $_sIdName = PS::o( $arOptions, <span class="stringliteral">&#39;idName&#39;</span>, <span class="stringliteral">&#39;id&#39;</span> );
<a name="l00594"></a>00594         $_arColList = PS::o( $arOptions, <span class="stringliteral">&#39;columnList&#39;</span>, null );
<a name="l00595"></a>00595         $_bAllowNulls = PS::o( $arOptions, <span class="stringliteral">&#39;allowNulls&#39;</span>, <span class="keyword">false</span> );
<a name="l00596"></a>00596         $_sReplaceNullWith = PS::o( $arOptions, <span class="stringliteral">&#39;replaceNullWith&#39;</span>, <span class="stringliteral">&#39;&amp;nbsp;&#39;</span> );
<a name="l00597"></a>00597         $_arInnerElements = PS::o( $arOptions, <span class="stringliteral">&#39;innerElements&#39;</span>, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() );
<a name="l00598"></a>00598         $_arAddElements = PS::o( $arOptions, <span class="stringliteral">&#39;addElements&#39;</span>, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() );
<a name="l00599"></a>00599         $_arIgnoreColumns = PS::o( $arOptions, <span class="stringliteral">&#39;ignoreColumns&#39;</span>, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() );
<a name="l00600"></a>00600 
<a name="l00601"></a>00601         $_sPrimaryKey = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00602"></a>00602 
<a name="l00603"></a>00603         <span class="comment">//  Loop through array of ActiveRecords</span>
<a name="l00604"></a>00604         <span class="keywordflow">foreach</span> ( $arData as $_oRow )
<a name="l00605"></a>00605         {
<a name="l00606"></a>00606             <span class="comment">//  Get the Pk</span>
<a name="l00607"></a>00607             <span class="keywordflow">if</span> ( $_bIdInAttribute &amp;&amp; $_bUseColumnElementNames &amp;&amp; $_sPrimaryKey == <span class="stringliteral">&#39;&#39;</span> )
<a name="l00608"></a>00608             {
<a name="l00609"></a>00609                 $_sIdName = $_oRow-&gt;tableSchema-&gt;primaryKey;
<a name="l00610"></a>00610                 $_sPrimaryKey = $_oRow-&gt;getPrimaryKey();
<a name="l00611"></a>00611             }
<a name="l00612"></a>00612 
<a name="l00613"></a>00613             $_sOut .= PS::openTag( $_sContainer, $_bIdInAttribute ? <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( $_sIdName =&gt; $_oRow-&gt;primaryKey ) : <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() );
<a name="l00614"></a>00614 
<a name="l00615"></a>00615             <span class="keywordflow">foreach</span> ( $_oRow-&gt;getAttributes() as $_sKey =&gt; $_oValue )
<a name="l00616"></a>00616             {
<a name="l00617"></a>00617                 <span class="keywordflow">if</span> ( in_array( $_sKey, $_arIgnoreColumns ) )
<a name="l00618"></a>00618                     <span class="keywordflow">continue</span>;
<a name="l00619"></a>00619 
<a name="l00620"></a>00620                 $_sElemToUse = ( $_bUseColumnElementNames ) ? $_sKey : $_sElement;
<a name="l00621"></a>00621                 $_sType = gettype( $_oValue );
<a name="l00622"></a>00622                 $_sOut .= PS::tag( $_sElemToUse, ( $_bAddTypes ? <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( <span class="stringliteral">&#39;type&#39;</span> =&gt; $_sType ) : <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() ), ( $_sType == <span class="stringliteral">&#39;string&#39;</span> &amp;&amp; $_bUseCDataForStrings ) ? PS::cdata( $_oValue ) : $_oValue );
<a name="l00623"></a>00623             }
<a name="l00624"></a>00624 
<a name="l00625"></a>00625             <span class="comment">//  Anything extra to add?</span>
<a name="l00626"></a>00626             <span class="keywordflow">foreach</span> ( $_arAddElements as $_oElement )
<a name="l00627"></a>00627             {
<a name="l00628"></a>00628                 <span class="keywordflow">if</span> ( $_oElement[ <span class="stringliteral">&#39;type&#39;</span> ] == <span class="stringliteral">&#39;function&#39;</span> )
<a name="l00629"></a>00629                 {
<a name="l00630"></a>00630                     $_sResult = $_oRow-&gt;{$_oElement[<span class="stringliteral">&#39;value&#39;</span>]}( $_oRow );
<a name="l00631"></a>00631                     $_sOut .= PS::tag( $_oElement[ <span class="stringliteral">&#39;name&#39;</span> ], ( $_bAddTypes ? <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( <span class="stringliteral">&#39;type&#39;</span> =&gt; $_oElement[ <span class="stringliteral">&#39;type&#39;</span> ] ) : <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() ), ( $_bUseCDataForStrings  ) ? PS::cdata( $_sResult ) : $_sResult );
<a name="l00632"></a>00632                 }
<a name="l00633"></a>00633                 <span class="keywordflow">else</span>
<a name="l00634"></a>00634                 {
<a name="l00635"></a>00635                     <span class="keywordflow">if</span> ( $_oElement[ <span class="stringliteral">&#39;value&#39;</span> ] == <span class="stringliteral">&#39;**rowdata**&#39;</span> )
<a name="l00636"></a>00636                     {
<a name="l00637"></a>00637                         <span class="keywordflow">try</span>
<a name="l00638"></a>00638                         {
<a name="l00639"></a>00639                             $_sTemp = <span class="stringliteral">&#39;return( $_oRow-&gt;&#39;</span> . $_oElement[ <span class="stringliteral">&#39;column&#39;</span> ] . <span class="stringliteral">&#39;);&#39;</span>;
<a name="l00640"></a>00640                             $_oResult = eval( $_sTemp );
<a name="l00641"></a>00641                             $_sOut .= PS::tag( $_oElement[ <span class="stringliteral">&#39;name&#39;</span> ], ( $_bAddTypes ? <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( <span class="stringliteral">&#39;type&#39;</span> =&gt; $_oElement[ <span class="stringliteral">&#39;type&#39;</span> ] ) : <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() ), ( $_oElement[ <span class="stringliteral">&#39;type&#39;</span> ] == <span class="stringliteral">&#39;string&#39;</span> &amp;&amp; $_bUseCDataForStrings ) ? PS::cdata( $_oResult ) : $_oResult );
<a name="l00642"></a>00642                         }
<a name="l00643"></a>00643                         <span class="keywordflow">catch</span> ( Exception $_ex )
<a name="l00644"></a>00644                         {
<a name="l00645"></a>00645                             <span class="comment">//  Ignore...</span>
<a name="l00646"></a>00646                             $_sOut .= PS::tag( $_oElement[ <span class="stringliteral">&#39;name&#39;</span> ], ( $_bAddTypes ? <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( <span class="stringliteral">&#39;type&#39;</span> =&gt; $_oElement[ <span class="stringliteral">&#39;type&#39;</span> ] ) : <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() ), <span class="stringliteral">&#39;&#39;</span> );
<a name="l00647"></a>00647                         }
<a name="l00648"></a>00648                     }
<a name="l00649"></a>00649                     <span class="keywordflow">else</span>
<a name="l00650"></a>00650                         $_sOut .= PS::tag( $_oElement[ <span class="stringliteral">&#39;name&#39;</span> ], ( $_bAddTypes ? <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( <span class="stringliteral">&#39;type&#39;</span> =&gt; $_oElement[ <span class="stringliteral">&#39;type&#39;</span> ] ) : <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() ), ( $_oElement[ <span class="stringliteral">&#39;type&#39;</span> ] == <span class="stringliteral">&#39;string&#39;</span> &amp;&amp; $_bUseCDataForStrings ) ? PS::cdata( $_oElement[ <span class="stringliteral">&#39;value&#39;</span> ] ) : $_oElement[ <span class="stringliteral">&#39;value&#39;</span> ] );
<a name="l00651"></a>00651                 }
<a name="l00652"></a>00652             }
<a name="l00653"></a>00653 
<a name="l00654"></a>00654             $_sOut .= PS::closeTag( $_sContainer );
<a name="l00655"></a>00655         }
<a name="l00656"></a>00656 
<a name="l00657"></a>00657         <span class="comment">//  Anything extra to add?</span>
<a name="l00658"></a>00658         <span class="keywordflow">foreach</span> ( $_arInnerElements as $_oElement )
<a name="l00659"></a>00659             $_sHeader .= PS::tag( $_oElement[ <span class="stringliteral">&#39;name&#39;</span> ], ( $_bAddTypes ? <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( <span class="stringliteral">&#39;type&#39;</span> =&gt; $_oElement[ <span class="stringliteral">&#39;type&#39;</span> ] ) : <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>() ), ( $_oElement[ <span class="stringliteral">&#39;type&#39;</span> ] == <span class="stringliteral">&#39;string&#39;</span> &amp;&amp; $_bUseCDataForStrings ) ? PS::cdata( $_oElement[ <span class="stringliteral">&#39;value&#39;</span> ] ) : $_oElement[ <span class="stringliteral">&#39;value&#39;</span> ] );
<a name="l00660"></a>00660 
<a name="l00661"></a>00661         <span class="keywordflow">if</span> ( $_bEncloseResults &amp;&amp; ! empty( $_sEncloseTag ) )
<a name="l00662"></a>00662             $_sOut = PS::tag( $_sEncloseTag, <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>( <span class="stringliteral">&#39;itemCount&#39;</span> =&gt; <span class="keyword">sizeof</span>( $arData ) ), $_sHeader . $_sOut );
<a name="l00663"></a>00663 
<a name="l00664"></a>00664         <span class="comment">//  And return...</span>
<a name="l00665"></a>00665         <span class="keywordflow">return</span> $_sOut;
<a name="l00666"></a>00666     }
<a name="l00667"></a>00667 
<a name="l00678"></a><a class="code" href="classCPSTransform.html#abc34bb044b9ae8653f4bdef6f64d7d0c">00678</a>     <span class="keyword">public</span> <span class="keyword">static</span> function asListData( $arData = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(), $sKeyColumn, $sValueColumn )
<a name="l00679"></a>00679     {
<a name="l00680"></a>00680         $_arOut = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>();
<a name="l00681"></a>00681         
<a name="l00682"></a>00682         <span class="keywordflow">foreach</span> ( $arData as $_oRow )
<a name="l00683"></a>00683             $_arOut[ $_oRow-&gt;getAttribute( $sKeyColumn ) ] = $_oRow-&gt;getAttribute( $sValueColumn );
<a name="l00684"></a>00684             
<a name="l00685"></a>00685         <span class="keywordflow">return</span> $_arOut;
<a name="l00686"></a>00686     }
<a name="l00687"></a>00687     
<a name="l00688"></a>00688 }
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Thu Mar 24 2011 20:11:38 for "The Yii Extension Library Of Doom!" by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
