<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>&quot;The Yii Extension Library Of Doom!&quot;: /usr/local/yiixl/lib/original/components/CPSSsh.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>/usr/local/yiixl/lib/original/components/CPSSsh.php</h1>  </div>
</div>
<div class="contents">
<a href="CPSSsh_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00028"></a>00028 <span class="comment">//  Include Files</span>
<a name="l00029"></a>00029 <span class="comment">//  Constants</span>
<a name="l00030"></a>00030 <span class="comment">//  Global Settings</span>
<a name="l00031"></a>00031 
<a name="l00044"></a><a class="code" href="classCPSSsh.html">00044</a> <span class="keyword">class </span><a class="code" href="classCPSSsh.html">CPSSsh</a> <span class="keyword">extends</span> <a class="code" href="classCPSComponent.html">CPSComponent</a>
<a name="l00045"></a>00045 {
<a name="l00046"></a>00046     <span class="comment">//********************************************************************************</span>
<a name="l00047"></a>00047     <span class="comment">//* Member Variables</span>
<a name="l00048"></a>00048     <span class="comment">//********************************************************************************</span>
<a name="l00049"></a>00049 
<a name="l00053"></a><a class="code" href="classCPSSsh.html#aea4d2182573f32e00024b6d3ab307669">00053</a>     <span class="keyword">protected</span> <a class="code" href="classCPSSsh.html#aea4d2182573f32e00024b6d3ab307669">$_hostName</a>;
<a name="l00054"></a><a class="code" href="classCPSSsh.html#ae78e05faf338016b4c1baeae80316a12">00054</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#ae78e05faf338016b4c1baeae80316a12">getHostName</a>() { <span class="keywordflow">return</span> $this-&gt;_hostName; }
<a name="l00055"></a><a class="code" href="classCPSSsh.html#a0b9a6db81fce56df66374e0da839c18b">00055</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#a0b9a6db81fce56df66374e0da839c18b">setHostName</a>( $value ) { $this-&gt;_hostName = $value; }
<a name="l00056"></a>00056 
<a name="l00060"></a><a class="code" href="classCPSSsh.html#a7144786d61ff1e88b8599df72eef589a">00060</a>     <span class="keyword">protected</span> <a class="code" href="classCPSSsh.html#a7144786d61ff1e88b8599df72eef589a">$_hostPort</a>;
<a name="l00061"></a><a class="code" href="classCPSSsh.html#a845fffe6111394d26fd5b336d5bdd9a2">00061</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#a845fffe6111394d26fd5b336d5bdd9a2">getHostPort</a>() { <span class="keywordflow">return</span> $this-&gt;_hostPort; }
<a name="l00062"></a><a class="code" href="classCPSSsh.html#ace14fafdee989e8e2c63c97aba55e7a2">00062</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#ace14fafdee989e8e2c63c97aba55e7a2">setHostPort</a>( $value ) { $this-&gt;_hostPort = $value; }
<a name="l00063"></a>00063 
<a name="l00067"></a><a class="code" href="classCPSSsh.html#adad05d8340094323803ec5acd86329a1">00067</a>     <span class="keyword">protected</span> <a class="code" href="classCPSSsh.html#adad05d8340094323803ec5acd86329a1">$_userName</a>;
<a name="l00068"></a><a class="code" href="classCPSSsh.html#aafd6d1ef27e6acc5833aba4012e5ee77">00068</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#aafd6d1ef27e6acc5833aba4012e5ee77">getUserName</a>() { <span class="keywordflow">return</span> $this-&gt;_userName; }
<a name="l00069"></a><a class="code" href="classCPSSsh.html#a22f791d05aab2806e131af24487fd9ff">00069</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#a22f791d05aab2806e131af24487fd9ff">setUserName</a>( $value ) { $this-&gt;_userName = $value; }
<a name="l00070"></a>00070 
<a name="l00074"></a><a class="code" href="classCPSSsh.html#ab2d9cec4126c2a36b45c4e24bccc0be7">00074</a>     <span class="keyword">protected</span> <a class="code" href="classCPSSsh.html#ab2d9cec4126c2a36b45c4e24bccc0be7">$_password</a>;
<a name="l00075"></a><a class="code" href="classCPSSsh.html#a04e0957baeb7acde9c0c86556da2d43f">00075</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#a04e0957baeb7acde9c0c86556da2d43f">getPassword</a>() { <span class="keywordflow">return</span> $this-&gt;_password; }
<a name="l00076"></a><a class="code" href="classCPSSsh.html#a1da155ea4c8dda7eb4cf986f05634003">00076</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#a1da155ea4c8dda7eb4cf986f05634003">setPassword</a>( $value ) { $this-&gt;_password = $value; }
<a name="l00077"></a>00077 
<a name="l00081"></a><a class="code" href="classCPSSsh.html#aa75ed584b43a95e58e9d1a173036a6f8">00081</a>     <span class="keyword">protected</span> <a class="code" href="classCPSSsh.html#aa75ed584b43a95e58e9d1a173036a6f8">$_publicKey</a>;
<a name="l00082"></a><a class="code" href="classCPSSsh.html#afc841edb470c7b8c50e78daaf634228a">00082</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#afc841edb470c7b8c50e78daaf634228a">getPublicKey</a>() { <span class="keywordflow">return</span> $this-&gt;_publicKey; }
<a name="l00083"></a><a class="code" href="classCPSSsh.html#a04c351b17c0fab37fd13de3badbf4d90">00083</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#a04c351b17c0fab37fd13de3badbf4d90">setPublicKey</a>( $value ) { $this-&gt;_publicKey = $value; }
<a name="l00084"></a>00084 
<a name="l00088"></a><a class="code" href="classCPSSsh.html#a7ee516ff732b630349455f5c9f9c85a8">00088</a>     <span class="keyword">protected</span> <a class="code" href="classCPSSsh.html#a7ee516ff732b630349455f5c9f9c85a8">$_sessionId</a>;
<a name="l00089"></a>00089 
<a name="l00093"></a><a class="code" href="classCPSSsh.html#ae9e1f0a5c641603ae7ed3388ae8a2368">00093</a>     <span class="keyword">protected</span> <a class="code" href="classCPSSsh.html#ae9e1f0a5c641603ae7ed3388ae8a2368">$_sftpId</a>;
<a name="l00094"></a>00094 
<a name="l00095"></a>00095     <span class="comment">//********************************************************************************</span>
<a name="l00096"></a>00096     <span class="comment">//* Public Methods</span>
<a name="l00097"></a>00097     <span class="comment">//********************************************************************************</span>
<a name="l00098"></a>00098 
<a name="l00108"></a><a class="code" href="classCPSSsh.html#af8437180fb9517471bed3d55b79893fb">00108</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#af8437180fb9517471bed3d55b79893fb">connect</a>( $hostName = null, $userName = null, $password = null, $hostPort = null )
<a name="l00109"></a>00109     {
<a name="l00110"></a>00110         <span class="keywordflow">if</span> ( ! function_exists( <span class="stringliteral">&#39;ssh2_connect&#39;</span> ) )
<a name="l00111"></a>00111             <span class="keywordflow">throw</span> <span class="keyword">new</span> CException( 500, <span class="stringliteral">&#39;You must install the ssh2 extensions on your server to use this class.&#39;</span> );
<a name="l00112"></a>00112 
<a name="l00113"></a>00113         <span class="keywordflow">if</span> ( $this-&gt;_sessionId )
<a name="l00114"></a>00114             $this-&gt;<a class="code" href="classCPSSsh.html#abe175fcf658475bc56e9d6fa02bc88ec">disconnect</a>();
<a name="l00115"></a>00115 
<a name="l00116"></a>00116         <span class="keywordflow">if</span> ( <span class="keyword">false</span> !== ( $this-&gt;_sessionId = ssh2_connect( PS::nvl( $hostName, $this-&gt;_hostName, <span class="stringliteral">&#39;localhost&#39;</span> ), PS::nvl( $hostPort, $this-&gt;_hostPort, 22 ) ) ) )
<a name="l00117"></a>00117         {
<a name="l00118"></a>00118             <span class="keywordflow">if</span> ( ssh2_auth_password( $this-&gt;_sessionId, PS::nvl( $userName, $this-&gt;_userName ), PS::nvl( $password, $this-&gt;_password ) ) )
<a name="l00119"></a>00119             {
<a name="l00120"></a>00120                 $this-&gt;_sftpId = ssh2_sftp( $this-&gt;_sessionId );
<a name="l00121"></a>00121                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00122"></a>00122             }
<a name="l00123"></a>00123         }
<a name="l00124"></a>00124 
<a name="l00125"></a>00125         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00126"></a>00126     }
<a name="l00127"></a>00127 
<a name="l00131"></a><a class="code" href="classCPSSsh.html#abe175fcf658475bc56e9d6fa02bc88ec">00131</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#abe175fcf658475bc56e9d6fa02bc88ec">disconnect</a>()
<a name="l00132"></a>00132     {
<a name="l00133"></a>00133         <span class="comment">//  There is apparently no &quot;disconnect&quot; or &quot;close&quot; ssh method.</span>
<a name="l00134"></a>00134         $this-&gt;_sessionId = null;
<a name="l00135"></a>00135         $this-&gt;_sftpId = null;
<a name="l00136"></a>00136     }
<a name="l00137"></a>00137 
<a name="l00145"></a><a class="code" href="classCPSSsh.html#a38b50584ad0013c2476003f46a995e15">00145</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#a38b50584ad0013c2476003f46a995e15">fopen</a>( $path, $mode = <span class="charliteral">&#39;r&#39;</span> )
<a name="l00146"></a>00146     {
<a name="l00147"></a>00147         <span class="keywordflow">return</span> <a class="code" href="classCPSSsh.html#a38b50584ad0013c2476003f46a995e15">fopen</a>( <span class="stringliteral">&quot;ssh2.sftp://{$this-&gt;_sftpId}{$path}&quot;</span>, $mode );
<a name="l00148"></a>00148     }
<a name="l00149"></a>00149 
<a name="l00156"></a><a class="code" href="classCPSSsh.html#ac35682e9c70da42914cd2078791b63e5">00156</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#ac35682e9c70da42914cd2078791b63e5">lstat</a>( $path )
<a name="l00157"></a>00157     {
<a name="l00158"></a>00158         <span class="keywordflow">return</span> ssh2_sftp_lstat( $this-&gt;_sftpId, $path );
<a name="l00159"></a>00159     }
<a name="l00160"></a>00160 
<a name="l00168"></a><a class="code" href="classCPSSsh.html#acc01f0607737714c1ef2caacfc7af6ce">00168</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#acc01f0607737714c1ef2caacfc7af6ce">mkdir</a>( $directoryName, $mode = 0777, $recursive = <span class="keyword">false</span> )
<a name="l00169"></a>00169     {
<a name="l00170"></a>00170         <span class="keywordflow">return</span> ssh2_sftp_mkdir( $this-&gt;_sftpId, $directoryName, $mode, $recursive );
<a name="l00171"></a>00171     }
<a name="l00172"></a>00172 
<a name="l00179"></a><a class="code" href="classCPSSsh.html#aad9f6133b72f0213b3cb1d3a497083d9">00179</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#aad9f6133b72f0213b3cb1d3a497083d9">readlink</a>( $link )
<a name="l00180"></a>00180     {
<a name="l00181"></a>00181         <span class="keywordflow">return</span> ssh2_sftp_readlink( $this-&gt;_sftpId, $link );
<a name="l00182"></a>00182     }
<a name="l00183"></a>00183 
<a name="l00184"></a>00184 
<a name="l00191"></a><a class="code" href="classCPSSsh.html#a8d72a3f8e929f935fe69606f691c873a">00191</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#a8d72a3f8e929f935fe69606f691c873a">realpath</a>( $path )
<a name="l00192"></a>00192     {
<a name="l00193"></a>00193         <span class="keywordflow">return</span> ssh2_sftp_realpath( $this-&gt;_sftpId, $path );
<a name="l00194"></a>00194     }
<a name="l00195"></a>00195 
<a name="l00204"></a><a class="code" href="classCPSSsh.html#a4d3ace76ac5651cc4b8e45ad72861422">00204</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#a4d3ace76ac5651cc4b8e45ad72861422">rename</a>( $path, $fromName, $toName )
<a name="l00205"></a>00205     {
<a name="l00206"></a>00206         <span class="keywordflow">return</span> ssh2_sftp_rename( $this-&gt;_sftpId, $fromName, $toName );
<a name="l00207"></a>00207     }
<a name="l00208"></a>00208 
<a name="l00215"></a><a class="code" href="classCPSSsh.html#a5c2fb19d078f1905ecd5988d7add2c9b">00215</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#a5c2fb19d078f1905ecd5988d7add2c9b">rmdir</a>( $path )
<a name="l00216"></a>00216     {
<a name="l00217"></a>00217         <span class="keywordflow">return</span> ssh2_sftp_rmdir( $this-&gt;_sftpId, $path );
<a name="l00218"></a>00218     }
<a name="l00219"></a>00219 
<a name="l00226"></a><a class="code" href="classCPSSsh.html#a893a92915f20d637be8bcee4201900a5">00226</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#a893a92915f20d637be8bcee4201900a5">stat</a>( $path )
<a name="l00227"></a>00227     {
<a name="l00228"></a>00228         <span class="keywordflow">return</span> ssh2_sftp_stat( $this-&gt;_sftpId, $path );
<a name="l00229"></a>00229     }
<a name="l00230"></a>00230 
<a name="l00238"></a><a class="code" href="classCPSSsh.html#aec3e3319826b954ee04ec148bb8fff4d">00238</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#aec3e3319826b954ee04ec148bb8fff4d">symlink</a>( $targetName, $link )
<a name="l00239"></a>00239     {
<a name="l00240"></a>00240         <span class="keywordflow">return</span> ssh2_sftp_symlink( $this-&gt;_sftpId, $targetName, $link );
<a name="l00241"></a>00241     }
<a name="l00242"></a>00242 
<a name="l00249"></a><a class="code" href="classCPSSsh.html#ad6244fc254de2b00ab567e4e0b82a4b3">00249</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#ad6244fc254de2b00ab567e4e0b82a4b3">unlink</a>( $path )
<a name="l00250"></a>00250     {
<a name="l00251"></a>00251         <span class="keywordflow">return</span> ssh2_sftp_unlink( $this-&gt;_sftpId, $path );
<a name="l00252"></a>00252     }
<a name="l00253"></a>00253 
<a name="l00254"></a><a class="code" href="classCPSSsh.html#a6b3ea2d54c7397714777048290fd851c">00254</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#a6b3ea2d54c7397714777048290fd851c">exec</a>( $command, $terminalType = <span class="stringliteral">&#39;vanilla&#39;</span>, $environment = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(), $width = 80, $height = 25, $widthHeightType = SSH2_TERM_UNIT_CHARS )
<a name="l00255"></a>00255     {
<a name="l00256"></a>00256         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classCPSSsh.html#aee459d6c2cffbcb4ebf75a2880b19c11">consumeStream</a>( ssh2_exec( $this-&gt;_sessionId, $command, $terminalType, $environment, $width, $height, $widthHeightType ) );
<a name="l00257"></a>00257     }
<a name="l00258"></a>00258 
<a name="l00259"></a><a class="code" href="classCPSSsh.html#a815c67fbeee1b1a6db7000511efee19b">00259</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#a815c67fbeee1b1a6db7000511efee19b">shell</a>( $terminalType = <span class="stringliteral">&#39;vanilla&#39;</span>, $environment = <a class="code" href="admin_8php.html#a2394bd91cde70158acb50a4a7f860ab5">array</a>(), $width = 80, $height = 25, $widthHeightType = SSH2_TERM_UNIT_CHARS )
<a name="l00260"></a>00260     {
<a name="l00261"></a>00261         <span class="keywordflow">return</span> ssh2_shell( $this-&gt;_sessionId, $terminalType, $environment, $width, $height, $widthHeightType );
<a name="l00262"></a>00262     }
<a name="l00263"></a>00263 
<a name="l00264"></a><a class="code" href="classCPSSsh.html#a4706216d9b34d9c5a0e249764d01d8f9">00264</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#a4706216d9b34d9c5a0e249764d01d8f9">tunnel</a>( $hostName, $port )
<a name="l00265"></a>00265     {
<a name="l00266"></a>00266         <span class="keywordflow">return</span> ssh2_tunnel( $this-&gt;_sessionId, $hostName, $port );
<a name="l00267"></a>00267     }
<a name="l00268"></a>00268 
<a name="l00269"></a><a class="code" href="classCPSSsh.html#aee459d6c2cffbcb4ebf75a2880b19c11">00269</a>     <span class="keyword">public</span> function <a class="code" href="classCPSSsh.html#aee459d6c2cffbcb4ebf75a2880b19c11">consumeStream</a>( $stream, $bufferSize = 4096 )
<a name="l00270"></a>00270     {
<a name="l00271"></a>00271         $_result = null;
<a name="l00272"></a>00272         
<a name="l00273"></a>00273         stream_set_blocking( $stream, <span class="keyword">true</span> );
<a name="l00274"></a>00274 
<a name="l00275"></a>00275         <span class="keywordflow">while</span> ( $_buffer = fread( $stream, $bufferSize ) )
<a name="l00276"></a>00276             $_result .= $_buffer;
<a name="l00277"></a>00277 
<a name="l00278"></a>00278         fclose( $stream );
<a name="l00279"></a>00279 
<a name="l00280"></a>00280         <span class="keywordflow">return</span> $_result;
<a name="l00281"></a>00281     }
<a name="l00282"></a>00282 
<a name="l00283"></a>00283     <span class="comment">//********************************************************************************</span>
<a name="l00284"></a>00284     <span class="comment">//* Private Methods</span>
<a name="l00285"></a>00285     <span class="comment">//********************************************************************************</span>
<a name="l00286"></a>00286 }
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Thu Mar 24 2011 20:11:38 for "The Yii Extension Library Of Doom!" by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
