<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>YiiXL -- The Yii Extension Library Of Doom!: CXLRestConsumerComponent.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="dir_1ec655711e29b55f31ff264c2bb65c33.html">usr</a>      </li>
      <li><a class="el" href="dir_6bb76cc6f95ff18987242ff417c6ce46.html">local</a>      </li>
      <li><a class="el" href="dir_c5bf51a4bce5f6288acec49aaf0c7f09.html">yiixl</a>      </li>
      <li><a class="el" href="dir_61700af67871dcbdf05fae1643014cc7.html">lib</a>      </li>
      <li><a class="el" href="dir_1fe0dc3b670ebeef3b7eceb42bf96cab.html">core</a>      </li>
      <li><a class="el" href="dir_64b2814019680923e742fa9c5e2693bd.html">components</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>CXLRestConsumerComponent.php</h1>  </div>
</div>
<div class="contents">
<a href="CXLRestConsumerComponent_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00026"></a><a class="code" href="classCXLRestConsumerComponent.html">00026</a> <span class="keyword">class </span><a class="code" href="classCXLRestConsumerComponent.html" title="CXLRestConsumerComponent.">CXLRestConsumerComponent</a> <span class="keyword">extends</span> <a class="code" href="classCXLComponent.html">CXLComponent</a>
<a name="l00027"></a>00027 {
<a name="l00028"></a>00028   <span class="comment">//********************************************************************************</span>
<a name="l00029"></a>00029   <span class="comment">//* Constants</span>
<a name="l00030"></a>00030   <span class="comment">//********************************************************************************</span>
<a name="l00031"></a>00031 
<a name="l00035"></a><a class="code" href="classCXLRestConsumerComponent.html#aa607ab5e557e6ebb60b85c5a20ad067f">00035</a>   <span class="keyword">const</span> <a class="code" href="classCXLRestConsumerComponent.html#aa607ab5e557e6ebb60b85c5a20ad067f" title="Our logging tag.">CLASS_LOG_TAG</a> = <span class="stringliteral">&#39;yiixl.core.components.CXLRestConsumerComponent&#39;</span>;
<a name="l00036"></a>00036 
<a name="l00037"></a>00037   <span class="comment">//********************************************************************************</span>
<a name="l00038"></a>00038   <span class="comment">//* Properties</span>
<a name="l00039"></a>00039   <span class="comment">//********************************************************************************</span>
<a name="l00040"></a>00040 
<a name="l00044"></a><a class="code" href="classCXLRestConsumerComponent.html#a30d859488ed1921f08a7e8191363d9a4">00044</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#a30d859488ed1921f08a7e8191363d9a4">$_apiKey</a>;
<a name="l00048"></a><a class="code" href="classCXLRestConsumerComponent.html#a3bb30fd55481cc30ef96aa61d1b523b6">00048</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#a3bb30fd55481cc30ef96aa61d1b523b6">$_altApiKey</a>;
<a name="l00052"></a><a class="code" href="classCXLRestConsumerComponent.html#ae027f791b6a2fc198dfabc3e2693f585">00052</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#ae027f791b6a2fc198dfabc3e2693f585">$_appendFormat</a>;
<a name="l00056"></a><a class="code" href="classCXLRestConsumerComponent.html#a2a3098653897c46b33497dd90b807f64">00056</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#a2a3098653897c46b33497dd90b807f64">$_apiBaseUrl</a>;
<a name="l00060"></a><a class="code" href="classCXLRestConsumerComponent.html#adb92b727d9e245493a2001eca37693de">00060</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#adb92b727d9e245493a2001eca37693de">$_apiQueryName</a>;
<a name="l00064"></a><a class="code" href="classCXLRestConsumerComponent.html#abdfb5848bea7acb66e39972358f344a8">00064</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#abdfb5848bea7acb66e39972358f344a8">$_apiToUseprotected</a>;
<a name="l00068"></a><a class="code" href="classCXLRestConsumerComponent.html#aee5e6cb1a983f0bd5f57cefdd5a97241">00068</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#aee5e6cb1a983f0bd5f57cefdd5a97241">$_apiSubUrls</a>;
<a name="l00072"></a><a class="code" href="classCXLRestConsumerComponent.html#a1fa7e8f053c645c627f16bcf41f2416a">00072</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#a1fa7e8f053c645c627f16bcf41f2416a">$_httpMethod</a>;
<a name="l00076"></a><a class="code" href="classCXLRestConsumerComponent.html#a7ea52a3850e51717b6268b7b9e468684">00076</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#a7ea52a3850e51717b6268b7b9e468684">$_returnFormat</a>;
<a name="l00080"></a><a class="code" href="classCXLRestConsumerComponent.html#a01bc135256923b2605138f01e3f81d76">00080</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#a01bc135256923b2605138f01e3f81d76">$_payload</a>;
<a name="l00084"></a><a class="code" href="classCXLRestConsumerComponent.html#ae2824a887a5fbea2092a494eac8471bb">00084</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#ae2824a887a5fbea2092a494eac8471bb">$_requestMap</a>;
<a name="l00088"></a><a class="code" href="classCXLRestConsumerComponent.html#ab068ac6d8ffe672d108a88b51f766294">00088</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#ab068ac6d8ffe672d108a88b51f766294">$_requireApiQueryName</a>;
<a name="l00092"></a><a class="code" href="classCXLRestConsumerComponent.html#a539fd69c22d2f9c368e410d3542cd5a6">00092</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#a539fd69c22d2f9c368e410d3542cd5a6">$_testApiKey</a>;
<a name="l00096"></a><a class="code" href="classCXLRestConsumerComponent.html#a043b72271c216d07a270d5b57a17fe59">00096</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#a043b72271c216d07a270d5b57a17fe59">$_testAltApiKey</a>;
<a name="l00100"></a><a class="code" href="classCXLRestConsumerComponent.html#a901ed68c5b7f6b758cc90b00197ca88b">00100</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#a901ed68c5b7f6b758cc90b00197ca88b">$_userAgent</a> = <span class="stringliteral">&#39;YiiXL; (+http://github.com/Pogostick/YiiXL)&#39;</span>;
<a name="l00104"></a><a class="code" href="classCXLRestConsumerComponent.html#a204d1af51663d8a1317949e796fe5fca">00104</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#a204d1af51663d8a1317949e796fe5fca">$_lastErrorMessage</a>;
<a name="l00108"></a><a class="code" href="classCXLRestConsumerComponent.html#a15913094186791f856e0e5eb23883ba3">00108</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#a15913094186791f856e0e5eb23883ba3">$_lastErrorMessageExtra</a>;
<a name="l00112"></a><a class="code" href="classCXLRestConsumerComponent.html#a9d205559114adfd52ac69bbb094a8a1a">00112</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#a9d205559114adfd52ac69bbb094a8a1a">$_lastErrorCode</a>;
<a name="l00116"></a><a class="code" href="classCXLRestConsumerComponent.html#ae5c686cdf8e6a089b6296dcb659f6d01">00116</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#ae5c686cdf8e6a089b6296dcb659f6d01">$_baseUrl</a>;
<a name="l00120"></a><a class="code" href="classCXLRestConsumerComponent.html#a06b741ce121a93d6010e3c514edba22b">00120</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#a06b741ce121a93d6010e3c514edba22b">$_validateOptions</a> = <span class="keyword">true</span>;
<a name="l00124"></a><a class="code" href="classCXLRestConsumerComponent.html#afe1adfd2c4c57954ea5230cae01d1c47">00124</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#afe1adfd2c4c57954ea5230cae01d1c47">$_validOptions</a> = array();
<a name="l00128"></a><a class="code" href="classCXLRestConsumerComponent.html#a73fdad41769f4f4ef1ebeaba5380ffad">00128</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#a73fdad41769f4f4ef1ebeaba5380ffad">$_validateCallbacks</a> = <span class="keyword">true</span>;
<a name="l00132"></a><a class="code" href="classCXLRestConsumerComponent.html#aadd5e6fdc7ba1ec3b3e4a916c4f005d0">00132</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#aadd5e6fdc7ba1ec3b3e4a916c4f005d0">$_validCallbacks</a> = array();
<a name="l00136"></a><a class="code" href="classCXLRestConsumerComponent.html#ae1d5e7a4a34ac8fa4dbdef28983a1fcc">00136</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#ae1d5e7a4a34ac8fa4dbdef28983a1fcc">$_callbacks</a> = array();
<a name="l00140"></a><a class="code" href="classCXLRestConsumerComponent.html#aae8a45534cedd7fc0881ca1995d8bb9c">00140</a>   <span class="keyword">protected</span> <a class="code" href="classCXLRestConsumerComponent.html#aae8a45534cedd7fc0881ca1995d8bb9c">$_externalLibraryUrl</a> = <span class="charliteral">&#39;/&#39;</span>;
<a name="l00141"></a>00141 
<a name="l00142"></a>00142   <span class="comment">//********************************************************************************</span>
<a name="l00143"></a>00143   <span class="comment">//* Public Methods</span>
<a name="l00144"></a>00144   <span class="comment">//********************************************************************************</span>
<a name="l00145"></a>00145 
<a name="l00149"></a><a class="code" href="classCXLRestConsumerComponent.html#a4be4055f3361d4800e16bc2e2e38cda6">00149</a>   <span class="keyword">public</span> function <a class="code" href="classCXLRestConsumerComponent.html#a4be4055f3361d4800e16bc2e2e38cda6" title="Preinitialize.">init</a>()
<a name="l00150"></a>00150   {
<a name="l00151"></a>00151     <span class="comment">//  Call daddy</span>
<a name="l00152"></a>00152     <a class="code" href="classCXLRestConsumerComponent.html#a4be4055f3361d4800e16bc2e2e38cda6" title="Preinitialize.">parent::init</a>();
<a name="l00153"></a>00153 
<a name="l00154"></a>00154     <span class="comment">//  Attach our events</span>
<a name="l00155"></a>00155     $this-&gt;attachEventHandler( <span class="stringliteral">&#39;onBeforeApiCall&#39;</span>, array( $this, <span class="stringliteral">&#39;beforeApiCall&#39;</span> ) );
<a name="l00156"></a>00156     $this-&gt;attachEventHandler( <span class="stringliteral">&#39;onAfterApiCall&#39;</span>, array( $this, <span class="stringliteral">&#39;afterApiCall&#39;</span> ) );
<a name="l00157"></a>00157     $this-&gt;attachEventHandler( <span class="stringliteral">&#39;onRequestComplete&#39;</span>, array( $this, <span class="stringliteral">&#39;requestComplete&#39;</span> ) );
<a name="l00158"></a>00158   }
<a name="l00159"></a>00159 
<a name="l00160"></a>00160   <span class="comment">//********************************************************************************</span>
<a name="l00161"></a>00161   <span class="comment">//* Private Methods</span>
<a name="l00162"></a>00162   <span class="comment">//********************************************************************************</span>
<a name="l00163"></a>00163 
<a name="l00172"></a><a class="code" href="classCXLRestConsumerComponent.html#a144fe38756c5927205e8c750f8da768e">00172</a>   <span class="keyword">protected</span> function <a class="code" href="classCXLRestConsumerComponent.html#a144fe38756c5927205e8c750f8da768e" title="Creates an array for requestMap.">makeMapArray</a>( $apiName, $subApiName = null, array $apiMap, $setRequestMap = <span class="keyword">true</span> )
<a name="l00173"></a>00173   {
<a name="l00174"></a>00174     $_parameters = array();
<a name="l00175"></a>00175 
<a name="l00176"></a>00176     <span class="keywordflow">foreach</span> ( $apiMap as $_key =&gt; $_value )
<a name="l00177"></a>00177     {
<a name="l00178"></a>00178       $_mapItem = $this-&gt;<a class="code" href="classCXLRestConsumerComponent.html#a994fbc009e9ddb1dee7f559c53a12e7d" title="S Creates an entry for requestMap and inserts it into the array.">makeMapItem</a>(
<a name="l00179"></a>00179         ( in_array( <span class="stringliteral">&#39;label&#39;</span>, $_value ) ) ? $_value[ <span class="stringliteral">&#39;name&#39;</span> ] : $_value[ <span class="stringliteral">&#39;label&#39;</span> ],
<a name="l00180"></a>00180         $_value[ <span class="stringliteral">&#39;name&#39;</span> ],
<a name="l00181"></a>00181         ( in_array( <span class="stringliteral">&#39;required&#39;</span>, $_value ) ) ? $_value[ <span class="stringliteral">&#39;required&#39;</span> ] : <span class="keyword">false</span>,
<a name="l00182"></a>00182         ( in_array( <span class="stringliteral">&#39;options&#39;</span>, $_value ) ) ? $_value[ <span class="stringliteral">&#39;options&#39;</span> ] : null
<a name="l00183"></a>00183       );
<a name="l00184"></a>00184 
<a name="l00185"></a>00185       $_mapItem = ( $subApiName != null ) ? array( $subApiName =&gt; $_mapItem ) : array( $_key, $_mapItem );
<a name="l00186"></a>00186 
<a name="l00187"></a>00187       <span class="keywordflow">if</span> ( $setRequestMap )
<a name="l00188"></a>00188         $this-&gt;requestMap[ $apiName ] = $_mapItem;
<a name="l00189"></a>00189 
<a name="l00190"></a>00190       array_merge( $_parameters[ $apiName ], $_mapItem );
<a name="l00191"></a>00191     }
<a name="l00192"></a>00192 
<a name="l00193"></a>00193     <span class="keywordflow">return</span>( $_parameters );
<a name="l00194"></a>00194   }
<a name="l00195"></a>00195 
<a name="l00206"></a><a class="code" href="classCXLRestConsumerComponent.html#a994fbc009e9ddb1dee7f559c53a12e7d">00206</a>   <span class="keyword">protected</span> function <a class="code" href="classCXLRestConsumerComponent.html#a994fbc009e9ddb1dee7f559c53a12e7d" title="S Creates an entry for requestMap and inserts it into the array.">makeMapItem</a>( $itemLabel, $parameterName = null, $required = <span class="keyword">false</span>, $options = array(), array &amp;$target = null )
<a name="l00207"></a>00207   {
<a name="l00208"></a>00208     <span class="comment">//  Build default settings</span>
<a name="l00209"></a>00209     $_mappingOptions = array(
<a name="l00210"></a>00210       <span class="stringliteral">&#39;name&#39;</span> =&gt; ( null != $parameterName ) ? $parameterName : $itemLabel,
<a name="l00211"></a>00211       <span class="stringliteral">&#39;required&#39;</span> =&gt; $required
<a name="l00212"></a>00212     );
<a name="l00213"></a>00213 
<a name="l00214"></a>00214     <span class="comment">//  Add on supplied options</span>
<a name="l00215"></a>00215     <span class="keywordflow">if</span> ( ! empty( $options ) )
<a name="l00216"></a>00216       $_mappingOptions = array_merge( $_mappingOptions, $options );
<a name="l00217"></a>00217 
<a name="l00218"></a>00218     <span class="comment">//  Insert for caller if requested</span>
<a name="l00219"></a>00219     <span class="keywordflow">if</span> ( null != $target )
<a name="l00220"></a>00220       $target[ $itemLabel ] = $_mappingOptions;
<a name="l00221"></a>00221 
<a name="l00222"></a>00222     <span class="comment">//  Return our array</span>
<a name="l00223"></a>00223     <span class="keywordflow">return</span>( $_mappingOptions );
<a name="l00224"></a>00224   }
<a name="l00225"></a>00225 
<a name="l00226"></a>00226   <span class="comment">//********************************************************************************</span>
<a name="l00227"></a>00227   <span class="comment">//* Event Handlers</span>
<a name="l00228"></a>00228   <span class="comment">//********************************************************************************</span>
<a name="l00229"></a>00229 
<a name="l00234"></a><a class="code" href="classCXLRestConsumerComponent.html#a6366c3940c120c34aa6cf7f4cc4df2c8">00234</a>   <span class="keyword">public</span> function <a class="code" href="classCXLRestConsumerComponent.html#a6366c3940c120c34aa6cf7f4cc4df2c8" title="Raises the onBeforeApiCall event.">onBeforeApiCall</a>( $event )
<a name="l00235"></a>00235   {
<a name="l00236"></a>00236     $this-&gt;raiseEvent( <span class="stringliteral">&#39;onBeforeApiCall&#39;</span>, $event );
<a name="l00237"></a>00237   }
<a name="l00238"></a>00238 
<a name="l00243"></a><a class="code" href="classCXLRestConsumerComponent.html#a8d1ffc45e66988165bc31c6135830fd3">00243</a>   <span class="keyword">public</span> function <a class="code" href="classCXLRestConsumerComponent.html#a8d1ffc45e66988165bc31c6135830fd3" title="Base event handler.">beforeApiCall</a>( $event )
<a name="l00244"></a>00244   {
<a name="l00245"></a>00245   }
<a name="l00246"></a>00246 
<a name="l00251"></a><a class="code" href="classCXLRestConsumerComponent.html#aababdbe8ed9e71593b4619ca5e7b57f3">00251</a>   <span class="keyword">public</span> function <a class="code" href="classCXLRestConsumerComponent.html#aababdbe8ed9e71593b4619ca5e7b57f3" title="Raises the onAfterApiCall event.">onAfterApiCall</a>( $event )
<a name="l00252"></a>00252   {
<a name="l00253"></a>00253     $this-&gt;raiseEvent( <span class="stringliteral">&#39;onAfterApiCall&#39;</span>, $event );
<a name="l00254"></a>00254   }
<a name="l00255"></a>00255 
<a name="l00260"></a><a class="code" href="classCXLRestConsumerComponent.html#a5a5d728f3727da5e41589b0e72b0bd33">00260</a>   <span class="keyword">public</span> function <a class="code" href="classCXLRestConsumerComponent.html#a5a5d728f3727da5e41589b0e72b0bd33" title="Base event handler.">afterApiCall</a>( $event )
<a name="l00261"></a>00261   {
<a name="l00262"></a>00262   }
<a name="l00263"></a>00263 
<a name="l00268"></a><a class="code" href="classCXLRestConsumerComponent.html#aa82445f7b6bd99b5b837b1ee92b3d3bf">00268</a>   <span class="keyword">public</span> function <a class="code" href="classCXLRestConsumerComponent.html#aa82445f7b6bd99b5b837b1ee92b3d3bf" title="Raises the onRequestComplete event.">onRequestComplete</a>( $event )
<a name="l00269"></a>00269   {
<a name="l00270"></a>00270     $this-&gt;raiseEvent( <span class="stringliteral">&#39;onRequestComplete&#39;</span>, $event );
<a name="l00271"></a>00271   }
<a name="l00272"></a>00272 
<a name="l00277"></a><a class="code" href="classCXLRestConsumerComponent.html#abcd54b473a65fd055b561cecc39d7737">00277</a>   <span class="keyword">public</span> function <a class="code" href="classCXLRestConsumerComponent.html#abcd54b473a65fd055b561cecc39d7737" title="Base event handler.">requestComplete</a>( $event )
<a name="l00278"></a>00278   {
<a name="l00279"></a>00279   }
<a name="l00280"></a>00280 
<a name="l00281"></a>00281 }
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Mar 25 2011 21:10:39 for YiiXL -- The Yii Extension Library Of Doom! by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
